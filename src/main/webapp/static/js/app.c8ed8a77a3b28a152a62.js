webpackJsonp([1],{"04w3":function(a,e){},"2zOP":function(a,e){},"32IE":function(a,e){},"7oUx":function(a,e){},A1UD:function(a,e){},DAEC:function(a,e){},"KF+7":function(a,e){},NHnr:function(a,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var l=t("7+uW"),s={render:function(){var a=this.$createElement,e=this._self._c||a;return e("div",{attrs:{id:"app"}},[e("router-view")],1)},staticRenderFns:[]},o=t("VU/8")({name:"App"},s,!1,null,null,null).exports,i=t("/ocq"),n={render:function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("el-main",[t("div",{staticClass:"container-fluid"},[t("el-breadcrumb",{staticClass:"breadcrumb",attrs:{"separator-class":"el-icon-arrow-right"}},[t("el-breadcrumb-item",{attrs:{to:{name:"homeLink"}}},[t("i",{staticClass:"glyphicon glyphicon-home"}),a._v("首页")])],1)],1),a._v(" "),t("div",{staticClass:"box-bd pr mt15"},[t("div",{staticClass:"tab-content custom-content"},[t("div",{staticClass:"tab-pane in active"},[t("h1",{staticStyle:{"font-size":"30px","line-height":"50px",margin:"20px 0"}},[a._v("欢迎进入合伙人配置系统！")]),a._v(" "),t("div",{staticClass:"mb10"},[t("router-link",{attrs:{to:{name:"smallShopIndexLink"}}},[t("el-button",{attrs:{type:"success"}},[a._v("小店维护")])],1)],1),a._v(" "),t("div",{staticClass:"mb10"},[t("router-link",{attrs:{to:{name:"shopsettingLink"}}},[t("el-button",{attrs:{type:"success"}},[a._v("事业组维护")])],1),a._v(" "),t("router-link",{attrs:{to:{name:"acreageLink"}}},[t("el-button",{attrs:{type:"info"}},[a._v("面积录入")])],1),a._v(" "),t("router-link",{attrs:{to:{name:"specifiedProportionLink"}}},[t("el-button",{attrs:{type:"warning"}},[a._v("比例录入审批")])],1),a._v(" "),t("router-link",{attrs:{to:{name:"costEntryLink"}}},[t("el-button",{attrs:{type:"danger"}},[a._v("费用录入")])],1),a._v(" "),t("router-link",{attrs:{to:{name:"logLink"}}},[t("el-button",{attrs:{type:"success"}},[a._v("操作日志")])],1)],1),a._v(" "),t("div",{staticClass:"mb10"},[t("router-link",{attrs:{to:{name:"scoreLeaderLink"}}},[t("el-button",{attrs:{type:"success"}},[a._v("员工分数评定")])],1),a._v(" "),t("router-link",{attrs:{to:{name:"scoreMemberLink"}}},[t("el-button",{attrs:{type:"info"}},[a._v("员工评分表")])],1),a._v(" "),t("router-link",{attrs:{to:{name:"checkupLink"}}},[t("el-button",{attrs:{type:"warning"}},[a._v("巡查分数导入")])],1)],1),a._v(" "),t("div",{staticClass:"mb10"},[t("router-link",{attrs:{to:{name:"allowanceConfirmIndexLink"}}},[t("el-button",{attrs:{type:"success"}},[a._v("门店津贴确认")])],1),a._v(" "),t("router-link",{attrs:{to:{name:"allowanceImportIndexLink"}}},[t("el-button",{attrs:{type:"info"}},[a._v("门店津贴导入")])],1)],1)])])])])},staticRenderFns:[]},r=t("VU/8")(null,n,!1,null,null,null).exports,c=t("mvHQ"),p=t.n(c),u={data:function(){return{options:[],addDialogDisabled:!1,pageData:{statusList:[{name:"全部",value:"-1"},{name:"启用",value:"1"},{name:"禁用",value:"0"}],shopTypeList:[],tableObj:{siteNo:"",shopType:"",status:"-1",mandt:"",currentPage:1,pageSize:10,totalPage:1,totalRows:1,pageArray:[10,20,30,40,50],list:[]},addDialog:{tableHeight:0,isUpdate:!1,dialogFormVisible:!1,create:{siteNo:"",shopType:"",list:[]},formLabelWidth:"120px"}}}},created:function(){this.commonInfo();var a=document.documentElement.clientHeight;this.pageData.addDialog.tableHeight=.4*a},computed:{},methods:{initFunc:function(){this.shopTypeListEvt()},commonInfo:function(){var a=this,e=this.$loading({lock:!0,spinner:"wm-icon-loading",background:"rgba(0, 0, 0, 0.7)"});fetch(this.$api.urls.POST_QUERYCOMMONINFO,{method:"post",headers:{"Content-type":"application/json"},credentials:"include",body:p()({})}).then(function(a){return a.json()}).then(function(t){setTimeout(function(){e.close()},500),t.success?(a.$store.dispatch("setMandt",t.model.mandt),a.$store.dispatch("setIndu",t.model.indu),a.$store.dispatch("setSiteNo",t.model.siteNo),a.pageData.tableObj.mandt=a.$store.getters.mandt,a.pageData.addDialog.create.siteNo=a.$store.getters.siteNo,a.pageData.tableObj.siteNo=a.$store.getters.siteNo,""!=t.model.siteNo&&(a.addDialogDisabled=!0),a.initFunc()):a.$message.error(t.message)}).catch(function(t){setTimeout(function(){e.close()},500),a.$message.error("错误："+t)})},addEvt:function(){var a=this;if(""==this.pageData.addDialog.create.siteNo)return this.$message({message:"请输入门店编号!",type:"warning"}),!1;for(var e=0;e<this.pageData.addDialog.create.list.length;e++)if(""==this.pageData.addDialog.create.list[e].chargeName)return this.$message({message:"请输入小店负责人!",type:"warning"}),!1;var t=this.pageData.addDialog.create.list;fetch(this.$api.urls.POST_PARTNER_CREATE,{method:"post",headers:{"Content-type":"application/json"},credentials:"include",body:p()(t)}).then(function(a){return a.json()}).then(function(e){e.success?(a.pageData.addDialog.dialogFormVisible=!1,a.$alert("新增小店维护成功","提示",{confirmButtonText:"确定",type:"success",center:!0,callback:function(e){a.queryEvt(),a.clearEvt()}})):a.$message.error(e.message)}).catch(function(e){a.$message.error("系统错误："+e)})},updateEvt:function(){var a=this,e=this.pageData.addDialog.create.list;fetch(this.$api.urls.POST_PARTNER_UPDATE,{method:"post",headers:{"Content-type":"application/json"},credentials:"include",body:p()(e)}).then(function(a){return a.json()}).then(function(e){e.success?(a.pageData.addDialog.dialogFormVisible=!1,a.$alert("修改小店维护成功","提示",{confirmButtonText:"确定",type:"success",center:!0,callback:function(e){a.queryEvt(),a.clearEvt()}})):a.$message.error(e.message)}).catch(function(e){a.$message.error("系统错误："+e)})},clearEvt:function(){this.pageData.addDialog.create={siteNo:this.$store.getters.siteNo,shopType:"",list:[]},this.pageData.addDialog.dialogFormVisible=!1,this.pageData.addDialog.isUpdate=!1},shopTypeEvt:function(a,e){var t=this,l={shopNo:e.row.shopNo,mandt:e.row.mandt,indu:e.row.indu,shopType:e.row.shopType};fetch(this.$api.urls.POST_PARTNER_QUERYSHOPTYPE,{method:"post",headers:{"Content-type":"application/json"},credentials:"include",body:p()(l)}).then(function(a){return a.json()}).then(function(a){a.success?t.$message({message:a.message,type:"success"}):t.$message.error(a.message)}).catch(function(a){t.$message.error("系统错误："+a)})},showUpdate:function(a,e){this.pageData.addDialog.create.siteNo=e.row.siteNo,this.pageData.addDialog.create.shopType=e.row.shopType,this.pageData.addDialog.dialogFormVisible=!0,this.pageData.addDialog.isUpdate=!0,this.siteNoEvt()},statusEvt:function(a,e){var t=this,l=this.$loading({lock:!0,spinner:"wm-icon-loading",background:"rgba(0, 0, 0, 0.7)"}),s=[{mandt:e.row.mandt,indu:e.row.indu,siteNo:e.row.siteNo,shopType:e.row.shopType,shopNo:e.row.shopNo,status:1==e.row.status?0:1,creator:e.row.creator}];fetch(this.$api.urls.POST_PARTNER_UPDATE,{method:"post",headers:{"Content-type":"application/json"},credentials:"include",body:p()(s)}).then(function(a){return a.json()}).then(function(a){setTimeout(function(){l.close()},500),a.success?t.$alert("修改状态成功","提示",{confirmButtonText:"确定",type:"success",center:!0,callback:function(a){t.queryEvt()}}):t.$message.error(a.message)}).catch(function(a){setTimeout(function(){l.close()},500),t.$message.error("系统错误："+a)})},siteNoEvt:function(){var a=this;if(""==this.pageData.addDialog.create.siteNo)return this.$message({message:"请输入门店编号!",type:"warning"}),!1;var e=this.$loading({lock:!0,spinner:"wm-icon-loading",background:"rgba(0, 0, 0, 0.7)"}),t={siteNo:this.pageData.addDialog.create.siteNo,mandt:this.$store.getters.mandt,indu:this.$store.getters.indu,shopType:this.pageData.addDialog.create.shopType};fetch(this.$api.urls.POST_PARTNER_QUERYSHOP,{method:"post",headers:{"Content-type":"application/json"},credentials:"include",body:p()(t)}).then(function(a){return a.json()}).then(function(t){if(setTimeout(function(){e.close()},500),t.success){a.pageData.addDialog.create.list=[];for(var l=0;l<t.model.length;l++)a.pageData.addDialog.create.list.push({siteNo:a.pageData.addDialog.create.siteNo,shopType:a.pageData.addDialog.create.shopType,chargeNo:t.model[l].chargeNo,chargeName:a.pageData.addDialog.isUpdate?t.model[l].chargeName:"",shopNo:t.model[l].shopNo,shopName:t.model[l].shopName,status:t.model[l].status,creator:t.model[l].creator,indu:t.model[l].indu,mandt:t.model[l].mandt})}else a.pageData.addDialog.create={siteNo:a.$store.getters.siteNo,shopType:"",list:[]},a.pageData.addDialog.dialogFormVisible=!0,a.pageData.addDialog.isUpdate=!1,a.$message.error(t.message)}).catch(function(t){setTimeout(function(){e.close()},500),a.$message.error("系统错误："+t)})},shopTypeListEvt:function(){var a=this,e={mandt:this.pageData.tableObj.mandt,siteNo:this.pageData.tableObj.siteNo};fetch(this.$api.urls.POST_PARTNER_QUERYSHOPTYPE,{method:"post",headers:{"Content-type":"application/json"},credentials:"include",body:p()(e)}).then(function(a){return a.json()}).then(function(e){e.success?(a.pageData.shopTypeList=e.model,a.queryEvt()):a.$message.error(e.message)}).catch(function(e){a.$message.error("系统错误："+e)})},queryEvt:function(){var a=this,e=this.$loading({lock:!0,spinner:"wm-icon-loading",background:"rgba(0, 0, 0, 0.7)"}),t={siteNo:this.pageData.tableObj.siteNo,shopType:this.pageData.tableObj.shopType,status:this.pageData.tableObj.status,mandt:this.pageData.tableObj.mandt,currentPage:this.pageData.tableObj.currentPage,pageSize:this.pageData.tableObj.pageSize};fetch(this.$api.urls.POST_PARTNER_QUERYSITESHOP,{method:"post",headers:{"Content-type":"application/json"},credentials:"include",body:p()(t)}).then(function(a){return a.json()}).then(function(t){if(setTimeout(function(){e.close()},500),t.success){a.pageData.tableObj.currentPage=t.model.currentPage,a.pageData.tableObj.pageSize=t.model.pageSize,a.pageData.tableObj.totalPage=t.model.pageCount,a.pageData.tableObj.totalRows=t.model.count;for(var l=t.model.data,s=0;s<l.length;s++){l[s].created=a.$api.dateFormat("yyyy-MM-dd",l[s].created);for(var o=0;o<a.pageData.statusList.length;o++)if(l[s].status==a.pageData.statusList[o].value){l[s].statusName=a.pageData.statusList[o].name;break}for(var i=0;i<a.pageData.shopTypeList.length;i++)if(l[s].shopType==a.pageData.shopTypeList[i].shopType){l[s].induName=a.pageData.shopTypeList[i].induName;break}}a.pageData.tableObj.list=l}else a.$message.error(t.message)}).catch(function(t){setTimeout(function(){e.close()},500),a.$message.error("系统错误："+t)})},handleSizeChange:function(a){this.pageData.tableObj.pageSize=a,this.queryEvt()},handleCurrentChange:function(a){this.pageData.tableObj.currentPage=a,this.queryEvt()}}},d={render:function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("el-main",[t("div",{staticClass:"container-fluid"},[t("el-breadcrumb",{staticClass:"breadcrumb",attrs:{"separator-class":"el-icon-arrow-right"}},[t("el-breadcrumb-item",{attrs:{to:{name:"homeLink"}}},[t("i",{staticClass:"glyphicon glyphicon-home"}),a._v("首页")]),a._v(" "),t("el-breadcrumb-item",[a._v("店铺配置")]),a._v(" "),t("el-breadcrumb-item",[a._v("事业组维护")])],1)],1),a._v(" "),t("div",{staticClass:"rtl-custom-box mt15"},[t("div",{staticClass:"box-hd"},[t("div",{staticClass:"cont"},[t("div",{staticClass:"form-horizontal"},[t("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:a.pageData.tableObj}},[t("el-row",[t("el-col",{attrs:{span:6}},[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("门店号码：")])]),a._v(" "),t("el-col",{attrs:{span:16}},[t("el-form-item",[t("el-input",{attrs:{disabled:a.addDialogDisabled,placeholder:"请输入门店号",clearable:""},model:{value:a.pageData.tableObj.siteNo,callback:function(e){a.$set(a.pageData.tableObj,"siteNo",e)},expression:"pageData.tableObj.siteNo"}})],1)],1)],1),a._v(" "),t("el-col",{attrs:{span:6}},[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("状态：")])]),a._v(" "),t("el-col",{attrs:{span:16}},[t("el-form-item",[t("el-select",{model:{value:a.pageData.tableObj.status,callback:function(e){a.$set(a.pageData.tableObj,"status",e)},expression:"pageData.tableObj.status"}},a._l(a.pageData.statusList,function(a){return t("el-option",{key:a.value,attrs:{label:a.name,value:a.value}})}))],1)],1)],1),a._v(" "),t("el-col",{attrs:{span:6}},[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("小店类型：")])]),a._v(" "),t("el-col",{attrs:{span:16}},[t("el-form-item",[t("el-select",{model:{value:a.pageData.tableObj.shopType,callback:function(e){a.$set(a.pageData.tableObj,"shopType",e)},expression:"pageData.tableObj.shopType"}},[t("el-option",{attrs:{label:"全部",value:""}}),a._v(" "),a._l(a.pageData.shopTypeList,function(a){return t("el-option",{key:a.shopType,attrs:{label:a.induName+a.shopType,value:a.shopType}})})],2)],1)],1)],1),a._v(" "),t("el-col",{staticClass:"text-center",attrs:{span:6}},[t("el-form-item",[t("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(e){return e.stopPropagation(),a.queryEvt(e)}}},[a._v("查询")])],1)],1)],1)],1)],1)])])]),a._v(" "),t("div",{staticClass:"box-bd pr mt15"},[t("div",{staticClass:"tab-content custom-content"},[t("div",{staticClass:"tab-pane in active"},[t("el-row",{staticClass:"mb10"},[t("el-col",{attrs:{span:12}},[t("el-button",{attrs:{type:"primary",icon:"el-icon-edit-outline"},on:{click:function(e){e.stopPropagation(),a.pageData.addDialog.dialogFormVisible=!0}}},[a._v("新建")])],1)],1),a._v(" "),t("div",{staticClass:"table-responsive"},[t("el-table",{staticStyle:{width:"100%"},attrs:{border:"",data:a.pageData.tableObj.list}},[t("el-table-column",{attrs:{sortable:"",prop:"id",label:"序号","min-width":"90"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"siteNo",label:"门店","min-width":"90"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"shopNo",label:"事业组编号","min-width":"130"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"shopName",label:"事业组名称","min-width":"130"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"chargeName",label:"事业组负责人","min-width":"150"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"shopType",label:"架构类型","min-width":"120"},scopedSlots:a._u([{key:"default",fn:function(e){return[t("span",[a._v(a._s(e.row.induName+e.row.shopType))])]}}])}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"statusName",label:"状态","min-width":"90"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"creator",label:"发布人","min-width":"110"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"created",label:"发布时间","min-width":"120"}}),a._v(" "),t("el-table-column",{attrs:{fixed:"right",label:"操作","min-width":"100"},scopedSlots:a._u([{key:"default",fn:function(e){return[t("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(t){t.stopPropagation(),t.preventDefault(),a.showUpdate(e.$index,e)}}},[a._v("编辑")]),a._v(" "),t("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(t){t.stopPropagation(),t.preventDefault(),a.statusEvt(e.$index,e)}}},[a._v(a._s(1==e.row.status?"禁用":"启用"))])]}}])})],1)],1),a._v(" "),t("div",{staticClass:"page"},[t("div",{staticClass:"block p15 text-center"},[t("el-pagination",{attrs:{"current-page":a.pageData.tableObj.currentPage,"page-sizes":a.pageData.tableObj.pageArray,"page-size":a.pageData.tableObj.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:a.pageData.tableObj.totalRows},on:{"size-change":a.handleSizeChange,"current-change":a.handleCurrentChange}})],1)])],1)])]),a._v(" "),t("el-dialog",{attrs:{title:"事业组维护",visible:a.pageData.addDialog.dialogFormVisible,width:"50%","before-close":a.clearEvt},on:{"update:visible":function(e){a.$set(a.pageData.addDialog,"dialogFormVisible",e)}}},[t("el-form",{staticClass:"form-horizontal"},[t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("门店号：")])]),a._v(" "),t("el-col",{attrs:{span:16}},[a.pageData.addDialog.isUpdate?a._e():t("el-input",{attrs:{disabled:a.addDialogDisabled,"auto-complete":"off"},model:{value:a.pageData.addDialog.create.siteNo,callback:function(e){a.$set(a.pageData.addDialog.create,"siteNo",e)},expression:"pageData.addDialog.create.siteNo"}}),a._v(" "),a.pageData.addDialog.isUpdate?t("el-input",{attrs:{disabled:a.pageData.addDialog.isUpdate,"auto-complete":"off"},model:{value:a.pageData.addDialog.create.siteNo,callback:function(e){a.$set(a.pageData.addDialog.create,"siteNo",e)},expression:"pageData.addDialog.create.siteNo"}}):a._e()],1)],1)],1),a._v(" "),t("el-col",{attrs:{span:12}},[t("el-form-item",[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("小店类型：")])]),a._v(" "),t("el-col",{attrs:{span:16}},[t("el-select",{attrs:{disabled:a.pageData.addDialog.isUpdate},on:{change:a.siteNoEvt},model:{value:a.pageData.addDialog.create.shopType,callback:function(e){a.$set(a.pageData.addDialog.create,"shopType",e)},expression:"pageData.addDialog.create.shopType"}},[t("el-option",{attrs:{label:"全部",value:""}}),a._v(" "),a._l(a.pageData.shopTypeList,function(a){return t("el-option",{key:a.shopType,attrs:{label:a.induName+a.shopType,value:a.shopType}})})],2)],1)],1)],1)],1)],1),a._v(" "),t("el-table",{staticStyle:{width:"100%","margin-bottom":"10px"},attrs:{border:"",data:a.pageData.addDialog.create.list,"max-height":"490"}},[t("el-table-column",{attrs:{sortable:"",prop:"shopName",label:"小店"}}),a._v(" "),t("el-table-column",{attrs:{label:"小店负责人"},scopedSlots:a._u([{key:"default",fn:function(e){return[t("el-input",{model:{value:e.row.chargeName,callback:function(t){a.$set(e.row,"chargeName",t)},expression:"scope.row.chargeName"}})]}}])})],1),a._v(" "),t("div",{staticClass:"text-center"},[a.pageData.addDialog.isUpdate?a._e():t("el-button",{attrs:{type:"primary",icon:"el-icon-star-on"},on:{click:function(e){return e.stopPropagation(),a.addEvt(e)}}},[a._v("新增")]),a._v(" "),a.pageData.addDialog.isUpdate?t("el-button",{attrs:{type:"primary",icon:"el-icon-star-on"},on:{click:function(e){return e.stopPropagation(),a.updateEvt(e)}}},[a._v("修改")]):a._e(),a._v(" "),t("el-button",{attrs:{icon:"el-icon-circle-close-outline"},on:{click:function(e){return e.stopPropagation(),a.clearEvt(e)}}},[a._v("取消")])],1)],1)],1)},staticRenderFns:[]};var b=t("VU/8")(u,d,!1,function(a){t("Y4aF")},"data-v-31d31b7f",null).exports,m={data:function(){return{pageData:{queryObj:{query0:"",query1:"",query2:""},tableObj:{currentPage:1,pageSize:10,totalPage:1,totalRows:1,pageArray:[10,20,30,40,50],list:[]},addDialog:{dialogFormVisible:!1,form:{},formLabelWidth:"120px"},updateDialog:{dialogFormVisible:!1,form:{},formLabelWidth:"120px"}}}},methods:{queryEvt:function(){console.log("submit!"),fetch("/apis/wumart/partner/create",{method:"get",headers:{"Content-type":"application/json"}}).then(function(a){return console.log(a),a.json()}).then(function(a){console.log(a)}).catch(function(a){return console.log(a)})},handleSizeChange:function(a){console.log("每页 "+a+" 条")},handleCurrentChange:function(a){console.log("当前页: "+a)}}},g={render:function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("el-main",[t("div",{staticClass:"container-fluid"},[t("el-breadcrumb",{staticClass:"breadcrumb",attrs:{"separator-class":"el-icon-arrow-right"}},[t("el-breadcrumb-item",{attrs:{to:{name:"homeLink"}}},[t("i",{staticClass:"glyphicon glyphicon-home"}),a._v("首页")]),a._v(" "),t("el-breadcrumb-item",[a._v("店铺科目配置")]),a._v(" "),t("el-breadcrumb-item",[a._v("科目维护")])],1)],1),a._v(" "),t("div",{staticClass:"rtl-custom-box mt15"},[t("div",{staticClass:"box-hd"},[t("div",{staticClass:"cont"},[t("div",{staticClass:"form-horizontal"},[t("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:a.pageData.queryObj}},[t("el-row",[t("el-col",{attrs:{span:6}},[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("科目：")])]),a._v(" "),t("el-col",{attrs:{span:16}},[t("el-form-item",[t("el-select",{model:{value:a.pageData.queryObj.query0,callback:function(e){a.$set(a.pageData.queryObj,"query0",e)},expression:"pageData.queryObj.query0"}},[t("el-option",{attrs:{label:"全部",value:"shanghai"}})],1)],1)],1)],1),a._v(" "),t("el-col",{attrs:{span:6}},[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("类型：")])]),a._v(" "),t("el-col",{attrs:{span:16}},[t("el-form-item",[t("el-select",{model:{value:a.pageData.queryObj.query1,callback:function(e){a.$set(a.pageData.queryObj,"query1",e)},expression:"pageData.queryObj.query1"}},[t("el-option",{attrs:{label:"全部",value:"shanghai"}})],1)],1)],1)],1),a._v(" "),t("el-col",{attrs:{span:6}},[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("状态：")])]),a._v(" "),t("el-col",{attrs:{span:16}},[t("el-form-item",[t("el-select",{model:{value:a.pageData.queryObj.query2,callback:function(e){a.$set(a.pageData.queryObj,"query2",e)},expression:"pageData.queryObj.query2"}},[t("el-option",{attrs:{label:"全部",value:"shanghai"}})],1)],1)],1)],1),a._v(" "),t("el-col",{staticClass:"text-center",attrs:{span:6}},[t("el-form-item",[t("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:a.queryEvt}},[a._v("查询")])],1)],1)],1)],1)],1)])])]),a._v(" "),t("div",{staticClass:"box-bd pr mt15"},[t("div",{staticClass:"tab-content custom-content"},[t("div",{staticClass:"tab-pane in active"},[t("el-row",{staticClass:"mb10"},[t("el-col",{attrs:{span:12}},[t("el-button",{attrs:{type:"primary",icon:"el-icon-edit-outline"},on:{click:function(e){a.pageData.addDialog.dialogFormVisible=!0}}},[a._v("新建")])],1)],1),a._v(" "),t("div",{staticClass:"table-responsive"},[t("el-table",{staticStyle:{width:"100%"},attrs:{border:"",data:a.pageData.tableObj.list}},[t("el-table-column",{attrs:{prop:"date",sortable:"",label:"序号"}}),a._v(" "),t("el-table-column",{attrs:{prop:"name",label:"科目编号"}}),a._v(" "),t("el-table-column",{attrs:{prop:"province",label:"科目名称"}}),a._v(" "),t("el-table-column",{attrs:{prop:"city",label:"科目类型"}}),a._v(" "),t("el-table-column",{attrs:{prop:"address",label:"状态"}}),a._v(" "),t("el-table-column",{attrs:{prop:"zip",label:"发布人"}}),a._v(" "),t("el-table-column",{attrs:{prop:"zip",label:"发布时间"}}),a._v(" "),t("el-table-column",{attrs:{fixed:"right",label:"操作",width:"120"},scopedSlots:a._u([{key:"default",fn:function(e){return[t("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(t){t.preventDefault(),a.deleteRow(e.$index,a.pageData.tableObj.list)}}},[a._v("编辑")]),a._v(" "),t("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(t){t.preventDefault(),a.deleteRow(e.$index,a.pageData.tableObj.list)}}},[a._v("禁用")])]}}])})],1)],1),a._v(" "),t("div",{staticClass:"page"},[t("div",{staticClass:"block p15 text-center"},[t("el-pagination",{attrs:{"current-page":a.pageData.tableObj.currentPage,"page-sizes":a.pageData.tableObj.pageArray,"page-size":a.pageData.tableObj.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:a.pageData.tableObj.totalRows},on:{"size-change":a.handleSizeChange,"current-change":a.handleCurrentChange}})],1)])],1)])]),a._v(" "),t("el-dialog",{attrs:{title:"新增科目维护",visible:a.pageData.addDialog.dialogFormVisible,width:"40%"},on:{"update:visible":function(e){a.$set(a.pageData.addDialog,"dialogFormVisible",e)}}},[t("el-form",{staticClass:"form-horizontal",attrs:{model:a.pageData.addDialog.form}},[t("el-form-item",[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("科目编号：")])]),a._v(" "),t("el-col",{attrs:{span:10}},[t("el-input",{attrs:{placeholder:"请输入科目编号","auto-complete":"off"},model:{value:a.pageData.addDialog.form.name,callback:function(e){a.$set(a.pageData.addDialog.form,"name",e)},expression:"pageData.addDialog.form.name"}})],1)],1),a._v(" "),t("el-form-item",[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("科目名称：")])]),a._v(" "),t("el-col",{attrs:{span:10}},[t("el-input",{attrs:{placeholder:"输入科目名称","auto-complete":"off"},model:{value:a.pageData.addDialog.form.name,callback:function(e){a.$set(a.pageData.addDialog.form,"name",e)},expression:"pageData.addDialog.form.name"}})],1)],1),a._v(" "),t("el-form-item",[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("科目类型：")])]),a._v(" "),t("el-col",{attrs:{span:10}},[t("el-select",{model:{value:a.pageData.addDialog.form.region,callback:function(e){a.$set(a.pageData.addDialog.form,"region",e)},expression:"pageData.addDialog.form.region"}},[t("el-option",{attrs:{label:"请选类型",value:""}}),a._v(" "),t("el-option",{attrs:{label:"区域二",value:"beijing"}})],1)],1)],1),a._v(" "),t("div",{staticClass:"text-left",style:{marginLeft:a.pageData.addDialog.formLabelWidth}},[t("el-button",{attrs:{type:"primary"},on:{click:function(e){a.pageData.addDialog.dialogFormVisible=!1}}},[a._v("保 存")]),a._v(" "),t("el-button",{on:{click:function(e){a.pageData.addDialog.dialogFormVisible=!1}}},[a._v("取 消")])],1)],1)],1),a._v(" "),t("el-dialog",{attrs:{title:"修改科目维护",visible:a.pageData.updateDialog.dialogFormVisible,width:"40%"},on:{"update:visible":function(e){a.$set(a.pageData.updateDialog,"dialogFormVisible",e)}}},[t("el-form",{staticClass:"form-horizontal",attrs:{model:a.pageData.updateDialog.form}},[t("el-form-item",[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("科目编号：")])]),a._v(" "),t("el-col",{attrs:{span:10}},[t("el-input",{attrs:{placeholder:"请输入科目编号","auto-complete":"off"},model:{value:a.pageData.updateDialog.form.name,callback:function(e){a.$set(a.pageData.updateDialog.form,"name",e)},expression:"pageData.updateDialog.form.name"}})],1)],1),a._v(" "),t("el-form-item",[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("科目名称：")])]),a._v(" "),t("el-col",{attrs:{span:10}},[t("el-input",{attrs:{placeholder:"输入科目名称","auto-complete":"off"},model:{value:a.pageData.updateDialog.form.name,callback:function(e){a.$set(a.pageData.updateDialog.form,"name",e)},expression:"pageData.updateDialog.form.name"}})],1)],1),a._v(" "),t("el-form-item",[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("科目类型：")])]),a._v(" "),t("el-col",{attrs:{span:10}},[t("el-select",{model:{value:a.pageData.updateDialog.form.region,callback:function(e){a.$set(a.pageData.updateDialog.form,"region",e)},expression:"pageData.updateDialog.form.region"}},[t("el-option",{attrs:{label:"请选类型",value:""}}),a._v(" "),t("el-option",{attrs:{label:"区域二",value:"beijing"}})],1)],1)],1),a._v(" "),t("el-form-item",[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("状态：")])]),a._v(" "),t("el-col",{attrs:{span:10}},[t("el-input",{attrs:{disabled:"",placeholder:"","auto-complete":"off"},model:{value:a.pageData.updateDialog.form.name,callback:function(e){a.$set(a.pageData.updateDialog.form,"name",e)},expression:"pageData.updateDialog.form.name"}})],1)],1),a._v(" "),t("el-form-item",[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("发布人：")])]),a._v(" "),t("el-col",{attrs:{span:10}},[t("el-input",{attrs:{disabled:"",placeholder:"","auto-complete":"off"},model:{value:a.pageData.updateDialog.form.name,callback:function(e){a.$set(a.pageData.updateDialog.form,"name",e)},expression:"pageData.updateDialog.form.name"}})],1)],1),a._v(" "),t("el-form-item",[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("发布时间：")])]),a._v(" "),t("el-col",{attrs:{span:10}},[t("el-input",{attrs:{disabled:"",placeholder:"","auto-complete":"off"},model:{value:a.pageData.updateDialog.form.name,callback:function(e){a.$set(a.pageData.updateDialog.form,"name",e)},expression:"pageData.updateDialog.form.name"}})],1)],1),a._v(" "),t("div",{staticClass:"text-left",style:{marginLeft:a.pageData.updateDialog.formLabelWidth}},[t("el-button",{attrs:{type:"primary"},on:{click:function(e){a.pageData.updateDialog.dialogFormVisible=!1}}},[a._v("保 存")]),a._v(" "),t("el-button",{on:{click:function(e){a.pageData.updateDialog.dialogFormVisible=!1}}},[a._v("取 消")])],1)],1)],1)],1)},staticRenderFns:[]};var h=t("VU/8")(m,g,!1,function(a){t("Qib/")},"data-v-2a00e542",null).exports,v={data:function(){return{pageData:{queryObj:{query0:"",query1:"",query2:""},tableObj:{currentPage:1,pageSize:10,totalPage:1,totalRows:1,pageArray:[10,20,30,40,50],list:[]}}}},methods:{queryEvt:function(){console.log("submit!")},handleSizeChange:function(a){console.log("每页 "+a+" 条")},handleCurrentChange:function(a){console.log("当前页: "+a)}}},f={render:function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("el-main",[t("div",{staticClass:"container-fluid"},[t("el-breadcrumb",{staticClass:"breadcrumb",attrs:{"separator-class":"el-icon-arrow-right"}},[t("el-breadcrumb-item",{attrs:{to:{name:"homeLink"}}},[t("i",{staticClass:"glyphicon glyphicon-home"}),a._v("首页")]),a._v(" "),t("el-breadcrumb-item",[a._v("店铺科目配置")]),a._v(" "),t("el-breadcrumb-item",[a._v("科目应用类型维护")])],1)],1),a._v(" "),t("div",{staticClass:"rtl-custom-box mt15"},[t("div",{staticClass:"box-hd"},[t("div",{staticClass:"cont"},[t("div",{staticClass:"form-horizontal"},[t("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:a.pageData.queryObj}},[t("el-row",[t("el-col",{attrs:{span:6}},[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("类型名称：")])]),a._v(" "),t("el-col",{attrs:{span:16}},[t("el-form-item",[t("el-input",{attrs:{placeholder:"请输入类型名称"},model:{value:a.pageData.queryObj.query0,callback:function(e){a.$set(a.pageData.queryObj,"query0",e)},expression:"pageData.queryObj.query0"}})],1)],1)],1),a._v(" "),t("el-col",{attrs:{span:6}},[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("类别：")])]),a._v(" "),t("el-col",{attrs:{span:16}},[t("el-form-item",[t("el-select",{model:{value:a.pageData.queryObj.query1,callback:function(e){a.$set(a.pageData.queryObj,"query1",e)},expression:"pageData.queryObj.query1"}},[t("el-option",{attrs:{label:"全部",value:"shanghai"}})],1)],1)],1)],1),a._v(" "),t("el-col",{staticClass:"text-center",attrs:{span:6}},[t("el-form-item",[t("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:a.queryEvt}},[a._v("查询")])],1)],1)],1)],1)],1)])])]),a._v(" "),t("div",{staticClass:"box-bd pr mt15"},[t("div",{staticClass:"tab-content custom-content"},[t("div",{staticClass:"tab-pane in active"},[t("div",{staticClass:"table-responsive"},[t("el-table",{staticStyle:{width:"100%"},attrs:{border:"",data:a.pageData.tableObj.list}},[t("el-table-column",{attrs:{prop:"date",label:"ID"}}),a._v(" "),t("el-table-column",{attrs:{prop:"name",label:"应用类型名称"}}),a._v(" "),t("el-table-column",{attrs:{prop:"city",label:"类别"}})],1)],1),a._v(" "),t("div",{staticClass:"page"},[t("div",{staticClass:"block p15 text-center"},[t("el-pagination",{attrs:{"current-page":a.pageData.tableObj.currentPage,"page-sizes":a.pageData.tableObj.pageArray,"page-size":a.pageData.tableObj.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:a.pageData.tableObj.totalRows},on:{"size-change":a.handleSizeChange,"current-change":a.handleCurrentChange}})],1)])])])])])},staticRenderFns:[]};var D=t("VU/8")(v,f,!1,function(a){t("TaJK")},"data-v-3978e7f8",null).exports,_={data:function(){return{addDialogDisabled:!1,pageData:{statusList:[{name:"全部",value:"-1"},{name:"提交",value:"0"},{name:"驳回",value:"1"},{name:"已审批",value:"2"}],tableObj:{siteNo:"",oaStatus:"-1",mandt:"",startTime:"",endTime:"",currentPage:1,pageSize:10,totalPage:1,totalRows:1,pageArray:[10,20,30,40,50],list:[]},addDialog:{switch:!0,tableHeight:0,isDetail:!1,dialogFormVisible:!1,createArea:{mandt:"",oaId:"",siteNo:"",siteName:"",totalArea:"",oaStatus:"0",auditorId:"",auditorName:"",delFlag:"",creator:"",created:this.$api.getDateFunc(!0),oaAreaItemList:[]},formLabelWidth:"120px"},updateDialog:{dialogFormVisible:!1,form:{},formLabelWidth:"120px"}}}},created:function(){this.commonInfo();var a=document.documentElement.clientHeight;this.pageData.addDialog.tableHeight=.4*a},methods:{initFunc:function(){this.queryEvt()},commonInfo:function(){var a=this,e=this.$loading({lock:!0,spinner:"wm-icon-loading",background:"rgba(0, 0, 0, 0.7)"});fetch(this.$api.urls.POST_QUERYCOMMONINFO,{method:"post",headers:{"Content-type":"application/json"},credentials:"include",body:p()({})}).then(function(a){return a.json()}).then(function(t){setTimeout(function(){e.close()},500),t.success?(a.$store.dispatch("setMandt",t.model.mandt),a.$store.dispatch("setIndu",t.model.indu),a.$store.dispatch("setSiteNo",t.model.siteNo),a.pageData.tableObj.mandt=a.$store.getters.mandt,a.pageData.addDialog.createArea.siteNo=a.$store.getters.siteNo,a.pageData.tableObj.siteNo=a.$store.getters.siteNo,""!=t.model.siteNo&&(a.addDialogDisabled=!0),a.initFunc()):a.$message.error(t.message)}).catch(function(t){setTimeout(function(){e.close()},500),a.$message.error("错误："+t)})},clearEvt:function(){this.pageData.addDialog.createArea={mandt:"",oaId:"",siteNo:this.$store.getters.siteNo,siteName:"",totalArea:"",oaStatus:"0",auditorId:"",auditorName:"",delFlag:"",creator:"",created:this.$api.getDateFunc(!0),oaAreaItemList:[]},this.pageData.addDialog.dialogFormVisible=!1,this.pageData.addDialog.isDetail=!1},showDislog:function(){""!=this.pageData.addDialog.createArea.siteNo?this.siteNoEvt():this.pageData.addDialog.dialogFormVisible=!0},siteNoEvt:function(){var a=this;if(""==this.pageData.addDialog.createArea.siteNo)return this.$message({message:"请输入门店编号!",type:"warning"}),!1;var e=this.$loading({lock:!0,spinner:"wm-icon-loading",background:"rgba(0, 0, 0, 0.7)"}),t={siteNo:this.pageData.addDialog.createArea.siteNo};fetch(this.$api.urls.POST_QUERYCOMMONINFO,{method:"post",headers:{"Content-type":"application/json"},credentials:"include",body:p()(t)}).then(function(a){return a.json()}).then(function(t){if(setTimeout(function(){e.close()},500),t.success){for(var l=t.model,s={mandt:l.mandt,oaId:"",siteNo:a.pageData.addDialog.createArea.siteNo,siteName:l.siteName,totalArea:l.totalArea,oaStatus:"0",auditorId:"",auditorName:"",delFlag:"",creator:"",created:a.$api.getDateFunc(!0),oaAreaItemList:[]},o=0;o<l.partnerTeam.length;o++)s.oaAreaItemList.push({mainId:"",partnerTeamNo:l.partnerTeam[o].partnerTeamNo,nowArea:l.partnerTeam[o].nowArea,newArea:"",partnerTeamName:l.partnerTeam[o].partnerTeamName,creator:l.partnerTeam[o].creator,created:l.partnerTeam[o].created,modified:l.partnerTeam[o].modified,mandt:l.partnerTeam[o].mandt});a.pageData.addDialog.createArea=s,a.pageData.addDialog.dialogFormVisible=!0}else a.pageData.addDialog.createArea={mandt:"",oaId:"",siteNo:a.$store.getters.siteNo,siteName:"",totalArea:"",oaStatus:"0",auditorId:"",auditorName:"",delFlag:"",creator:"",created:a.$api.getDateFunc(!0),oaAreaItemList:[]},a.pageData.addDialog.dialogFormVisible=!0,a.pageData.addDialog.isDetail=!1,a.$message.error(t.message)}).catch(function(t){setTimeout(function(){e.close()},500),a.$message.error("系统错误："+t)})},addEvt:function(){var a=this;if(""==this.pageData.addDialog.createArea.siteNo)return this.$message({message:"请输入门店编号!",type:"warning"}),!1;for(var e=0;e<this.pageData.addDialog.createArea.oaAreaItemList.length;e++)if(""==this.pageData.addDialog.createArea.oaAreaItemList[e].newArea)return this.$message({message:"请输入变更后面积!",type:"warning"}),!1;var t=this.$loading({lock:!0,spinner:"wm-icon-loading",background:"rgba(0, 0, 0, 0.7)"}),l=this.pageData.addDialog.createArea;fetch(this.$api.urls.POST_AREA_CREATEAREA,{method:"post",headers:{"Content-type":"application/json"},credentials:"include",body:p()(l)}).then(function(a){return a.json()}).then(function(e){setTimeout(function(){t.close()},500),e.success?(a.pageData.addDialog.dialogFormVisible=!1,a.$alert("新增面积维护成功","提示",{confirmButtonText:"确定",type:"success",center:!0,callback:function(e){a.queryEvt(),a.clearEvt()}})):a.$message.error(e.message)}).catch(function(e){setTimeout(function(){t.close()},500),a.$message.error("系统错误："+e)})},detailEvt:function(a,e){var t=this;this.pageData.addDialog.isDetail=!0;var l=this.$loading({lock:!0,spinner:"wm-icon-loading",background:"rgba(0, 0, 0, 0.7)"}),s={mandt:this.pageData.tableObj.mandt,mainId:e.row.id,siteNo:e.row.siteNo};fetch(this.$api.urls.POST_AREA_QUERYAREAITEM,{method:"post",headers:{"Content-type":"application/json"},credentials:"include",body:p()(s)}).then(function(a){return a.json()}).then(function(a){if(setTimeout(function(){l.close()},500),a.success){for(var s="",o=0;o<t.pageData.statusList.length;o++)if(t.pageData.statusList[o].value==e.row.oaStatus){s=t.pageData.statusList[o].name;break}t.pageData.addDialog.createArea={id:e.row.id,mandt:e.row.mandt,oaId:e.row.oaId,siteNo:e.row.siteNo,siteName:e.row.siteName,totalArea:e.row.totalArea,oaStatus:e.row.oaStatus,oaStatusName:s,auditorId:e.row.auditorId,auditorName:e.row.auditorName,delFlag:e.row.delFlag,creator:e.row.creator,created:e.row.created,oaAreaItemList:a.model},t.pageData.addDialog.dialogFormVisible=!0}else t.$message.error(a.message)}).catch(function(a){setTimeout(function(){l.close()},500),t.$message.error("系统错误："+a)})},queryEvt:function(){var a=this,e={siteNo:this.pageData.tableObj.siteNo,oaStatus:this.pageData.tableObj.oaStatus,startTime:this.pageData.tableObj.startTime,endTime:this.pageData.tableObj.endTime,mandt:this.pageData.tableObj.mandt,currentPage:this.pageData.tableObj.currentPage,pageSize:this.pageData.tableObj.pageSize};if(this.$api.compareDate(e.startTime,e.endTime))return this.$message({message:"开始时间不能大于结束时间!",type:"warning"}),!1;var t=this.$loading({lock:!0,spinner:"wm-icon-loading",background:"rgba(0, 0, 0, 0.7)"});fetch(this.$api.urls.POST_AREA_QUERYAREAMAIN,{method:"post",headers:{"Content-type":"application/json"},credentials:"include",body:p()(e)}).then(function(a){return a.json()}).then(function(e){if(setTimeout(function(){t.close()},500),e.success){a.pageData.tableObj.currentPage=e.model.currentPage,a.pageData.tableObj.pageSize=e.model.pageSize,a.pageData.tableObj.totalPage=e.model.pageCount,a.pageData.tableObj.totalRows=e.model.count;for(var l=e.model.data,s=0;s<l.length;s++){l[s].created=a.$api.dateFormat("yyyy-MM-dd",l[s].created);for(var o=0;o<a.pageData.statusList.length;o++)if(l[s].oaStatus==a.pageData.statusList[o].value){l[s].oaStatusName=a.pageData.statusList[o].name;break}}a.pageData.tableObj.list=l}else a.$message.error(e.message)}).catch(function(e){setTimeout(function(){t.close()},500),a.$message.error("系统错误："+e)})},handleSizeChange:function(a){this.pageData.tableObj.pageSize=a,this.queryEvt()},handleCurrentChange:function(a){this.pageData.tableObj.currentPage=a,this.queryEvt()}}},y={render:function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("el-main",[t("div",{staticClass:"container-fluid"},[t("el-breadcrumb",{staticClass:"breadcrumb",attrs:{"separator-class":"el-icon-arrow-right"}},[t("el-breadcrumb-item",{attrs:{to:{name:"homeLink"}}},[t("i",{staticClass:"glyphicon glyphicon-home"}),a._v("首页")]),a._v(" "),t("el-breadcrumb-item",[a._v("店铺费用管理")]),a._v(" "),t("el-breadcrumb-item",[a._v("面积维护")])],1)],1),a._v(" "),t("div",{staticClass:"rtl-custom-box mt15"},[t("div",{staticClass:"box-hd"},[t("div",{staticClass:"cont"},[t("div",{staticClass:"form-horizontal"},[t("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0}},[t("el-row",[t("el-col",{attrs:{span:6}},[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("门店号码：")])]),a._v(" "),t("el-col",{attrs:{span:16}},[t("el-form-item",[t("el-input",{attrs:{disabled:a.addDialogDisabled,placeholder:"请输入门店号",clearable:""},model:{value:a.pageData.tableObj.siteNo,callback:function(e){a.$set(a.pageData.tableObj,"siteNo",e)},expression:"pageData.tableObj.siteNo"}})],1)],1)],1),a._v(" "),t("el-col",{attrs:{span:6}},[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("审批状态：")])]),a._v(" "),t("el-col",{attrs:{span:16}},[t("el-form-item",[t("el-select",{model:{value:a.pageData.tableObj.oaStatus,callback:function(e){a.$set(a.pageData.tableObj,"oaStatus",e)},expression:"pageData.tableObj.oaStatus"}},a._l(a.pageData.statusList,function(a){return t("el-option",{key:a.value,attrs:{label:a.name,value:a.value}})}))],1)],1)],1),a._v(" "),t("el-col",{attrs:{span:12}},[t("el-col",{attrs:{span:4}},[t("label",{staticClass:"control-label"},[a._v("提交时间：")])]),a._v(" "),t("el-col",{attrs:{span:20}},[t("el-col",{attrs:{span:10}},[t("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",align:"right",type:"date",placeholder:"请选择日期"},model:{value:a.pageData.tableObj.startTime,callback:function(e){a.$set(a.pageData.tableObj,"startTime",e)},expression:"pageData.tableObj.startTime"}})],1),a._v(" "),t("el-col",{staticClass:"text-center",staticStyle:{"line-height":"40px"},attrs:{span:2}},[a._v("-")]),a._v(" "),t("el-col",{attrs:{span:10}},[t("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",align:"right",type:"date",placeholder:"请选择日期"},model:{value:a.pageData.tableObj.endTime,callback:function(e){a.$set(a.pageData.tableObj,"endTime",e)},expression:"pageData.tableObj.endTime"}})],1)],1)],1)],1),a._v(" "),t("el-row",[t("el-col",{staticClass:"text-center",attrs:{span:24}},[t("el-form-item",[t("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(e){return e.stopPropagation(),a.queryEvt(e)}}},[a._v("查询")])],1)],1)],1)],1)],1)])])]),a._v(" "),t("div",{staticClass:"box-bd pr mt15"},[t("div",{staticClass:"tab-content custom-content"},[t("div",{staticClass:"tab-pane in active"},[t("el-row",{staticClass:"mb10"},[t("el-col",{attrs:{span:12}},[t("el-button",{attrs:{type:"primary",icon:"el-icon-edit-outline"},on:{click:function(e){return e.stopPropagation(),a.showDislog(e)}}},[a._v("新建")])],1)],1),a._v(" "),t("div",{staticClass:"table-responsive"},[t("el-table",{staticStyle:{width:"100%"},attrs:{border:"",data:a.pageData.tableObj.list}},[t("el-table-column",{attrs:{sortable:"",prop:"id",label:"单号","min-width":"90"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"siteNo",label:"门店号","min-width":"110"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"siteName",label:"门店名称","min-width":"120"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"oaId",label:"OA单号","min-width":"120"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"auditorName",label:"当前审批人","min-width":"130"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"oaStatusName",label:"审批状态","min-width":"120"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"created",label:"提交时间","min-width":"120"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"creator",label:"提交人","min-width":"110"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"auditOpinion",label:"审批意见","min-width":"110"}}),a._v(" "),t("el-table-column",{attrs:{fixed:"right",label:"操作","min-width":"100"},scopedSlots:a._u([{key:"default",fn:function(e){return[t("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){t.stopPropagation(),a.detailEvt(e.$index,e)}}},[a._v("查看详情")])]}}])})],1)],1),a._v(" "),t("div",{staticClass:"page"},[t("div",{staticClass:"block p15 text-center"},[t("el-pagination",{attrs:{"current-page":a.pageData.tableObj.currentPage,"page-sizes":a.pageData.tableObj.pageArray,"page-size":a.pageData.tableObj.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:a.pageData.tableObj.totalRows},on:{"size-change":a.handleSizeChange,"current-change":a.handleCurrentChange}})],1)])],1)])]),a._v(" "),t("el-dialog",{attrs:{title:"面积维护",visible:a.pageData.addDialog.dialogFormVisible,width:"90%","before-close":a.clearEvt},on:{"update:visible":function(e){a.$set(a.pageData.addDialog,"dialogFormVisible",e)}}},[t("el-switch",{staticStyle:{display:"block",position:"absolute",top:"20px",right:"65px"},attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-text":"展开","inactive-text":"收起"},model:{value:a.pageData.addDialog.switch,callback:function(e){a.$set(a.pageData.addDialog,"switch",e)},expression:"pageData.addDialog.switch"}}),a._v(" "),a.pageData.addDialog.switch?t("el-form",{staticClass:"form-horizontal"},[t("el-row",[t("el-col",{attrs:{span:8}},[t("el-form-item",[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("变更单号：")])]),a._v(" "),t("el-col",{attrs:{span:16}},[t("el-input",{attrs:{disabled:!0,"auto-complete":"off",clearable:""},model:{value:a.pageData.addDialog.createArea.id,callback:function(e){a.$set(a.pageData.addDialog.createArea,"id",e)},expression:"pageData.addDialog.createArea.id"}})],1)],1)],1),a._v(" "),t("el-col",{attrs:{span:8}},[t("el-form-item",[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("门店：")])]),a._v(" "),t("el-col",{attrs:{span:16}},[a.pageData.addDialog.isDetail?a._e():t("el-input",{attrs:{disabled:a.addDialogDisabled,"auto-complete":"off",clearable:""},on:{blur:a.siteNoEvt},model:{value:a.pageData.addDialog.createArea.siteNo,callback:function(e){a.$set(a.pageData.addDialog.createArea,"siteNo",e)},expression:"pageData.addDialog.createArea.siteNo"}}),a._v(" "),a.pageData.addDialog.isDetail?t("el-input",{attrs:{disabled:a.pageData.addDialog.isDetail,"auto-complete":"off",clearable:""},on:{blur:a.siteNoEvt},model:{value:a.pageData.addDialog.createArea.siteNo,callback:function(e){a.$set(a.pageData.addDialog.createArea,"siteNo",e)},expression:"pageData.addDialog.createArea.siteNo"}}):a._e()],1)],1)],1),a._v(" "),t("el-col",{attrs:{span:8}},[t("el-form-item",[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("门店总面积：")])]),a._v(" "),t("el-col",{attrs:{span:16}},[t("el-input",{attrs:{disabled:a.pageData.addDialog.isDetail,"auto-complete":"off",clearable:""},model:{value:a.pageData.addDialog.createArea.totalArea,callback:function(e){a.$set(a.pageData.addDialog.createArea,"totalArea",e)},expression:"pageData.addDialog.createArea.totalArea"}})],1)],1)],1)],1),a._v(" "),t("el-row",[t("el-col",{attrs:{span:8}},[t("el-form-item",[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("OA单号：")])]),a._v(" "),t("el-col",{attrs:{span:16}},[t("el-input",{attrs:{disabled:!0,"auto-complete":"off",clearable:""},model:{value:a.pageData.addDialog.createArea.oaId,callback:function(e){a.$set(a.pageData.addDialog.createArea,"oaId",e)},expression:"pageData.addDialog.createArea.oaId"}})],1)],1)],1),a._v(" "),t("el-col",{attrs:{span:8}},[t("el-form-item",[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("*提交日期：")])]),a._v(" "),t("el-col",{attrs:{span:16}},[t("el-date-picker",{attrs:{disabled:!0,"value-format":"yyyy-MM-dd",type:"date",clearable:"",placeholder:"选择日期"},model:{value:a.pageData.addDialog.createArea.created,callback:function(e){a.$set(a.pageData.addDialog.createArea,"created",e)},expression:"pageData.addDialog.createArea.created"}})],1)],1)],1),a._v(" "),t("el-col",{attrs:{span:8}},[t("el-form-item",[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("状态：")])]),a._v(" "),t("el-col",{attrs:{span:16}},[a.pageData.addDialog.isDetail?t("el-input",{attrs:{disabled:a.pageData.addDialog.isDetail,"auto-complete":"off",clearable:""},model:{value:a.pageData.addDialog.createArea.oaStatusName,callback:function(e){a.$set(a.pageData.addDialog.createArea,"oaStatusName",e)},expression:"pageData.addDialog.createArea.oaStatusName"}}):a._e(),a._v(" "),a.pageData.addDialog.isDetail?a._e():t("el-select",{attrs:{disabled:!0,clearable:""},model:{value:a.pageData.addDialog.createArea.oaStatus,callback:function(e){a.$set(a.pageData.addDialog.createArea,"oaStatus",e)},expression:"pageData.addDialog.createArea.oaStatus"}},a._l(a.pageData.statusList,function(a){return t("el-option",{key:a.value,attrs:{label:a.name,value:a.value}})}))],1)],1)],1)],1)],1):a._e(),a._v(" "),t("el-table",{staticStyle:{width:"100%"},attrs:{border:"",data:a.pageData.addDialog.createArea.oaAreaItemList,"max-height":a.pageData.addDialog.tableHeight}},[t("el-table-column",{attrs:{sortable:"",prop:"partnerTeamName",label:"合伙人组"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"nowArea",label:"变更前面积"}}),a._v(" "),t("el-table-column",{attrs:{label:"变更后面积"},scopedSlots:a._u([{key:"default",fn:function(e){return[t("el-input",{attrs:{disabled:a.pageData.addDialog.isDetail},model:{value:e.row.newArea,callback:function(t){a.$set(e.row,"newArea",t)},expression:"scope.row.newArea"}})]}}])})],1),a._v(" "),a.pageData.addDialog.createArea.oaAreaItemList.length>0?t("el-row",{staticStyle:{background:"#EEF6FF"}},[t("el-col",{staticClass:"p10",attrs:{span:8}},[a._v("合计")]),a._v(" "),t("el-col",{staticClass:"p10",attrs:{span:8}},[a._v(a._s(a.pageData.addDialog.createArea.oaAreaItemList[0].oldTotalArea))]),a._v(" "),t("el-col",{staticClass:"p10",attrs:{span:8}},[a._v(a._s(a.pageData.addDialog.createArea.oaAreaItemList[0].nowTotalArea))])],1):a._e(),a._v(" "),t("div",{staticClass:"text-center"},[a.pageData.addDialog.isDetail?t("el-button",{attrs:{type:"danger",icon:"el-icon-circle-close-outline"},on:{click:function(e){return e.stopPropagation(),a.clearEvt(e)}}},[a._v("关闭")]):a._e(),a._v(" "),a.pageData.addDialog.isDetail?a._e():t("el-button",{attrs:{type:"success",icon:"el-icon-upload"},on:{click:function(e){return e.stopPropagation(),a.addEvt(e)}}},[a._v("提交")]),a._v(" "),a.pageData.addDialog.isDetail?a._e():t("el-button",{attrs:{icon:"el-icon-circle-close-outline"},on:{click:function(e){return e.stopPropagation(),a.clearEvt(e)}}},[a._v("取消")])],1)],1)],1)},staticRenderFns:[]};var O=t("VU/8")(_,y,!1,function(a){t("7oUx")},"data-v-3754ee62",null).exports,w={data:function(){return{addDialogDisabled:!1,pageData:{statusList:[{name:"全部",value:"-1"},{name:"提交",value:"0"},{name:"驳回",value:"1"},{name:"已审批",value:"2"}],budgetList:[],tableObj:{oaStatus:"-1",mandt:"",startTime:"",endTime:"",siteNo:"",budgetId:"",currentPage:1,pageSize:10,totalPage:1,totalRows:1,pageArray:[10,20,30,40,50],list:[]},addDialog:{switch:!0,tableHeight:0,isDetail:!1,dialogFormVisible:!1,createFee:{mandt:"",oaId:"",siteNo:"",siteName:"",totalFee:"",oaStatus:"0",auditorId:"",auditorName:"",delFlag:"",creator:"",budgetId:"",created:this.$api.dateFormat("yyyy-MM-dd",this.$api.getDateFunc(!0)),yearMonthStr:this.$api.dateFormat("yyyy-MM",this.$api.getDateFunc(!0)),oaFeeItemList:[]},formLabelWidth:"120px"},updateDialog:{dialogFormVisible:!1,form:{},formLabelWidth:"120px"}}}},created:function(){this.commonInfo();var a=document.documentElement.clientHeight;this.pageData.addDialog.tableHeight=.4*a},methods:{initFunc:function(){this.querySubjectType()},commonInfo:function(){var a=this,e=this.$loading({lock:!0,spinner:"wm-icon-loading",background:"rgba(0, 0, 0, 0.7)"});fetch(this.$api.urls.POST_QUERYCOMMONINFO,{method:"post",headers:{"Content-type":"application/json"},credentials:"include",body:p()({})}).then(function(a){return a.json()}).then(function(t){setTimeout(function(){e.close()},500),t.success?(a.$store.dispatch("setMandt",t.model.mandt),a.$store.dispatch("setIndu",t.model.indu),a.$store.dispatch("setSiteNo",t.model.siteNo),a.pageData.tableObj.mandt=a.$store.getters.mandt,a.pageData.addDialog.createFee.siteNo=a.$store.getters.siteNo,a.pageData.tableObj.siteNo=a.$store.getters.siteNo,""!=t.model.siteNo&&(a.addDialogDisabled=!0),a.initFunc()):a.$message.error(t.message)}).catch(function(t){setTimeout(function(){e.close()},500),a.$message.error("错误："+t)})},showDislog:function(){this.pageData.addDialog.dialogFormVisible=!0},getTotalFeeFromBigData:function(){var a=this,e=this.$loading({lock:!0,spinner:"wm-icon-loading",background:"rgba(0, 0, 0, 0.7)"}),t={yearMonthStr:this.pageData.addDialog.createFee.yearMonthStr,budgetId:this.pageData.addDialog.createFee.budgetId,siteNo:this.pageData.addDialog.createFee.siteNo};fetch(this.$api.urls.POST_FEE_TOTALFEEFROMBIDDATA,{method:"post",headers:{"Content-type":"application/json"},credentials:"include",body:p()(t)}).then(function(a){return a.json()}).then(function(t){setTimeout(function(){e.close()},500),t.success?a.pageData.addDialog.createFee.totalFee=t.model.amount:a.$message.error(t.message)}).catch(function(t){setTimeout(function(){e.close()},500),a.$message.error("系统错误："+t)})},totalFeeEvt:function(){},clearEvt:function(){this.pageData.addDialog.createFee={mandt:"",oaId:"",siteNo:this.$store.getters.siteNo,siteName:"",totalFee:"",oaStatus:"0",auditorId:"",auditorName:"",delFlag:"",creator:"",budgetId:"",created:this.$api.dateFormat("yyyy-MM-dd",this.$api.getDateFunc(!0)),yearMonthStr:this.$api.dateFormat("yyyy-MM",this.$api.getDateFunc(!0)),oaFeeItemList:[]},this.pageData.addDialog.dialogFormVisible=!1,this.pageData.addDialog.isDetail=!1},siteNoEvt:function(){var a=this;if(""==this.pageData.addDialog.createFee.siteNo)return this.$message({message:"请输入门店编号!",type:"warning"}),!1;var e=this.$loading({lock:!0,spinner:"wm-icon-loading",background:"rgba(0, 0, 0, 0.7)"}),t={siteNo:this.pageData.addDialog.createFee.siteNo,budgetId:this.pageData.addDialog.createFee.budgetId};fetch(this.$api.urls.POST_QUERYCOMMONINFO,{method:"post",headers:{"Content-type":"application/json"},credentials:"include",body:p()(t)}).then(function(a){return a.json()}).then(function(t){if(setTimeout(function(){e.close()},500),t.success){for(var l=t.model,s=a.pageData.addDialog.createFee.budgetId,o="",i=0;i<a.pageData.budgetList.length;i++)a.pageData.budgetList[i].budgetId==s&&(o=a.pageData.budgetList[i].budgetName);for(var n={mandt:l.mandt,oaId:"",siteNo:a.pageData.addDialog.createFee.siteNo,siteName:l.siteName,totalFee:"",oaStatus:"0",auditorId:"",auditorName:"",delFlag:"",creator:"",budgetId:s,created:a.$api.dateFormat("yyyy-MM-dd",a.$api.getDateFunc(!0)),yearMonthStr:a.$api.dateFormat("yyyy-MM",a.$api.getDateFunc(!0)),oaFeeItemList:[]},r=0;r<l.partnerTeam.length;r++)n.oaFeeItemList.push({mainId:"",partnerTeamNo:l.partnerTeam[r].partnerTeamNo,fee:"",budgetName:o,partnerTeamName:l.partnerTeam[r].partnerTeamName,creator:l.partnerTeam[r].creator,created:l.partnerTeam[r].created,modified:l.partnerTeam[r].modified,mandt:l.partnerTeam[r].mandt});a.pageData.addDialog.createFee=n,a.getTotalFeeFromBigData()}else a.pageData.addDialog.createFee={mandt:"",oaId:"",siteNo:a.$store.getters.siteNo,siteName:"",totalFee:"",oaStatus:"0",auditorId:"",auditorName:"",delFlag:"",creator:"",budgetId:"",created:a.$api.dateFormat("yyyy-MM-dd",a.$api.getDateFunc(!0)),yearMonthStr:a.$api.dateFormat("yyyy-MM",a.$api.getDateFunc(!0)),oaFeeItemList:[]},a.pageData.addDialog.dialogFormVisible=!0,a.pageData.addDialog.isDetail=!1,a.$message.error(t.message)}).catch(function(t){setTimeout(function(){e.close()},500),a.$message.error("系统错误："+t)})},detailEvt:function(a,e){var t=this;this.pageData.addDialog.isDetail=!0;var l=this.$loading({lock:!0,spinner:"wm-icon-loading",background:"rgba(0, 0, 0, 0.7)"}),s={mandt:this.pageData.tableObj.mandt,mainId:e.row.id,siteNo:e.row.siteNo};fetch(this.$api.urls.POST_FEE_QUERYFEEITEM,{method:"post",headers:{"Content-type":"application/json"},credentials:"include",body:p()(s)}).then(function(a){return a.json()}).then(function(a){if(setTimeout(function(){l.close()},500),a.success){for(var s="",o=0;o<t.pageData.statusList.length;o++)if(t.pageData.statusList[o].value==e.row.oaStatus){s=t.pageData.statusList[o].name;break}t.pageData.addDialog.createFee={id:e.row.id,mandt:e.row.mandt,oaId:e.row.oaId,siteNo:e.row.siteNo,siteName:e.row.siteName,totalFee:e.row.totalFee,oaStatus:e.row.oaStatus,oaStatusName:s,auditorId:e.row.auditorId,auditorName:e.row.auditorName,delFlag:e.row.delFlag,creator:e.row.creator,budgetId:e.row.budgetId,created:e.row.created,yearMonthStr:t.$api.dateFormat("yyyy-MM-dd",e.row.created).substring(0,7),oaFeeItemList:a.model},t.pageData.addDialog.dialogFormVisible=!0}else t.$message.error(a.message)}).catch(function(a){setTimeout(function(){l.close()},500),t.$message.error("系统错误："+a)})},addEvt:function(){var a=this;if(""==this.pageData.addDialog.createFee.siteNo)return this.$message({message:"请输入门店编号!",type:"warning"}),!1;if(""==this.pageData.addDialog.createFee.budgetId)return this.$message({message:"请选择科目!",type:"warning"}),!1;if(""==this.pageData.addDialog.createFee.totalFee)return this.$message({message:"请输入科目总费用!",type:"warning"}),!1;for(var e=0;e<this.pageData.addDialog.createFee.oaFeeItemList.length;e++)if(""==this.pageData.addDialog.createFee.oaFeeItemList[e].fee)return this.$message({message:"请输入录入费用!",type:"warning"}),!1;var t=this.$loading({lock:!0,spinner:"wm-icon-loading",background:"rgba(0, 0, 0, 0.7)"}),l=this.pageData.addDialog.createFee;fetch(this.$api.urls.POST_FEE_CREATEFEE,{method:"post",headers:{"Content-type":"application/json"},credentials:"include",body:p()(l)}).then(function(a){return a.json()}).then(function(e){setTimeout(function(){t.close()},500),e.success?(a.pageData.addDialog.dialogFormVisible=!1,a.$alert("新增费用录入成功","提示",{confirmButtonText:"确定",type:"success",center:!0,callback:function(e){a.queryEvt(),a.clearEvt()}})):a.$message.error(e.message)}).catch(function(e){setTimeout(function(){t.close()},500),a.$message.error("系统错误："+e)})},querySubjectType:function(){var a=this,e={mandt:this.pageData.tableObj.mandt,subjectTypeId:3};fetch(this.$api.urls.POST_QUERYSUBJECTTYPE,{method:"post",headers:{"Content-type":"application/json"},credentials:"include",body:p()(e)}).then(function(a){return a.json()}).then(function(e){e.success?(e.model.forEach(function(e){e.label=e.budgetId+" "+e.budgetName,a.pageData.budgetList.push(e)}),a.queryEvt()):a.$message.error(e.message)}).catch(function(e){a.$message.error("系统错误："+e)})},queryEvt:function(){var a=this,e={oaStatus:this.pageData.tableObj.oaStatus,mandt:this.pageData.tableObj.mandt,siteNo:this.pageData.tableObj.siteNo,budgetId:this.pageData.tableObj.budgetId,startTime:this.pageData.tableObj.startTime,endTime:this.pageData.tableObj.endTime,currentPage:this.pageData.tableObj.currentPage,pageSize:this.pageData.tableObj.pageSize};if(this.$api.compareDate(e.startTime,e.endTime))return this.$message({message:"开始时间不能大于结束时间!",type:"warning"}),!1;var t=this.$loading({lock:!0,spinner:"wm-icon-loading",background:"rgba(0, 0, 0, 0.7)"});fetch(this.$api.urls.POST_FEE_QUERYFEEMAIN,{method:"post",headers:{"Content-type":"application/json"},credentials:"include",body:p()(e)}).then(function(a){return a.json()}).then(function(e){if(setTimeout(function(){t.close()},500),e.success){a.pageData.tableObj.currentPage=e.model.currentPage,a.pageData.tableObj.pageSize=e.model.pageSize,a.pageData.tableObj.totalPage=e.model.pageCount,a.pageData.tableObj.totalRows=e.model.count;for(var l=e.model.data,s=0;s<l.length;s++){l[s].created=a.$api.dateFormat("yyyy-MM-dd",l[s].created);for(var o=0;o<a.pageData.statusList.length;o++)if(l[s].oaStatus==a.pageData.statusList[o].value){l[s].oaStatusName=a.pageData.statusList[o].name;break}for(var i=0;i<a.pageData.budgetList.length;i++)if(l[s].budgetId==a.pageData.budgetList[i].budgetId){l[s].budgetName=a.pageData.budgetList[i].budgetName;break}}a.pageData.tableObj.list=l}else a.$message.error(e.message)}).catch(function(e){setTimeout(function(){t.close()},500),a.$message.error("系统错误："+e)})},handleSizeChange:function(a){this.pageData.tableObj.pageSize=a,this.queryEvt()},handleCurrentChange:function(a){this.pageData.tableObj.currentPage=a,this.queryEvt()}}},S={render:function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("el-main",[t("div",{staticClass:"container-fluid"},[t("el-breadcrumb",{staticClass:"breadcrumb",attrs:{"separator-class":"el-icon-arrow-right"}},[t("el-breadcrumb-item",{attrs:{to:{name:"homeLink"}}},[t("i",{staticClass:"glyphicon glyphicon-home"}),a._v("首页")]),a._v(" "),t("el-breadcrumb-item",[a._v("店铺费用管理")]),a._v(" "),t("el-breadcrumb-item",[a._v("费用录入")])],1)],1),a._v(" "),t("div",{staticClass:"rtl-custom-box mt15"},[t("div",{staticClass:"box-hd"},[t("div",{staticClass:"cont"},[t("div",{staticClass:"form-horizontal"},[t("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0}},[t("el-row",[t("el-col",{attrs:{span:6}},[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("门店号码：")])]),a._v(" "),t("el-col",{attrs:{span:16}},[t("el-form-item",[t("el-input",{attrs:{disabled:a.addDialogDisabled,placeholder:"请输入门店号",clearable:""},model:{value:a.pageData.tableObj.siteNo,callback:function(e){a.$set(a.pageData.tableObj,"siteNo",e)},expression:"pageData.tableObj.siteNo"}})],1)],1)],1),a._v(" "),t("el-col",{attrs:{span:6}},[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("审批状态：")])]),a._v(" "),t("el-col",{attrs:{span:16}},[t("el-form-item",[t("el-select",{model:{value:a.pageData.tableObj.oaStatus,callback:function(e){a.$set(a.pageData.tableObj,"oaStatus",e)},expression:"pageData.tableObj.oaStatus"}},a._l(a.pageData.statusList,function(a){return t("el-option",{key:a.value,attrs:{label:a.name,value:a.value}})}))],1)],1)],1),a._v(" "),t("el-col",{attrs:{span:12}},[t("el-col",{attrs:{span:4}},[t("label",{staticClass:"control-label"},[a._v("提交时间：")])]),a._v(" "),t("el-col",{attrs:{span:20}},[t("el-col",{attrs:{span:10}},[t("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",align:"right",type:"date",placeholder:"请选择日期"},model:{value:a.pageData.tableObj.startTime,callback:function(e){a.$set(a.pageData.tableObj,"startTime",e)},expression:"pageData.tableObj.startTime"}})],1),a._v(" "),t("el-col",{staticClass:"text-center",staticStyle:{"line-height":"40px"},attrs:{span:2}},[a._v("-")]),a._v(" "),t("el-col",{attrs:{span:10}},[t("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",align:"right",type:"date",placeholder:"请选择日期"},model:{value:a.pageData.tableObj.endTime,callback:function(e){a.$set(a.pageData.tableObj,"endTime",e)},expression:"pageData.tableObj.endTime"}})],1)],1)],1)],1),a._v(" "),t("el-row",[t("el-col",{attrs:{span:6}},[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("科目名称：")])]),a._v(" "),t("el-col",{attrs:{span:16}},[t("el-form-item",[t("el-select",{model:{value:a.pageData.tableObj.budgetId,callback:function(e){a.$set(a.pageData.tableObj,"budgetId",e)},expression:"pageData.tableObj.budgetId"}},[t("el-option",{attrs:{label:"全部",value:""}}),a._v(" "),a._l(a.pageData.budgetList,function(a){return t("el-option",{key:a.budgetId,attrs:{label:a.label,value:a.budgetId}})})],2)],1)],1)],1),a._v(" "),t("el-col",{staticClass:"text-center",attrs:{span:6}},[t("el-form-item",[t("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(e){return e.stopPropagation(),a.queryEvt(e)}}},[a._v("查询")])],1)],1)],1)],1)],1)])])]),a._v(" "),t("div",{staticClass:"box-bd pr mt15"},[t("div",{staticClass:"tab-content custom-content"},[t("div",{staticClass:"tab-pane in active"},[t("el-row",{staticClass:"mb10"},[t("el-col",{attrs:{span:12}},[t("el-button",{attrs:{type:"primary",icon:"el-icon-edit-outline"},on:{click:function(e){return e.stopPropagation(),a.showDislog(e)}}},[a._v("新建")])],1)],1),a._v(" "),t("div",{staticClass:"table-responsive"},[t("el-table",{staticStyle:{width:"100%"},attrs:{border:"",data:a.pageData.tableObj.list}},[t("el-table-column",{attrs:{sortable:"",prop:"id",label:"序号","min-width":"90"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"siteNo",label:"门店号","min-width":"110"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"siteName",label:"门店名称","min-width":"120"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"oaId",label:"OA单号","min-width":"120"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"budgetName",label:"科目","min-width":"90"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"auditorName",label:"当前审批人","min-width":"130"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"oaStatusName",label:"审批状态","min-width":"120"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"created",label:"提交时间","min-width":"120"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"creator",label:"提交人","min-width":"110"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"auditOpinion",label:"审批意见","min-width":"110"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",fixed:"right",label:"操作","min-width":"100"},scopedSlots:a._u([{key:"default",fn:function(e){return[t("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){t.stopPropagation(),a.detailEvt(e.$index,e)}}},[a._v("查看详情")])]}}])})],1)],1),a._v(" "),t("div",{staticClass:"page"},[t("div",{staticClass:"block p15 text-center"},[t("el-pagination",{attrs:{"current-page":a.pageData.tableObj.currentPage,"page-sizes":a.pageData.tableObj.pageArray,"page-size":a.pageData.tableObj.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:a.pageData.tableObj.totalRows},on:{"size-change":a.handleSizeChange,"current-change":a.handleCurrentChange}})],1)])],1)])]),a._v(" "),t("el-dialog",{attrs:{title:"费用录入",visible:a.pageData.addDialog.dialogFormVisible,width:"90%","before-close":a.clearEvt},on:{"update:visible":function(e){a.$set(a.pageData.addDialog,"dialogFormVisible",e)}}},[t("el-switch",{staticStyle:{display:"block",position:"absolute",top:"20px",right:"65px"},attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-text":"展开","inactive-text":"收起"},model:{value:a.pageData.addDialog.switch,callback:function(e){a.$set(a.pageData.addDialog,"switch",e)},expression:"pageData.addDialog.switch"}}),a._v(" "),a.pageData.addDialog.switch?t("el-form",{staticClass:"form-horizontal"},[t("el-row",[t("el-col",{attrs:{span:6}},[t("el-form-item",[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("变更单号：")])]),a._v(" "),t("el-col",{attrs:{span:16}},[t("el-input",{attrs:{"auto-complete":"off",disabled:!0,clearable:""},model:{value:a.pageData.addDialog.createFee.id,callback:function(e){a.$set(a.pageData.addDialog.createFee,"id",e)},expression:"pageData.addDialog.createFee.id"}})],1)],1)],1),a._v(" "),t("el-col",{attrs:{span:6}},[t("el-form-item",[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("门店：")])]),a._v(" "),t("el-col",{attrs:{span:16}},[a.pageData.addDialog.isDetail?a._e():t("el-input",{attrs:{disabled:a.addDialogDisabled,clearable:"","auto-complete":"off"},model:{value:a.pageData.addDialog.createFee.siteNo,callback:function(e){a.$set(a.pageData.addDialog.createFee,"siteNo",e)},expression:"pageData.addDialog.createFee.siteNo"}}),a._v(" "),a.pageData.addDialog.isDetail?t("el-input",{attrs:{disabled:a.pageData.addDialog.isDetail,clearable:"","auto-complete":"off"},model:{value:a.pageData.addDialog.createFee.siteNo,callback:function(e){a.$set(a.pageData.addDialog.createFee,"siteNo",e)},expression:"pageData.addDialog.createFee.siteNo"}}):a._e()],1)],1)],1),a._v(" "),t("el-col",{attrs:{span:6}},[t("el-form-item",[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("科目：")])]),a._v(" "),t("el-col",{attrs:{span:16}},[t("el-select",{attrs:{disabled:a.pageData.addDialog.isDetail},on:{change:a.siteNoEvt},model:{value:a.pageData.addDialog.createFee.budgetId,callback:function(e){a.$set(a.pageData.addDialog.createFee,"budgetId",e)},expression:"pageData.addDialog.createFee.budgetId"}},[t("el-option",{attrs:{label:"全部",value:""}}),a._v(" "),a._l(a.pageData.budgetList,function(a){return t("el-option",{key:a.budgetId,attrs:{label:a.label,value:a.budgetId}})})],2)],1)],1)],1),a._v(" "),t("el-col",{attrs:{span:6}},[t("el-form-item",[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("科目总费用：")])]),a._v(" "),t("el-col",{attrs:{span:16}},[t("el-input",{attrs:{disabled:!0,"auto-complete":"off",clearable:""},model:{value:a.pageData.addDialog.createFee.totalFee,callback:function(e){a.$set(a.pageData.addDialog.createFee,"totalFee",e)},expression:"pageData.addDialog.createFee.totalFee"}})],1)],1)],1)],1),a._v(" "),t("el-row",[t("el-col",{attrs:{span:6}},[t("el-form-item",[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("OA单号：")])]),a._v(" "),t("el-col",{attrs:{span:16}},[t("el-input",{attrs:{disabled:!0,"auto-complete":"off",clearable:""},model:{value:a.pageData.addDialog.createFee.oaId,callback:function(e){a.$set(a.pageData.addDialog.createFee,"oaId",e)},expression:"pageData.addDialog.createFee.oaId"}})],1)],1)],1),a._v(" "),t("el-col",{attrs:{span:6}},[t("el-form-item",[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("状态：")])]),a._v(" "),t("el-col",{attrs:{span:16}},[a.pageData.addDialog.isDetail?t("el-input",{attrs:{disabled:a.pageData.addDialog.isDetail,clearable:"","auto-complete":"off"},model:{value:a.pageData.addDialog.createFee.oaStatusName,callback:function(e){a.$set(a.pageData.addDialog.createFee,"oaStatusName",e)},expression:"pageData.addDialog.createFee.oaStatusName"}}):a._e(),a._v(" "),a.pageData.addDialog.isDetail?a._e():t("el-select",{attrs:{disabled:!0},model:{value:a.pageData.addDialog.createFee.oaStatus,callback:function(e){a.$set(a.pageData.addDialog.createFee,"oaStatus",e)},expression:"pageData.addDialog.createFee.oaStatus"}},a._l(a.pageData.statusList,function(a){return t("el-option",{key:a.value,attrs:{label:a.name,value:a.value}})}))],1)],1)],1),a._v(" "),t("el-col",{attrs:{span:6}},[t("el-form-item",[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("提交日期：")])]),a._v(" "),t("el-col",{attrs:{span:16}},[t("el-input",{attrs:{disabled:!0,placeholder:"选择日期","prefix-icon":"el-icon-date"},model:{value:a.pageData.addDialog.createFee.created,callback:function(e){a.$set(a.pageData.addDialog.createFee,"created",e)},expression:"pageData.addDialog.createFee.created"}})],1)],1)],1),a._v(" "),t("el-col",{attrs:{span:6}},[t("el-form-item",[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("月份：")])]),a._v(" "),t("el-col",{attrs:{span:16}},[t("el-input",{attrs:{disabled:!0,placeholder:"选择日期","prefix-icon":"el-icon-date"},model:{value:a.pageData.addDialog.createFee.yearMonthStr,callback:function(e){a.$set(a.pageData.addDialog.createFee,"yearMonthStr",e)},expression:"pageData.addDialog.createFee.yearMonthStr"}})],1)],1)],1)],1)],1):a._e(),a._v(" "),t("el-table",{staticStyle:{width:"100%","margin-bottom":"10px"},attrs:{border:"",data:a.pageData.addDialog.createFee.oaFeeItemList,"max-height":a.pageData.addDialog.tableHeight}},[t("el-table-column",{attrs:{sortable:"",prop:"budgetName",label:"科目名称"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"partnerTeamName",label:"合伙人组"}}),a._v(" "),t("el-table-column",{attrs:{label:"录入费用"},scopedSlots:a._u([{key:"default",fn:function(e){return[t("el-input",{attrs:{disabled:a.pageData.addDialog.isDetail},on:{input:a.totalFeeEvt},model:{value:e.row.fee,callback:function(t){a.$set(e.row,"fee",t)},expression:"scope.row.fee"}})]}}])})],1),a._v(" "),t("div",{staticClass:"text-center"},[a.pageData.addDialog.isDetail?t("el-button",{attrs:{type:"danger",icon:"el-icon-circle-close-outline"},on:{click:function(e){return e.stopPropagation(),a.clearEvt(e)}}},[a._v("关闭")]):a._e(),a._v(" "),a.pageData.addDialog.isDetail?a._e():t("el-button",{attrs:{type:"success",icon:"el-icon-upload"},on:{click:function(e){return e.stopPropagation(),a.addEvt(e)}}},[a._v("提交")]),a._v(" "),a.pageData.addDialog.isDetail?a._e():t("el-button",{attrs:{icon:"el-icon-circle-close-outline"},on:{click:function(e){return e.stopPropagation(),a.clearEvt(e)}}},[a._v("取消")])],1)],1)],1)},staticRenderFns:[]};var j=t("VU/8")(w,S,!1,function(a){t("u2jH")},"data-v-58e7fe86",null).exports,C=(function(){function a(a){var e,t={times:1,num:0},l=a<0;if(e=a,Math.floor(e)===e)return t.num=a,t;var s=a+"",o=s.indexOf("."),i=s.substr(o+1).length,n=Math.pow(10,i),r=parseInt(Math.abs(a)*n+.5,10);return t.times=n,l&&(r=-r),t.num=r,t}function e(e,t,l,s){var o=a(e),i=a(t),n=o.num,r=i.num,c=o.times,p=i.times,u=c>p?c:p;switch(s){case"add":return(c===p?n+r:c>p?n+r*(c/p):n*(p/c)+r)/u;case"subtract":return(c===p?n-r:c>p?n-r*(c/p):n*(p/c)-r)/u;case"multiply":return n*r/(c*p);case"divide":return n/r*(p/c)}}}(),{data:function(){return{addDialogDisabled:!1,pageData:{statusList:[{name:"全部",value:"-1"},{name:"提交",value:"0"},{name:"驳回",value:"1"},{name:"已审批",value:"2"}],budgetList:[],tableObj:{oaStatus:"-1",mandt:"300",startTime:"",endTime:"",siteNo:"",budgetId:"",currentPage:1,pageSize:10,totalPage:1,totalRows:1,pageArray:[10,20,30,40,50],list:[]},addDialog:{switch:!0,tableHeight:0,isDetail:!1,dialogFormVisible:!1,createRate:{mandt:"",oaId:"",siteNo:"",siteName:"",oaStatus:"0",auditorId:"",auditorName:"",delFlag:"",creator:"",budgetId:"",created:this.$api.getDateFunc(!0),oaRateItemList:[]},formLabelWidth:"120px"},updateDialog:{dialogFormVisible:!1,form:{},formLabelWidth:"120px"}}}},created:function(){this.commonInfo();var a=document.documentElement.clientHeight;this.pageData.addDialog.tableHeight=.4*a},methods:{initFunc:function(){this.querySubjectType()},commonInfo:function(){var a=this,e=this.$loading({lock:!0,spinner:"wm-icon-loading",background:"rgba(0, 0, 0, 0.7)"});fetch(this.$api.urls.POST_QUERYCOMMONINFO,{method:"post",headers:{"Content-type":"application/json"},credentials:"include",body:p()({})}).then(function(a){return a.json()}).then(function(t){setTimeout(function(){e.close()},500),t.success?(a.$store.dispatch("setMandt",t.model.mandt),a.$store.dispatch("setIndu",t.model.indu),a.$store.dispatch("setSiteNo",t.model.siteNo),a.pageData.tableObj.mandt=a.$store.getters.mandt,a.pageData.addDialog.createRate.siteNo=a.$store.getters.siteNo,a.pageData.tableObj.siteNo=a.$store.getters.siteNo,""!=t.model.siteNo&&(a.addDialogDisabled=!0),a.initFunc()):a.$message.error(t.message)}).catch(function(t){setTimeout(function(){e.close()},500),a.$message.error("错误："+t)})},totalNewRateEvt:function(){var a=this,e=0;this.pageData.addDialog.createRate.oaRateItemList.forEach(function(t){var l=0;if(t.newRate&&(l=parseFloat(t.newRate)),(e+=l)>100)return a.$message({message:"变更后比例总额不能大于100%!",type:"warning"}),t.newRate="",!1})},querySubjectType:function(){var a=this,e={mandt:this.pageData.tableObj.mandt,subjectTypeId:1};fetch(this.$api.urls.POST_QUERYSUBJECTTYPE,{method:"post",headers:{"Content-type":"application/json"},credentials:"include",body:p()(e)}).then(function(a){return a.json()}).then(function(e){e.success?(e.model.forEach(function(e){e.label=e.budgetId+" "+e.budgetName,a.pageData.budgetList.push(e)}),a.queryEvt()):a.$message.error(e.message)}).catch(function(e){a.$message.error("系统错误："+e)})},siteNoEvt:function(){var a=this;if(""==this.pageData.addDialog.createRate.siteNo)return this.$message({message:"请输入门店编号!",type:"warning"}),!1;var e=this.$loading({lock:!0,spinner:"wm-icon-loading",background:"rgba(0, 0, 0, 0.7)"}),t={siteNo:this.pageData.addDialog.createRate.siteNo,budgetId:this.pageData.addDialog.createRate.budgetId};fetch(this.$api.urls.POST_QUERYCOMMONINFO,{method:"post",headers:{"Content-type":"application/json"},credentials:"include",body:p()(t)}).then(function(a){return a.json()}).then(function(t){if(setTimeout(function(){e.close()},500),t.success){for(var l=t.model,s=a.pageData.addDialog.createRate.budgetId,o="",i=0;i<a.pageData.budgetList.length;i++)a.pageData.budgetList[i].budgetId==s&&(o=a.pageData.budgetList[i].budgetName);for(var n={mandt:l.mandt,oaId:"",siteNo:a.pageData.addDialog.createRate.siteNo,siteName:l.siteName,oaStatus:"0",auditorId:"",auditorName:"",delFlag:"",creator:"",budgetId:s,created:a.$api.getDateFunc(!0),oaRateItemList:[]},r=0;r<l.partnerTeam.length;r++)n.oaRateItemList.push({partnerTeamNo:l.partnerTeam[r].partnerTeamNo,nowRate:a.$api.accMul(l.partnerTeam[r].nowRate,100),newRate:"",partnerTeamName:l.partnerTeam[r].partnerTeamName,creator:l.partnerTeam[r].creator,budgetId:s,budgetName:o,mandt:l.partnerTeam[r].mandt});a.pageData.addDialog.createRate=n}else a.pageData.addDialog.createRate={mandt:"",oaId:"",siteNo:a.$store.getters.siteNo,siteName:"",oaStatus:"0",auditorId:"",auditorName:"",delFlag:"",creator:"",budgetId:"",created:a.$api.getDateFunc(!0),oaRateItemList:[]},a.pageData.addDialog.dialogFormVisible=!0,a.pageData.addDialog.isDetail=!1,a.$message.error(t.message)}).catch(function(t){setTimeout(function(){e.close()},500),a.$message.error("系统错误："+t)})},clearEvt:function(){this.pageData.addDialog.createRate={mandt:"",oaId:"",siteNo:this.$store.getters.siteNo,siteName:"",oaStatus:"0",auditorId:"",auditorName:"",delFlag:"",creator:"",budgetId:"",created:this.$api.getDateFunc(!0),oaRateItemList:[]},this.pageData.addDialog.dialogFormVisible=!1,this.pageData.addDialog.isDetail=!1},addEvt:function(){var a=this;if(""==this.pageData.addDialog.createRate.siteNo)return this.$message({message:"请输入门店编号!",type:"warning"}),!1;for(var e=0;e<this.pageData.addDialog.createRate.oaRateItemList.length;e++)if(""==this.pageData.addDialog.createRate.oaRateItemList[e].newRate)return this.$message({message:"请输入变更后比例!",type:"warning"}),!1;var t=0,l=this.pageData.addDialog.createRate;if(l.oaRateItemList.forEach(function(a){t+=parseFloat(a.newRate)}),100!=t)return this.$message({message:"总变更后比例不等于100%，当前"+t+"%!",type:"warning"}),!1;l.oaRateItemList.forEach(function(a){a.nowRate=a.nowRate/100,a.newRate=a.newRate/100});var s=this.$loading({lock:!0,spinner:"wm-icon-loading",background:"rgba(0, 0, 0, 0.7)"});fetch(this.$api.urls.POST_RATE_CREATERATE,{method:"post",headers:{"Content-type":"application/json"},credentials:"include",body:p()(l)}).then(function(a){return a.json()}).then(function(e){setTimeout(function(){s.close()},500),e.success?(a.pageData.addDialog.dialogFormVisible=!1,a.$alert("新增比例维护成功","提示",{confirmButtonText:"确定",type:"success",center:!0,callback:function(e){a.queryEvt(),a.clearEvt()}})):(l.oaRateItemList.forEach(function(e){e.nowRate=a.$api.accMul(e.nowRate,100),e.newRate=a.$api.accMul(e.newRate,100)}),a.pageData.addDialog.createRate=l,a.$message.error(e.message))}).catch(function(e){setTimeout(function(){s.close()},500),l.oaRateItemList.forEach(function(e){e.nowRate=a.$api.accMul(e.nowRate,100),e.newRate=a.$api.accMul(e.newRate,100)}),a.pageData.addDialog.createRate=l,a.$message.error("系统错误："+e)})},detailEvt:function(a,e){var t=this;this.pageData.addDialog.isDetail=!0;var l=this.$loading({lock:!0,spinner:"wm-icon-loading",background:"rgba(0, 0, 0, 0.7)"}),s={mandt:this.pageData.tableObj.mandt,mainId:e.row.id,siteNo:e.row.siteNo};fetch(this.$api.urls.POST_RATE_QUERYRATEITEM,{method:"post",headers:{"Content-type":"application/json"},credentials:"include",body:p()(s)}).then(function(a){return a.json()}).then(function(a){if(setTimeout(function(){l.close()},500),a.success){var s=a.model;s.forEach(function(a){a.nowRate=t.$api.accMul(a.nowRate,100),a.newRate=t.$api.accMul(a.newRate,100)});for(var o="",i=0;i<t.pageData.statusList.length;i++)if(t.pageData.statusList[i].value==e.row.oaStatus){o=t.pageData.statusList[i].name;break}t.pageData.addDialog.createRate={id:e.row.id,mandt:e.row.mandt,oaId:e.row.oaId,siteNo:e.row.siteNo+" "+e.row.siteName,siteName:e.row.siteName,totalArea:e.row.totalArea,oaStatus:e.row.oaStatus,oaStatusName:o,auditorId:e.row.auditorId,auditorName:e.row.auditorName,delFlag:e.row.delFlag,created:t.$api.dateFormat("yyyy-MM-dd",e.row.created),creator:e.row.creator,budgetId:e.row.budgetId,oaRateItemList:s},t.pageData.addDialog.dialogFormVisible=!0}else t.$message.error(a.message)}).catch(function(a){setTimeout(function(){l.close()},500),t.$message.error("系统错误："+a)})},queryEvt:function(){var a=this,e={oaStatus:this.pageData.tableObj.oaStatus,mandt:this.pageData.tableObj.mandt,siteNo:this.pageData.tableObj.siteNo,budgetId:this.pageData.tableObj.budgetId,startTime:this.pageData.tableObj.startTime,endTime:this.pageData.tableObj.endTime,currentPage:this.pageData.tableObj.currentPage,pageSize:this.pageData.tableObj.pageSize};if(this.$api.compareDate(e.startTime,e.endTime))return this.$message({message:"开始时间不能大于结束时间!",type:"warning"}),!1;var t=this.$loading({lock:!0,spinner:"wm-icon-loading",background:"rgba(0, 0, 0, 0.7)"});fetch(this.$api.urls.POST_RATE_QUERYRATEMAIN,{method:"post",headers:{"Content-type":"application/json"},credentials:"include",body:p()(e)}).then(function(a){return a.json()}).then(function(e){if(setTimeout(function(){t.close()},500),e.success){a.pageData.tableObj.currentPage=e.model.currentPage,a.pageData.tableObj.pageSize=e.model.pageSize,a.pageData.tableObj.totalPage=e.model.pageCount,a.pageData.tableObj.totalRows=e.model.count;for(var l=e.model.data,s=0;s<l.length;s++){l[s].created=a.$api.dateFormat("yyyy-MM-dd",l[s].created);for(var o=0;o<a.pageData.statusList.length;o++)if(l[s].oaStatus==a.pageData.statusList[o].value){l[s].oaStatusName=a.pageData.statusList[o].name;break}for(var i=0;i<a.pageData.budgetList.length;i++)if(l[s].budgetId==a.pageData.budgetList[i].budgetId){l[s].budgetName=a.pageData.budgetList[i].budgetName;break}}a.pageData.tableObj.list=l}else a.$message.error(e.message)}).catch(function(e){setTimeout(function(){t.close()},500),a.$message.error("系统错误："+e)})},handleSizeChange:function(a){this.pageData.tableObj.pageSize=a,this.queryEvt()},handleCurrentChange:function(a){this.pageData.tableObj.currentPage=a,this.queryEvt()}}}),E={render:function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("el-main",[t("div",{staticClass:"container-fluid"},[t("el-breadcrumb",{staticClass:"breadcrumb",attrs:{"separator-class":"el-icon-arrow-right"}},[t("el-breadcrumb-item",{attrs:{to:{name:"homeLink"}}},[t("i",{staticClass:"glyphicon glyphicon-home"}),a._v("首页")]),a._v(" "),t("el-breadcrumb-item",[a._v("店铺费用管理")]),a._v(" "),t("el-breadcrumb-item",[a._v("指定比例维护")])],1)],1),a._v(" "),t("div",{staticClass:"rtl-custom-box mt15"},[t("div",{staticClass:"box-hd"},[t("div",{staticClass:"cont"},[t("div",{staticClass:"form-horizontal"},[t("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:a.pageData.queryObj}},[t("el-row",[t("el-col",{attrs:{span:6}},[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("门店号码：")])]),a._v(" "),t("el-col",{attrs:{span:16}},[t("el-form-item",[t("el-input",{attrs:{disabled:a.addDialogDisabled,placeholder:"请输入门店号",clearable:""},model:{value:a.pageData.tableObj.siteNo,callback:function(e){a.$set(a.pageData.tableObj,"siteNo",e)},expression:"pageData.tableObj.siteNo"}})],1)],1)],1),a._v(" "),t("el-col",{attrs:{span:6}},[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("审批状态：")])]),a._v(" "),t("el-col",{attrs:{span:16}},[t("el-form-item",[t("el-select",{model:{value:a.pageData.tableObj.oaStatus,callback:function(e){a.$set(a.pageData.tableObj,"oaStatus",e)},expression:"pageData.tableObj.oaStatus"}},a._l(a.pageData.statusList,function(a){return t("el-option",{key:a.value,attrs:{label:a.name,value:a.value}})}))],1)],1)],1),a._v(" "),t("el-col",{attrs:{span:12}},[t("el-col",{attrs:{span:4}},[t("label",{staticClass:"control-label"},[a._v("提交时间：")])]),a._v(" "),t("el-col",{attrs:{span:20}},[t("el-col",{attrs:{span:10}},[t("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",align:"right",type:"date",placeholder:"请选择日期"},model:{value:a.pageData.tableObj.startTime,callback:function(e){a.$set(a.pageData.tableObj,"startTime",e)},expression:"pageData.tableObj.startTime"}})],1),a._v(" "),t("el-col",{staticClass:"text-center",staticStyle:{"line-height":"40px"},attrs:{span:2}},[a._v("-")]),a._v(" "),t("el-col",{attrs:{span:10}},[t("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",align:"right",type:"date",placeholder:"请选择日期"},model:{value:a.pageData.tableObj.endTime,callback:function(e){a.$set(a.pageData.tableObj,"endTime",e)},expression:"pageData.tableObj.endTime"}})],1)],1)],1)],1),a._v(" "),t("el-row",[t("el-col",{attrs:{span:6}},[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("科目名称：")])]),a._v(" "),t("el-col",{attrs:{span:16}},[t("el-form-item",[t("el-select",{model:{value:a.pageData.tableObj.budgetId,callback:function(e){a.$set(a.pageData.tableObj,"budgetId",e)},expression:"pageData.tableObj.budgetId"}},[t("el-option",{attrs:{label:"全部",value:""}}),a._v(" "),a._l(a.pageData.budgetList,function(a){return t("el-option",{key:a.budgetId,attrs:{label:a.label,value:a.budgetId}})})],2)],1)],1)],1),a._v(" "),t("el-col",{staticClass:"text-center",attrs:{span:6}},[t("el-form-item",[t("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(e){return e.stopPropagation(),a.queryEvt(e)}}},[a._v("查询")])],1)],1)],1)],1)],1)])])]),a._v(" "),t("div",{staticClass:"box-bd pr mt15"},[t("div",{staticClass:"tab-content custom-content"},[t("div",{staticClass:"tab-pane in active"},[t("el-row",{staticClass:"mb10"},[t("el-col",{attrs:{span:12}},[t("el-button",{attrs:{type:"primary",icon:"el-icon-edit-outline"},on:{click:function(e){e.stopPropagation(),a.pageData.addDialog.dialogFormVisible=!0}}},[a._v("新建")])],1)],1),a._v(" "),t("div",{staticClass:"table-responsive"},[t("el-table",{staticStyle:{width:"100%"},attrs:{border:"",data:a.pageData.tableObj.list}},[t("el-table-column",{attrs:{sortable:"",prop:"id",label:"变更单号","min-width":"120"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"siteNo",label:"门店号","min-width":"110"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"siteName",label:"门店名称","min-width":"120"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"budgetName",label:"科目","min-width":"90"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"oaId",label:"OA单号","min-width":"120"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"auditorName",label:"当前审批人","min-width":"130"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"oaStatusName",label:"审批状态","min-width":"120"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"created",label:"提交时间","min-width":"120"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"creator",label:"提交人","min-width":"110"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"auditOpinion",label:"审批意见","min-width":"110"}}),a._v(" "),t("el-table-column",{attrs:{fixed:"right",label:"操作","min-width":"100"},scopedSlots:a._u([{key:"default",fn:function(e){return[t("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){t.stopPropagation(),a.detailEvt(e.$index,e)}}},[a._v("查看详情")])]}}])})],1)],1),a._v(" "),t("div",{staticClass:"page"},[t("div",{staticClass:"block p15 text-center"},[t("el-pagination",{attrs:{"current-page":a.pageData.tableObj.currentPage,"page-sizes":a.pageData.tableObj.pageArray,"page-size":a.pageData.tableObj.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:a.pageData.tableObj.totalRows},on:{"size-change":a.handleSizeChange,"current-change":a.handleCurrentChange}})],1)])],1)])]),a._v(" "),t("el-dialog",{attrs:{title:"比例维护",visible:a.pageData.addDialog.dialogFormVisible,width:"90%","before-close":a.clearEvt},on:{"update:visible":function(e){a.$set(a.pageData.addDialog,"dialogFormVisible",e)}}},[t("el-switch",{staticStyle:{display:"block",position:"absolute",top:"20px",right:"65px"},attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-text":"展开","inactive-text":"收起"},model:{value:a.pageData.addDialog.switch,callback:function(e){a.$set(a.pageData.addDialog,"switch",e)},expression:"pageData.addDialog.switch"}}),a._v(" "),a.pageData.addDialog.switch?t("el-form",{staticClass:"form-horizontal"},[t("el-row",[t("el-col",{attrs:{span:8}},[t("el-form-item",[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("变更单号：")])]),a._v(" "),t("el-col",{attrs:{span:16}},[t("el-input",{attrs:{disabled:!0,"auto-complete":"off",clearable:""},model:{value:a.pageData.addDialog.createRate.id,callback:function(e){a.$set(a.pageData.addDialog.createRate,"id",e)},expression:"pageData.addDialog.createRate.id"}})],1)],1)],1),a._v(" "),t("el-col",{attrs:{span:8}},[t("el-form-item",[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("门店：")])]),a._v(" "),t("el-col",{attrs:{span:16}},[a.pageData.addDialog.isDetail?a._e():t("el-input",{attrs:{disabled:a.addDialogDisabled,clearable:"","auto-complete":"off"},model:{value:a.pageData.addDialog.createRate.siteNo,callback:function(e){a.$set(a.pageData.addDialog.createRate,"siteNo",e)},expression:"pageData.addDialog.createRate.siteNo"}}),a._v(" "),a.pageData.addDialog.isDetail?t("el-input",{attrs:{disabled:a.pageData.addDialog.isDetail,clearable:"","auto-complete":"off"},model:{value:a.pageData.addDialog.createRate.siteNo,callback:function(e){a.$set(a.pageData.addDialog.createRate,"siteNo",e)},expression:"pageData.addDialog.createRate.siteNo"}}):a._e()],1)],1)],1),a._v(" "),t("el-col",{attrs:{span:8}},[t("el-form-item",[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("科目：")])]),a._v(" "),t("el-col",{attrs:{span:16}},[t("el-select",{attrs:{disabled:a.pageData.addDialog.isDetail},on:{change:a.siteNoEvt},model:{value:a.pageData.addDialog.createRate.budgetId,callback:function(e){a.$set(a.pageData.addDialog.createRate,"budgetId",e)},expression:"pageData.addDialog.createRate.budgetId"}},[t("el-option",{attrs:{label:"全部",value:""}}),a._v(" "),a._l(a.pageData.budgetList,function(a){return t("el-option",{key:a.budgetId,attrs:{label:a.label,value:a.budgetId}})})],2)],1)],1)],1)],1),a._v(" "),t("el-row",[t("el-col",{attrs:{span:8}},[t("el-form-item",[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("OA单号：")])]),a._v(" "),t("el-col",{attrs:{span:16}},[t("el-input",{attrs:{disabled:!0,clearable:"","auto-complete":"off"},model:{value:a.pageData.addDialog.createRate.oaId,callback:function(e){a.$set(a.pageData.addDialog.createRate,"oaId",e)},expression:"pageData.addDialog.createRate.oaId"}})],1)],1)],1),a._v(" "),t("el-col",{attrs:{span:8}},[t("el-form-item",[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("状态：")])]),a._v(" "),t("el-col",{attrs:{span:16}},[a.pageData.addDialog.isDetail?t("el-input",{attrs:{disabled:a.pageData.addDialog.isDetail,clearable:"","auto-complete":"off"},model:{value:a.pageData.addDialog.createRate.oaStatusName,callback:function(e){a.$set(a.pageData.addDialog.createRate,"oaStatusName",e)},expression:"pageData.addDialog.createRate.oaStatusName"}}):a._e(),a._v(" "),a.pageData.addDialog.isDetail?a._e():t("el-select",{attrs:{disabled:!0},model:{value:a.pageData.addDialog.createRate.oaStatus,callback:function(e){a.$set(a.pageData.addDialog.createRate,"oaStatus",e)},expression:"pageData.addDialog.createRate.oaStatus"}},a._l(a.pageData.statusList,function(a){return t("el-option",{key:a.value,attrs:{label:a.name,value:a.value}})}))],1)],1)],1),a._v(" "),t("el-col",{attrs:{span:8}},[t("el-form-item",[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("提交日期：")])]),a._v(" "),t("el-col",{attrs:{span:16}},[t("el-date-picker",{attrs:{disabled:!0,"value-format":"yyyy-MM-dd",type:"date",placeholder:"选择日期"},model:{value:a.pageData.addDialog.createRate.created,callback:function(e){a.$set(a.pageData.addDialog.createRate,"created",e)},expression:"pageData.addDialog.createRate.created"}})],1)],1)],1)],1)],1):a._e(),a._v(" "),t("el-table",{staticStyle:{width:"100%","margin-bottom":"10px"},attrs:{border:"",data:a.pageData.addDialog.createRate.oaRateItemList,"max-height":"490"}},[t("el-table-column",{attrs:{sortable:"",prop:"budgetName",label:"科目名称"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"partnerTeamName",label:"合伙人组"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"nowRate",label:"变更前比例"},scopedSlots:a._u([{key:"default",fn:function(e){return[t("span",[a._v(a._s(e.row.nowRate)+"%")])]}}])}),a._v(" "),t("el-table-column",{attrs:{label:"变更后比例"},scopedSlots:a._u([{key:"default",fn:function(e){return[a.pageData.addDialog.isDetail?t("span",[a._v(a._s(e.row.newRate)+"%")]):a._e(),a._v(" "),a.pageData.addDialog.isDetail?a._e():t("el-input",{attrs:{placeholder:"请输入变更后比例"},on:{input:a.totalNewRateEvt},model:{value:e.row.newRate,callback:function(t){a.$set(e.row,"newRate",t)},expression:"scope.row.newRate"}},[t("template",{slot:"append"},[a._v("%")])],2)]}}])})],1),a._v(" "),t("div",{staticClass:"text-center"},[a.pageData.addDialog.isDetail?t("el-button",{attrs:{type:"danger",icon:"el-icon-circle-close-outline"},on:{click:function(e){return e.stopPropagation(),a.clearEvt(e)}}},[a._v("关闭")]):a._e(),a._v(" "),a.pageData.addDialog.isDetail?a._e():t("el-button",{attrs:{type:"success",icon:"el-icon-upload"},on:{click:function(e){return e.stopPropagation(),a.addEvt(e)}}},[a._v("提交")]),a._v(" "),a.pageData.addDialog.isDetail?a._e():t("el-button",{attrs:{icon:"el-icon-circle-close-outline"},on:{click:function(e){return e.stopPropagation(),a.clearEvt(e)}}},[a._v("取消")])],1)],1)],1)},staticRenderFns:[]};var $={data:function(){return{pageData:{tableObj:{auditorId:"",created:"",currentPage:1,pageSize:10,totalPage:1,totalRows:1,pageArray:[10,20,30,40,50],list:[]}},value1:"",value2:"",currentPage4:4,formInline:{user:"",region:""}}},created:function(){this.initFunc()},methods:{initFunc:function(){this.queryEvt()},queryEvt:function(){var a=this,e={auditorId:this.pageData.tableObj.auditorId,created:this.pageData.tableObj.created,currentPage:this.pageData.tableObj.currentPage,pageSize:this.pageData.tableObj.pageSize},t=this.$loading({lock:!0,spinner:"wm-icon-loading",background:"rgba(0, 0, 0, 0.7)"});fetch(this.$api.urls.POST_LOG_QUERYLOGMAIN,{method:"post",headers:{"Content-type":"application/json"},credentials:"include",body:p()(e)}).then(function(a){return a.json()}).then(function(e){if(setTimeout(function(){t.close()},500),e.success){a.pageData.tableObj.currentPage=e.model.currentPage,a.pageData.tableObj.pageSize=e.model.pageSize,a.pageData.tableObj.totalPage=e.model.pageCount,a.pageData.tableObj.totalRows=e.model.count;for(var l=e.model.data,s=0;s<l.length;s++)l[s].created=a.$api.dateFormat("yyyy-MM-dd",l[s].created),1==l[s].oaType?l[s].oaTypeName="面积":2==l[s].oaType?l[s].oaTypeName="比例":3==l[s].oaType?l[s].oaTypeName="固定值":4==l[s].oaType&&(l[s].oaTypeName="其它");a.pageData.tableObj.list=l}else a.$message.error(e.message)}).catch(function(e){setTimeout(function(){t.close()},500),a.$message.error("系统错误："+e)})},handleSizeChange:function(a){this.pageData.tableObj.pageSize=a,this.queryEvt()},handleCurrentChange:function(a){this.pageData.tableObj.currentPage=a,this.queryEvt()}}},T={render:function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("el-main",[t("div",{staticClass:"container-fluid"},[t("el-breadcrumb",{staticClass:"breadcrumb",attrs:{"separator-class":"el-icon-arrow-right"}},[t("el-breadcrumb-item",{attrs:{to:{name:"homeLink"}}},[t("i",{staticClass:"glyphicon glyphicon-home"}),a._v("首页")]),a._v(" "),t("el-breadcrumb-item",[a._v("操作日志")])],1)],1),a._v(" "),t("div",{staticClass:"rtl-custom-box mt15"},[t("div",{staticClass:"box-hd"},[t("div",{staticClass:"cont"},[t("div",{staticClass:"form-horizontal"},[t("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0}},[t("el-row",[t("el-col",{attrs:{span:6}},[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("操作人员：")])]),a._v(" "),t("el-col",{attrs:{span:16}},[t("el-form-item",[t("el-input",{attrs:{placeholder:"请输入操作人员编号",clearable:""},model:{value:a.pageData.tableObj.auditorId,callback:function(e){a.$set(a.pageData.tableObj,"auditorId",e)},expression:"pageData.tableObj.auditorId"}})],1)],1)],1),a._v(" "),t("el-col",{attrs:{span:6}},[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("提交时间：")])]),a._v(" "),t("el-col",{attrs:{span:16}},[t("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"date",placeholder:"请选择日期"},model:{value:a.pageData.tableObj.created,callback:function(e){a.$set(a.pageData.tableObj,"created",e)},expression:"pageData.tableObj.created"}})],1)],1),a._v(" "),t("el-col",{staticClass:"text-center",attrs:{span:6}},[t("el-form-item",[t("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(e){return e.stopPropagation(),a.queryEvt(e)}}},[a._v("查询")])],1)],1)],1)],1)],1)])])]),a._v(" "),t("div",{staticClass:"box-bd pr mt15"},[t("div",{staticClass:"tab-content custom-content"},[t("div",{staticClass:"tab-pane in active"},[t("div",{staticClass:"table-responsive"},[t("el-table",{staticStyle:{width:"100%"},attrs:{border:"",data:a.pageData.tableObj.list}},[t("el-table-column",{attrs:{sortable:"",prop:"id",label:"序号"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"auditorId",label:"操作人员工号"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"auditorName",label:"操作者"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"created",label:"操作时间"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"oaTypeName",label:"操作模块"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"auditOpinion",label:"操作记录"}})],1)],1),a._v(" "),t("div",{staticClass:"page"},[t("div",{staticClass:"block p15 text-center"},[t("el-pagination",{attrs:{"current-page":a.pageData.tableObj.currentPage,"page-sizes":a.pageData.tableObj.pageArray,"page-size":a.pageData.tableObj.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:a.pageData.tableObj.totalRows},on:{"size-change":a.handleSizeChange,"current-change":a.handleCurrentChange}})],1)])])])])])},staticRenderFns:[]};var N={data:function(){return{pageData:{isDisabled:!1,oaStatusList:[{name:"全部",value:""},{name:"提交",value:"0"},{name:"驳回",value:"1"},{name:"已审批",value:"2"},{name:"未提交",value:"3"}],statusList:[{name:"全部",value:""},{name:"未提交",value:0},{name:"已提交",value:1},{name:"已审批",value:2}],tableObj:{siteNo:"",oaStatus:"",yearMonthStr:"",startTime:"",endTime:"",currentPage:1,pageSize:10,totalPage:1,totalRows:1,pageArray:[10,20,30,40,50],list:[]},dialog:{dialogVisible:!1,detail:{mainId:"",siteNo:"",yearMonthStr:"",status:"",oaStatus:""}},isShowTable:!1}}},created:function(){var a=this;this.commonInfo(),this.checkTeamLeaderEvt(function(e){a.pageData.isShowTable=!e.model})},computed:{},methods:{initFunc:function(){this.queryUncommittedEvt()},queryEvt:function(){var a=this,e={siteNo:this.pageData.tableObj.siteNo,yearMonthStr:this.pageData.tableObj.yearMonthStr,oaStatus:this.pageData.tableObj.oaStatus,startTime:this.pageData.tableObj.startTime,endTime:this.pageData.tableObj.endTime,currentPage:this.pageData.tableObj.currentPage,pageSize:this.pageData.tableObj.pageSize};if(this.$api.compareDate(e.startTime,e.endTime))return this.$message({message:"开始时间不能大于结束时间!",type:"warning"}),!1;var t=this.$loading({lock:!0,spinner:"wm-icon-loading",background:"rgba(0, 0, 0, 0.7)"});fetch(this.$api.urls.POST_EMPLOYEESCORE_LIST,{method:"post",headers:{"Content-type":"application/json"},credentials:"include",body:p()(e)}).then(function(a){return a.json()}).then(function(e){setTimeout(function(){t.close()},500),e.success?(a.pageData.tableObj.currentPage=e.model.currentPage,a.pageData.tableObj.pageSize=e.model.pageSize,a.pageData.tableObj.totalPage=e.model.pageCount,a.pageData.tableObj.totalRows=e.model.count,a.pageData.tableObj.list=e.model.data.map(function(e){return 0===e.status?e.statusName="未提交":1===e.status?e.statusName="已提交":e.statusName="已审批",a.pageData.oaStatusList.forEach(function(a){a.value==e.oaStatus&&(e.oaStatusName=a.name)}),e.yearMonthStr=a.$api.monthFormat(e.yearMonthStr),e.created=a.$api.dateFormat("yyyy-MM-dd",e.created),e.modified=a.$api.dateFormat("yyyy-MM-dd",e.modified),e.id==a.pageData.dialog.detail.mainId&&(a.pageData.dialog.detail.mainId=e.id,a.pageData.dialog.detail.siteNo=e.siteNo,a.pageData.dialog.detail.yearMonthStr=e.yearMonthStr,a.pageData.dialog.detail.status=e.status,a.pageData.dialog.detail.oaStatus=e.oaStatus),e})):a.$message.error(e.message)}).catch(function(e){setTimeout(function(){t.close()},500),a.$message.error("系统错误："+e)})},checkTeamLeaderEvt:function(a){var e=this;fetch(this.$api.urls.POST_EMPLOYEESCORE_CHECKTEAMLEADER,{method:"post",headers:{"Content-type":"application/json"},credentials:"include",body:p()({})}).then(function(a){return a.json()}).then(function(t){t.success?a(t):e.$message.error(t.message)}).catch(function(a){setTimeout(function(){loading.close()},500),e.$message.error("系统错误："+a)})},commonInfo:function(){var a=this,e=this.$loading({lock:!0,spinner:"wm-icon-loading",background:"rgba(0, 0, 0, 0.7)"});fetch(this.$api.urls.POST_QUERYCOMMONINFO,{method:"post",headers:{"Content-type":"application/json"},credentials:"include",body:p()({})}).then(function(a){return a.json()}).then(function(t){setTimeout(function(){e.close()},500),t.success?(""!=t.model.siteNo&&(a.pageData.isDisabled=!0,a.pageData.tableObj.siteNo=t.model.siteNo),a.initFunc()):a.$message.error(t.message)}).catch(function(t){setTimeout(function(){e.close()},500),a.$message.error("错误："+t)})},detailEvt:function(a,e){this.$router.push({name:"scoreLeaderDetailLink",query:{mainId:e.id,siteNo:e.siteNo,yearMonthStr:e.yearMonthStr,status:e.status,oaStatus:e.oaStatus}})},dialogEvt:function(){this.detailEvt(-1,this.pageData.dialog.detail)},queryUncommittedEvt:function(){var a=this,e=this.$loading({lock:!0,spinner:"wm-icon-loading",background:"rgba(0, 0, 0, 0.7)"});fetch(this.$api.urls.POST_EMPLOYEESCORE_QUERYUNCOMMITTED,{method:"post",headers:{"Content-type":"application/json"},credentials:"include",body:p()({})}).then(function(a){return a.json()}).then(function(t){setTimeout(function(){e.close()},500),t.success?(a.queryEvt(),t.model.length>0&&(a.pageData.dialog.detail.mainId=t.model[0].mainId,a.pageData.dialog.dialogVisible=t.model.some(function(a){return""==a.finalScore||null==a.finalScore}))):a.$message.error(t.message)}).catch(function(t){setTimeout(function(){e.close()},500),a.$message.error("系统错误："+t)})},clearDialogEvt:function(){this.pageData.dialog.dialogVisible=!1},handleSizeChange:function(a){this.pageData.tableObj.pageSize=a,this.queryEvt()},handleCurrentChange:function(a){this.pageData.tableObj.currentPage=a,this.queryEvt()}}},k={render:function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("el-main",[t("div",{staticClass:"container-fluid"},[t("el-breadcrumb",{staticClass:"breadcrumb",attrs:{"separator-class":"el-icon-arrow-right"}},[t("el-breadcrumb-item",{attrs:{to:{name:"homeLink"}}},[t("i",{staticClass:"glyphicon glyphicon-home"}),a._v("首页")]),a._v(" "),t("el-breadcrumb-item",[a._v("店铺管理")]),a._v(" "),t("el-breadcrumb-item",[a._v("员工评分")])],1)],1),a._v(" "),t("div",{staticClass:"rtl-custom-box mt15"},[t("div",{staticClass:"box-hd"},[t("div",{staticClass:"cont"},[t("div",{staticClass:"form-horizontal"},[t("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0}},[t("el-row",[t("el-col",{attrs:{span:6}},[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("门店编号：")])]),a._v(" "),t("el-col",{attrs:{span:16}},[t("el-form-item",[t("el-input",{attrs:{disabled:a.pageData.isDisabled,placeholder:"请输入门店编号",clearable:""},model:{value:a.pageData.tableObj.siteNo,callback:function(e){a.$set(a.pageData.tableObj,"siteNo",e)},expression:"pageData.tableObj.siteNo"}})],1)],1)],1),a._v(" "),t("el-col",{attrs:{span:6}},[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("月份：")])]),a._v(" "),t("el-col",{attrs:{span:16}},[t("el-date-picker",{attrs:{"value-format":"yyyyMM",type:"month",placeholder:"请选择日期"},model:{value:a.pageData.tableObj.yearMonthStr,callback:function(e){a.$set(a.pageData.tableObj,"yearMonthStr",e)},expression:"pageData.tableObj.yearMonthStr"}})],1)],1),a._v(" "),t("el-col",{attrs:{span:12}},[t("el-col",{attrs:{span:4}},[t("label",{staticClass:"control-label"},[a._v("导入时间：")])]),a._v(" "),t("el-col",{attrs:{span:20}},[t("el-col",{attrs:{span:10}},[t("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",align:"right",type:"date",placeholder:"请选择日期"},model:{value:a.pageData.tableObj.startTime,callback:function(e){a.$set(a.pageData.tableObj,"startTime",e)},expression:"pageData.tableObj.startTime"}})],1),a._v(" "),t("el-col",{staticClass:"text-center",staticStyle:{"line-height":"40px"},attrs:{span:2}},[a._v("-")]),a._v(" "),t("el-col",{attrs:{span:10}},[t("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",align:"right",type:"date",placeholder:"请选择日期"},model:{value:a.pageData.tableObj.endTime,callback:function(e){a.$set(a.pageData.tableObj,"endTime",e)},expression:"pageData.tableObj.endTime"}})],1)],1)],1)],1),a._v(" "),t("el-row",[t("el-col",{attrs:{span:6}},[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("审批状态：")])]),a._v(" "),t("el-col",{attrs:{span:16}},[t("el-form-item",[t("el-select",{model:{value:a.pageData.tableObj.oaStatus,callback:function(e){a.$set(a.pageData.tableObj,"oaStatus",e)},expression:"pageData.tableObj.oaStatus"}},a._l(a.pageData.oaStatusList,function(a){return t("el-option",{key:a.value,attrs:{label:a.name,value:a.value}})}))],1)],1)],1),a._v(" "),t("el-col",{staticClass:"text-center",attrs:{span:6}},[t("el-form-item",[t("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(e){return e.stopPropagation(),a.queryEvt(e)}}},[a._v("查询")])],1)],1)],1)],1)],1)])])]),a._v(" "),t("div",{staticClass:"box-bd pr mt15"},[t("div",{staticClass:"tab-content custom-content"},[t("div",{staticClass:"tab-pane in active"},[t("div",{staticClass:"table-responsive"},[t("el-table",{staticStyle:{width:"100%"},attrs:{border:"",data:a.pageData.tableObj.list}},[t("el-table-column",{attrs:{sortable:"",prop:"orderNo",label:"单号","min-width":"90"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"siteNo",label:"门店号","min-width":"110"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"siteName",label:"门店名称","min-width":"120"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"yearMonthStr",label:"月份","min-width":"130"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"statusName",label:"状态","min-width":"120"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"oaStatusName",label:"OA审批状态","min-width":"120"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"created",label:"提交时间","min-width":"120"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"creator",label:"提交人","min-width":"110"}}),a._v(" "),t("el-table-column",{attrs:{fixed:"right",label:"操作","min-width":"100"},scopedSlots:a._u([{key:"default",fn:function(e){return[t("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){t.stopPropagation(),a.detailEvt(e.$index,e.row)}}},[a._v("查看详情")])]}}])})],1)],1),a._v(" "),t("div",{staticClass:"page"},[t("div",{staticClass:"block p15 text-center"},[t("el-pagination",{attrs:{"current-page":a.pageData.tableObj.currentPage,"page-sizes":a.pageData.tableObj.pageArray,"page-size":a.pageData.tableObj.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:a.pageData.tableObj.totalRows},on:{"size-change":a.handleSizeChange,"current-change":a.handleCurrentChange}})],1)])])])]),a._v(" "),t("el-dialog",{attrs:{title:"提示",visible:a.pageData.dialog.dialogVisible,width:"25%","before-close":a.clearDialogEvt},on:{"update:visible":function(e){a.$set(a.pageData.dialog,"dialogVisible",e)}}},[t("div",{staticClass:"text-center pb20"},[t("span",[a._v("您有未提交的员工评分表,")]),a._v(" "),t("el-button",{attrs:{type:"text"},on:{click:function(e){return e.stopPropagation(),a.dialogEvt(e)}}},[a._v("点击查看详情")]),a._v(" "),t("span",[a._v("。")])],1),a._v(" "),t("div",{staticClass:"text-center"},[t("el-button",{attrs:{type:"primary",icon:"el-icon-star-on"},on:{click:function(e){return e.stopPropagation(),a.clearDialogEvt(e)}}},[a._v("确定")])],1)])],1)},staticRenderFns:[]},x={data:function(){return{pageData:{isDetail:!1,list:[{name:"否",value:0},{name:"是",value:1}],statusList:[{name:"全部",value:""},{name:"未提交",value:0},{name:"已提交",value:1},{name:"已审批",value:2}],oaStatusList:[{name:"全部",value:""},{name:"提交",value:0},{name:"驳回",value:1},{name:"已审批",value:2},{name:"未提交",value:3}],tableObj:{mainId:"",siteNo:"",yearMonthStr:"",status:"",oaStatus:"",currentPage:1,pageSize:10,totalPage:1,totalRows:1,pageArray:[10,20,30,40,50],list:[]}}}},mounted:function(){this.initFunc()},methods:{initFunc:function(){this.pageData.tableObj.mainId=this.$route.query.mainId,this.pageData.tableObj.siteNo=this.$route.query.siteNo,this.pageData.tableObj.yearMonthStr=this.$route.query.yearMonthStr,this.pageData.tableObj.status=this.$route.query.status,this.pageData.tableObj.oaStatus=this.$route.query.oaStatus,this.queryEvt()},queryEvt:function(){var a=this,e={mainId:this.pageData.tableObj.mainId},t=this.$loading({lock:!0,spinner:"wm-icon-loading",background:"rgba(0, 0, 0, 0.7)"});fetch(this.$api.urls.POST_EMPLOYEESCORE_QUERYITEMBYLEADER,{method:"post",headers:{"Content-type":"application/json"},credentials:"include",body:p()(e)}).then(function(a){return a.json()}).then(function(e){setTimeout(function(){t.close()},500),e.success?(a.pageData.tableObj.currentPage=e.model.currentPage,a.pageData.tableObj.pageSize=e.model.pageSize,a.pageData.tableObj.totalPage=e.model.pageCount,a.pageData.tableObj.totalRows=e.model.count,a.pageData.tableObj.list=e.model,a.pageData.tableObj.list.length>0&&a.checkTeamLeaderEvt(function(e){e.model&&(a.pageData.isDetail="3"==a.pageData.tableObj.oaStatus)})):a.$message.error(e.message)}).catch(function(e){setTimeout(function(){t.close()},500),a.$message.error("系统错误："+e)})},checkTeamLeaderEvt:function(a){var e=this;fetch(this.$api.urls.POST_EMPLOYEESCORE_CHECKTEAMLEADER,{method:"post",headers:{"Content-type":"application/json"},credentials:"include",body:p()({})}).then(function(a){return a.json()}).then(function(t){t.success?a(t):e.$message.error(t.message)}).catch(function(a){setTimeout(function(){loading.close()},500),e.$message.error("系统错误："+a)})},validateEvt:function(a,e,t,l,s){if(!e)return a.target.focus(),a.target.value="",this.$message.error(l+"不能为空"),!1;if(!/^[1-9]\d*$/.test(e))return a.target.focus(),a.target.value="",this.$message.error(l+"必须是正整数"),!1;if(e<1)return a.target.focus(),a.target.value="",this.$message.error(l+"必须大于等于1"),!1;if(e>t)return a.target.focus(),a.target.value="",this.$message.error(l+"必须小于等于"+t),!1;var o=null==s.skillScore||""==s.skillScore?0:parseInt(s.skillScore),i=null==s.efficiencyScore||""==s.efficiencyScore?0:parseInt(s.efficiencyScore),n=null==s.attendanceScore||""==s.attendanceScore?0:parseInt(s.attendanceScore),r=null==s.serviceScore||""==s.serviceScore?0:parseInt(s.serviceScore);s.finalScore=o+i+n+r},addEvt:function(){var a=this,e=this.pageData.tableObj.list.map(function(a){return{id:a.id,skillScore:a.skillScore,efficiencyScore:a.efficiencyScore,attendanceScore:a.attendanceScore,serviceScore:a.serviceScore,finalScore:a.finalScore,bonus:a.bonus,allowance:a.allowance}});if(e.some(function(a){return""==a.skillScore||null==a.skillScore||""==a.efficiencyScore||null==a.efficiencyScore||""==a.attendanceScore||null==a.attendanceScore||""==a.serviceScore||null==a.serviceScore||""==a.finalScore||null==a.finalScore}))return this.$message({message:"请填写评分!",type:"warning"}),!1;var t=this.$loading({lock:!0,spinner:"wm-icon-loading",background:"rgba(0, 0, 0, 0.7)"});fetch(this.$api.urls.POST_EMPLOYEESCORE_UPDATEITEMS,{method:"post",headers:{"Content-type":"application/json"},credentials:"include",body:p()(e)}).then(function(a){return a.json()}).then(function(e){setTimeout(function(){t.close()},500),e.success?a.$alert("提交成功","提示",{center:!0,dangerouslyUseHTMLString:!0,callback:function(e){a.$router.push({name:"scoreLeaderLink"})}}):a.$message.error(e.message)}).catch(function(e){setTimeout(function(){t.close()},500),a.$message.error("系统错误："+e)})},handleSizeChange:function(a){this.pageData.tableObj.pageSize=a,this.queryEvt()},handleCurrentChange:function(a){this.pageData.tableObj.currentPage=a,this.queryEvt()}}},P={render:function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("el-main",[t("div",{staticClass:"container-fluid"},[t("el-breadcrumb",{staticClass:"breadcrumb",attrs:{"separator-class":"el-icon-arrow-right"}},[t("el-breadcrumb-item",{attrs:{to:{name:"homeLink"}}},[t("i",{staticClass:"glyphicon glyphicon-home"}),a._v("首页")]),a._v(" "),t("el-breadcrumb-item",[a._v("店铺管理")]),a._v(" "),t("el-breadcrumb-item",{attrs:{to:{name:"scoreLeaderLink"}}},[a._v("员工评分")]),a._v(" "),t("el-breadcrumb-item",[a._v("评分表详情")])],1)],1),a._v(" "),t("div",{staticClass:"rtl-custom-box mt15"},[t("div",{staticClass:"box-hd"},[t("div",{staticClass:"cont"},[t("div",{staticClass:"form-horizontal"},[t("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0}},[t("el-row",[t("el-col",{attrs:{span:6}},[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("门店编号：")])]),a._v(" "),t("el-col",{attrs:{span:16}},[t("el-form-item",[t("el-input",{attrs:{disabled:!0,placeholder:"请输入门店编号"},model:{value:a.pageData.tableObj.siteNo,callback:function(e){a.$set(a.pageData.tableObj,"siteNo",e)},expression:"pageData.tableObj.siteNo"}})],1)],1)],1),a._v(" "),t("el-col",{attrs:{span:6}},[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("月份：")])]),a._v(" "),t("el-col",{attrs:{span:16}},[t("el-date-picker",{attrs:{disabled:!0,"value-format":"yyyyMM",type:"month",placeholder:"请选择日期"},model:{value:a.pageData.tableObj.yearMonthStr,callback:function(e){a.$set(a.pageData.tableObj,"yearMonthStr",e)},expression:"pageData.tableObj.yearMonthStr"}})],1)],1),a._v(" "),t("el-col",{attrs:{span:6}},[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("状态：")])]),a._v(" "),t("el-col",{attrs:{span:16}},[t("el-form-item",[t("el-select",{attrs:{disabled:!0},model:{value:a.pageData.tableObj.status,callback:function(e){a.$set(a.pageData.tableObj,"status",e)},expression:"pageData.tableObj.status"}},a._l(a.pageData.statusList,function(a){return t("el-option",{key:a.value,attrs:{label:a.name,value:a.value}})}))],1)],1)],1),a._v(" "),t("el-col",{attrs:{span:6}},[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("审批状态：")])]),a._v(" "),t("el-col",{attrs:{span:16}},[t("el-form-item",[t("el-select",{attrs:{disabled:!0},model:{value:a.pageData.tableObj.oaStatus,callback:function(e){a.$set(a.pageData.tableObj,"oaStatus",e)},expression:"pageData.tableObj.oaStatus"}},a._l(a.pageData.oaStatusList,function(a){return t("el-option",{key:a.value,attrs:{label:a.name,value:a.value}})}))],1)],1)],1)],1)],1)],1)])])]),a._v(" "),t("div",{staticClass:"box-bd pr mt15"},[t("div",{staticClass:"tab-content custom-content"},[t("div",{staticClass:"tab-pane in active"},[t("div",{staticClass:"table-responsive"},[t("el-table",{staticStyle:{width:"100%"},attrs:{border:"",data:a.pageData.tableObj.list}},[t("el-table-column",{attrs:{sortable:"",prop:"employeeNo",label:"员工编号","min-width":"90"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"employeeName",label:"员工姓名","min-width":"110"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"partnerTeamName",label:"组织名称","min-width":"120"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",label:"工作技能(60%)","min-width":"120"},scopedSlots:a._u([{key:"default",fn:function(e){return[a.pageData.isDetail?a._e():t("span",[a._v(a._s(e.row.skillScore))]),a._v(" "),a.pageData.isDetail?t("el-input",{attrs:{maxlength:2,max:60,min:1,placeholder:"请输入工作技能",clearable:""},on:{blur:function(t){a.validateEvt(t,e.row.skillScore,60,"工作技能",e.row)}},model:{value:e.row.skillScore,callback:function(t){a.$set(e.row,"skillScore",t)},expression:"scope.row.skillScore"}}):a._e()]}}])}),a._v(" "),t("el-table-column",{attrs:{sortable:"",label:"工作效果(20%)","min-width":"130"},scopedSlots:a._u([{key:"default",fn:function(e){return[a.pageData.isDetail?a._e():t("span",[a._v(a._s(e.row.efficiencyScore))]),a._v(" "),a.pageData.isDetail?t("el-input",{attrs:{maxlength:2,max:"20",min:"1",placeholder:"请输入工作效果",clearable:""},on:{blur:function(t){a.validateEvt(t,e.row.efficiencyScore,20,"工作效果",e.row)}},model:{value:e.row.efficiencyScore,callback:function(t){a.$set(e.row,"efficiencyScore",t)},expression:"scope.row.efficiencyScore"}}):a._e()]}}])}),a._v(" "),t("el-table-column",{attrs:{sortable:"",label:"出勤情况(10%)","min-width":"120"},scopedSlots:a._u([{key:"default",fn:function(e){return[a.pageData.isDetail?a._e():t("span",[a._v(a._s(e.row.attendanceScore))]),a._v(" "),a.pageData.isDetail?t("el-input",{attrs:{maxlength:2,max:"10",min:"1",placeholder:"请输入出勤情况",clearable:""},on:{blur:function(t){a.validateEvt(t,e.row.attendanceScore,10,"出勤情况",e.row)}},model:{value:e.row.attendanceScore,callback:function(t){a.$set(e.row,"attendanceScore",t)},expression:"scope.row.attendanceScore"}}):a._e()]}}])}),a._v(" "),t("el-table-column",{attrs:{sortable:"",label:"顾客服务(10%)","min-width":"120"},scopedSlots:a._u([{key:"default",fn:function(e){return[a.pageData.isDetail?a._e():t("span",[a._v(a._s(e.row.serviceScore))]),a._v(" "),a.pageData.isDetail?t("el-input",{attrs:{maxlength:2,max:"10",min:"1",placeholder:"请输入顾客服务",clearable:""},on:{blur:function(t){a.validateEvt(t,e.row.serviceScore,15,"顾客服务",e.row)}},model:{value:e.row.serviceScore,callback:function(t){a.$set(e.row,"serviceScore",t)},expression:"scope.row.serviceScore"}}):a._e()]}}])}),a._v(" "),t("el-table-column",{attrs:{sortable:"",label:"奖金分配","min-width":"120"},scopedSlots:a._u([{key:"default",fn:function(e){return[a.pageData.isDetail?a._e():t("span",[a._v(a._s(0==e.row.bonus?"否":"是"))]),a._v(" "),a.pageData.isDetail?t("el-select",{model:{value:e.row.bonus,callback:function(t){a.$set(e.row,"bonus",t)},expression:"scope.row.bonus"}},a._l(a.pageData.list,function(a){return t("el-option",{key:a.value,attrs:{label:a.name,value:a.value}})})):a._e()]}}])}),a._v(" "),t("el-table-column",{attrs:{sortable:"",label:"津贴分配","min-width":"120"},scopedSlots:a._u([{key:"default",fn:function(e){return[a.pageData.isDetail?a._e():t("span",[a._v(a._s(0==e.row.allowance?"否":"是"))]),a._v(" "),a.pageData.isDetail?t("el-select",{model:{value:e.row.allowance,callback:function(t){a.$set(e.row,"allowance",t)},expression:"scope.row.allowance"}},a._l(a.pageData.list,function(a){return t("el-option",{key:a.value,attrs:{label:a.name,value:a.value}})})):a._e()]}}])}),a._v(" "),t("el-table-column",{attrs:{sortable:"",label:"最终得分(月评分)","min-width":"120"},scopedSlots:a._u([{key:"default",fn:function(e){return[t("span",[a._v(a._s(e.row.finalScore))])]}}])})],1)],1)])])]),a._v(" "),t("el-row",{staticClass:"mb10"},[t("el-col",{staticClass:"text-center",attrs:{span:24}},[a.pageData.isDetail?t("el-button",{attrs:{type:"success",icon:"el-icon-edit-outline"},on:{click:function(e){return e.stopPropagation(),a.addEvt(e)}}},[a._v("提交")]):a._e(),a._v(" "),t("router-link",{attrs:{to:{name:"scoreLeaderLink"}}},[t("el-button",{attrs:{type:"danger",icon:"el-icon-circle-close-outline"}},[a._v("取消")])],1)],1)],1)],1)},staticRenderFns:[]},I={data:function(){return{value6:"",pageData:{isDisabled:!1,oaStatusList:[{name:"全部",value:""},{name:"提交",value:"0"},{name:"驳回",value:"1"},{name:"已审批",value:"2"},{name:"未提交",value:"3"}],tableObj:{siteNo:"",yearMonthStr:"",oaStatus:"",startTime:"",endTime:"",currentPage:1,pageSize:10,totalPage:1,totalRows:1,pageArray:[10,20,30,40,50],list:[]}}}},created:function(){this.commonInfo()},methods:{initFunc:function(){this.queryEvt()},queryEvt:function(){var a=this,e={siteNo:this.pageData.tableObj.siteNo,yearMonthStr:this.pageData.tableObj.yearMonthStr,oaStatus:this.pageData.tableObj.oaStatus,startTime:this.pageData.tableObj.startTime,endTime:this.pageData.tableObj.endTime,currentPage:this.pageData.tableObj.currentPage,pageSize:this.pageData.tableObj.pageSize};if(this.$api.compareDate(e.startTime,e.endTime))return this.$message({message:"开始时间不能大于结束时间!",type:"warning"}),!1;var t=this.$loading({lock:!0,spinner:"wm-icon-loading",background:"rgba(0, 0, 0, 0.7)"});fetch(this.$api.urls.POST_EMPLOYEESCORE_LIST,{method:"post",headers:{"Content-type":"application/json"},credentials:"include",body:p()(e)}).then(function(a){return a.json()}).then(function(e){setTimeout(function(){t.close()},500),e.success?(a.pageData.tableObj.currentPage=e.model.currentPage,a.pageData.tableObj.pageSize=e.model.pageSize,a.pageData.tableObj.totalPage=e.model.pageCount,a.pageData.tableObj.totalRows=e.model.count,a.pageData.tableObj.list=e.model.data.map(function(e){return a.pageData.oaStatusList.forEach(function(a){a.value==e.oaStatus&&(e.oaStatusName=a.name)}),e.created=a.$api.dateFormat("yyyy-MM-dd",e.created),e.modified=a.$api.dateFormat("yyyy-MM-dd",e.modified),e})):a.$message.error(e.message)}).catch(function(e){setTimeout(function(){t.close()},500),a.$message.error("系统错误："+e)})},commonInfo:function(){var a=this,e=this.$loading({lock:!0,spinner:"wm-icon-loading",background:"rgba(0, 0, 0, 0.7)"});fetch(this.$api.urls.POST_QUERYCOMMONINFO,{method:"post",headers:{"Content-type":"application/json"},credentials:"include",body:p()({})}).then(function(a){return a.json()}).then(function(t){setTimeout(function(){e.close()},500),t.success?(""!=t.model.siteNo&&(a.pageData.isDisabled=!0,a.pageData.tableObj.siteNo=t.model.siteNo),a.initFunc()):a.$message.error(t.message)}).catch(function(t){setTimeout(function(){e.close()},500),a.$message.error("错误："+t)})},detailEvt:function(a,e){this.$router.push({name:"scoreMemberDetailLink",query:{mainId:e.row.id,status:e.row.status,orderNo:e.row.orderNo,siteNo:e.row.siteNo,yearMonthStr:e.row.yearMonthStr,oaId:e.row.oaId,oaStatus:e.row.oaStatus}})},createEvt:function(){var a=this,e=this.$loading({lock:!0,spinner:"wm-icon-loading",background:"rgba(0, 0, 0, 0.7)"});fetch(this.$api.urls.POST_EMPLOYEESCORE_CREATE,{method:"post",headers:{"Content-type":"application/json"},credentials:"include"}).then(function(a){return a.json()}).then(function(t){setTimeout(function(){e.close()},500),t.success?a.$alert(t.message,"提示",{center:!0,type:"success",dangerouslyUseHTMLString:!0,callback:function(e){a.$router.go(0)}}):a.$message.error(t.message)}).catch(function(t){setTimeout(function(){e.close()},500),a.$message.error("系统错误："+t)})},uploadEvt:function(){var a=this.pageData.tableObj.siteNo,e=this.pageData.tableObj.yearMonthStr;if(""==e)return this.$message.error("请选择月份"),!1;window.open("/wumart/partner/employeescore/downScore?siteNo="+a+"&yearMonthStr="+e+"&oaStatus=2")},handleSizeChange:function(a){this.pageData.tableObj.pageSize=a,this.queryEvt()},handleCurrentChange:function(a){this.pageData.tableObj.currentPage=a,this.queryEvt()}}},R={render:function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("el-main",[t("div",{staticClass:"container-fluid"},[t("el-breadcrumb",{staticClass:"breadcrumb",attrs:{"separator-class":"el-icon-arrow-right"}},[t("el-breadcrumb-item",{attrs:{to:{name:"homeLink"}}},[t("i",{staticClass:"glyphicon glyphicon-home"}),a._v("首页")]),a._v(" "),t("el-breadcrumb-item",[a._v("店铺管理")]),a._v(" "),t("el-breadcrumb-item",[a._v("员工评分表")])],1)],1),a._v(" "),t("div",{staticClass:"rtl-custom-box mt15"},[t("div",{staticClass:"box-hd"},[t("div",{staticClass:"cont"},[t("div",{staticClass:"form-horizontal"},[t("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0}},[t("el-row",[t("el-col",{attrs:{span:6}},[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("门店编号：")])]),a._v(" "),t("el-col",{attrs:{span:16}},[t("el-form-item",[t("el-input",{attrs:{disabled:a.pageData.isDisabled,placeholder:"请输入门店编号"},model:{value:a.pageData.tableObj.siteNo,callback:function(e){a.$set(a.pageData.tableObj,"siteNo",e)},expression:"pageData.tableObj.siteNo"}})],1)],1)],1),a._v(" "),t("el-col",{attrs:{span:6}},[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("月份：")])]),a._v(" "),t("el-col",{attrs:{span:16}},[t("el-date-picker",{attrs:{"value-format":"yyyyMM",type:"month",placeholder:"请选择日期"},model:{value:a.pageData.tableObj.yearMonthStr,callback:function(e){a.$set(a.pageData.tableObj,"yearMonthStr",e)},expression:"pageData.tableObj.yearMonthStr"}})],1)],1),a._v(" "),t("el-col",{attrs:{span:12}},[t("el-col",{attrs:{span:4}},[t("label",{staticClass:"control-label"},[a._v("导入时间：")])]),a._v(" "),t("el-col",{attrs:{span:20}},[t("el-col",{attrs:{span:10}},[t("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",align:"right",type:"date",placeholder:"请选择日期"},model:{value:a.pageData.tableObj.startTime,callback:function(e){a.$set(a.pageData.tableObj,"startTime",e)},expression:"pageData.tableObj.startTime"}})],1),a._v(" "),t("el-col",{staticClass:"text-center",staticStyle:{"line-height":"40px"},attrs:{span:2}},[a._v("-")]),a._v(" "),t("el-col",{attrs:{span:10}},[t("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",align:"right",type:"date",placeholder:"请选择日期"},model:{value:a.pageData.tableObj.endTime,callback:function(e){a.$set(a.pageData.tableObj,"endTime",e)},expression:"pageData.tableObj.endTime"}})],1)],1)],1)],1),a._v(" "),t("el-row",[t("el-col",{attrs:{span:6}},[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("审批状态：")])]),a._v(" "),t("el-col",{attrs:{span:16}},[t("el-form-item",[t("el-select",{model:{value:a.pageData.tableObj.oaStatus,callback:function(e){a.$set(a.pageData.tableObj,"oaStatus",e)},expression:"pageData.tableObj.oaStatus"}},a._l(a.pageData.oaStatusList,function(a){return t("el-option",{key:a.value,attrs:{label:a.name,value:a.value}})}))],1)],1)],1),a._v(" "),t("el-col",{staticClass:"text-center",attrs:{span:6}},[t("el-form-item",[t("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(e){return e.stopPropagation(),a.queryEvt(e)}}},[a._v("查询")])],1)],1)],1)],1)],1)])])]),a._v(" "),t("div",{staticClass:"box-bd pr mt15"},[t("div",{staticClass:"tab-content custom-content"},[t("div",{staticClass:"tab-pane in active"},[t("el-row",{staticClass:"mb10"},[t("el-col",{attrs:{span:12}},[t("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:function(e){return e.stopPropagation(),a.createEvt(e)}}},[a._v("生成评分表")])],1),a._v(" "),t("el-col",{staticClass:"text-right",attrs:{span:12}},[t("el-button",{attrs:{type:"primary",plain:"",icon:"el-icon-download"},on:{click:a.uploadEvt}},[a._v("导出")])],1)],1),a._v(" "),t("div",{staticClass:"table-responsive"},[t("el-table",{staticStyle:{width:"100%"},attrs:{border:"",data:a.pageData.tableObj.list}},[t("el-table-column",{attrs:{sortable:"",prop:"orderNo",label:"单号","min-width":"90"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"siteNo",label:"门店号","min-width":"110"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"siteName",label:"门店名称","min-width":"120"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"oaId",label:"OA单号","min-width":"120"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"yearMonthStr",label:"月份","min-width":"130"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"creatorName",label:"当前审批人","min-width":"120"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"oaStatusName",label:"审批状态","min-width":"120"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"auditOpinion",label:"审批意见","min-width":"120"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"created",label:"提交时间","min-width":"110"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"creator",label:"提交人","min-width":"110"}}),a._v(" "),t("el-table-column",{attrs:{fixed:"right",label:"操作","min-width":"100"},scopedSlots:a._u([{key:"default",fn:function(e){return[t("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){t.stopPropagation(),a.detailEvt(e.$index,e)}}},[a._v("查看详情")])]}}])})],1)],1),a._v(" "),t("div",{staticClass:"page"},[t("div",{staticClass:"block p15 text-center"},[t("el-pagination",{attrs:{"current-page":a.pageData.tableObj.currentPage,"page-sizes":a.pageData.tableObj.pageArray,"page-size":a.pageData.tableObj.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:a.pageData.tableObj.totalRows},on:{"size-change":a.handleSizeChange,"current-change":a.handleCurrentChange}})],1)])],1)])])])},staticRenderFns:[]},M={data:function(){return{pageData:{list:[{name:"否",value:0},{name:"是",value:1}],isDetail:!1,oaStatusList:[{name:"全部",value:""},{name:"提交",value:"0"},{name:"驳回",value:"1"},{name:"已审批",value:"2"},{name:"未提交",value:"3"}],tableObj:{mainId:"",orderNo:"",siteNo:"",yearMonthStr:"",oaId:"",oaStatus:"",oaStatusName:"",status:"",currentPage:1,pageSize:10,totalPage:1,totalRows:1,pageArray:[10,20,30,40,50],list:[],newList:[]}}}},mounted:function(){this.initFunc()},methods:{initFunc:function(){var a=this;this.pageData.tableObj.mainId=this.$route.query.mainId,this.pageData.tableObj.orderNo=this.$route.query.orderNo,this.pageData.tableObj.siteNo=this.$route.query.siteNo,this.pageData.tableObj.yearMonthStr=this.$route.query.yearMonthStr,this.pageData.tableObj.oaId=this.$route.query.oaId,this.pageData.tableObj.oaStatus=this.$route.query.oaStatus;var e=this.pageData.oaStatusList.find(function(e){return e.value==a.pageData.tableObj.oaStatus});this.pageData.tableObj.oaStatusName=e.name,this.pageData.tableObj.status=this.$route.query.status,this.queryEvt()},queryEvt:function(){var a=this,e={mainId:this.pageData.tableObj.mainId,currentPage:this.pageData.tableObj.currentPage,pageSize:this.pageData.tableObj.pageSize},t=this.$loading({lock:!0,spinner:"wm-icon-loading",background:"rgba(0, 0, 0, 0.7)"});fetch(this.$api.urls.POST_EMPLOYEESCORE_QUERYITEMBYMANAGER,{method:"post",headers:{"Content-type":"application/json"},credentials:"include",body:p()(e)}).then(function(a){return a.json()}).then(function(e){setTimeout(function(){t.close()},500),e.success?(a.pageData.tableObj.currentPage=e.model.currentPage,a.pageData.tableObj.pageSize=e.model.pageSize,a.pageData.tableObj.totalPage=e.model.pageCount,a.pageData.tableObj.totalRows=e.model.count,a.pageData.tableObj.list=e.model.data.map(function(e){return e.bonusRate=a.$api.accMul(e.bonusRate,100),e.allowanceRate=a.$api.accMul(e.allowanceRate,100),e}),a.pageData.tableObj.list=e.model.data,a.pageData.isDetail="3"==a.pageData.tableObj.oaStatus):a.$message.error(e.message)}).catch(function(e){setTimeout(function(){t.close()},500),a.$message.error("系统错误："+e)})},validateEvt:function(a,e,t,l,s){if(!e)return a.target.focus(),a.target.value="",this.$message.error(l+"不能为空"),!1;if(!/^[1-9]\d*$/.test(e))return a.target.focus(),a.target.value="",this.$message.error(l+"必须是正整数"),!1;if(e<1)return a.target.focus(),a.target.value="",this.$message.error(l+"必须大于等于1"),!1;if(e>t)return a.target.focus(),a.target.value="",this.$message.error(l+"必须小于等于"+t),!1;var o=null==s.skillScore||""==s.skillScore?0:parseInt(s.skillScore),i=null==s.efficiencyScore||""==s.efficiencyScore?0:parseInt(s.efficiencyScore),n=null==s.attendanceScore||""==s.attendanceScore?0:parseInt(s.attendanceScore),r=null==s.serviceScore||""==s.serviceScore?0:parseInt(s.serviceScore);s.finalScore=o+i+n+r,this.updateEvt(s)},updateEvt:function(a){var e=this,t=[{id:a.id,skillScore:a.skillScore,efficiencyScore:a.efficiencyScore,attendanceScore:a.attendanceScore,serviceScore:a.serviceScore,finalScore:a.finalScore,bonus:a.bonus,allowance:a.allowance}];if(t.some(function(a){return""==a.skillScore||null==a.skillScore||""==a.efficiencyScore||null==a.efficiencyScore||""==a.attendanceScore||null==a.attendanceScore||""==a.serviceScore||null==a.serviceScore||""==a.finalScore||null==a.finalScore}))return this.$message({message:"请填写完这一行评分!",type:"warning"}),!1;fetch(this.$api.urls.POST_EMPLOYEESCORE_UPDATEITEMS,{method:"post",headers:{"Content-type":"application/json"},credentials:"include",body:p()(t)}).then(function(a){return a.json()}).then(function(a){a.success?e.$message({message:"保存成功",type:"success"}):e.$message.error(a.message)}).catch(function(a){e.$message.error("系统错误："+a)})},saveEvt:function(){var a=this;if(0!=this.pageData.tableObj.status)return this.$message({message:"不能重复提交OA单!",type:"warning"}),!1;var e={mainId:this.pageData.tableObj.mainId},t=this.$loading({lock:!0,spinner:"wm-icon-loading",background:"rgba(0, 0, 0, 0.7)"});fetch(this.$api.urls.POST_EMPLOYEESCORE_SUBMITOAFLOW,{method:"post",headers:{"Content-type":"application/json"},credentials:"include",body:p()(e)}).then(function(a){return a.json()}).then(function(e){setTimeout(function(){t.close()},500),e.success?a.$alert(e.message,"提示",{center:!0,dangerouslyUseHTMLString:!0,callback:function(e){a.$router.push({name:"scoreMemberLink"})}}):a.$message.error(e.message)}).catch(function(e){setTimeout(function(){t.close()},500),a.$message.error("系统错误："+e)})},handleSizeChange:function(a){this.pageData.tableObj.pageSize=a,this.queryEvt()},handleCurrentChange:function(a){this.pageData.tableObj.currentPage=a,this.queryEvt()}}},L={render:function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("el-main",[t("div",{staticClass:"container-fluid"},[t("el-breadcrumb",{staticClass:"breadcrumb",attrs:{"separator-class":"el-icon-arrow-right"}},[t("el-breadcrumb-item",{attrs:{to:{name:"homeLink"}}},[t("i",{staticClass:"glyphicon glyphicon-home"}),a._v("首页")]),a._v(" "),t("el-breadcrumb-item",[a._v("店铺管理")]),a._v(" "),t("el-breadcrumb-item",{attrs:{to:{name:"scoreMemberLink"}}},[a._v("员工评分表")]),a._v(" "),t("el-breadcrumb-item",[a._v("评分表详情")])],1)],1),a._v(" "),t("div",{staticClass:"rtl-custom-box mt15"},[t("div",{staticClass:"box-hd"},[t("div",{staticClass:"cont"},[t("div",{staticClass:"form-horizontal"},[t("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0}},[t("el-row",[t("el-col",{attrs:{span:6}},[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("申请单号：")])]),a._v(" "),t("el-col",{attrs:{span:16}},[t("el-form-item",[t("el-input",{attrs:{disabled:!0,placeholder:"请输入申请单号"},model:{value:a.pageData.tableObj.orderNo,callback:function(e){a.$set(a.pageData.tableObj,"orderNo",e)},expression:"pageData.tableObj.orderNo"}})],1)],1)],1),a._v(" "),t("el-col",{attrs:{span:6}},[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("门店编号：")])]),a._v(" "),t("el-col",{attrs:{span:16}},[t("el-form-item",[t("el-input",{attrs:{disabled:!0,placeholder:"请输入门店编号"},model:{value:a.pageData.tableObj.siteNo,callback:function(e){a.$set(a.pageData.tableObj,"siteNo",e)},expression:"pageData.tableObj.siteNo"}})],1)],1)],1),a._v(" "),t("el-col",{attrs:{span:6}},[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("月份：")])]),a._v(" "),t("el-col",{attrs:{span:16}},[t("el-date-picker",{attrs:{disabled:!0,"value-format":"yyyyMM",type:"month",placeholder:"请选择日期"},model:{value:a.pageData.tableObj.yearMonthStr,callback:function(e){a.$set(a.pageData.tableObj,"yearMonthStr",e)},expression:"pageData.tableObj.yearMonthStr"}})],1)],1),a._v(" "),t("el-col",{attrs:{span:6}},[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("OA单号：")])]),a._v(" "),t("el-col",{attrs:{span:16}},[t("el-form-item",[t("el-input",{attrs:{disabled:!0,placeholder:"请输入OA单号"},model:{value:a.pageData.tableObj.oaId,callback:function(e){a.$set(a.pageData.tableObj,"oaId",e)},expression:"pageData.tableObj.oaId"}})],1)],1)],1)],1),a._v(" "),t("el-row",[t("el-col",{attrs:{span:6}},[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("状态：")])]),a._v(" "),t("el-col",{attrs:{span:16}},[t("el-form-item",[t("el-input",{attrs:{disabled:!0,placeholder:"请输入状态"},model:{value:a.pageData.tableObj.oaStatusName,callback:function(e){a.$set(a.pageData.tableObj,"oaStatusName",e)},expression:"pageData.tableObj.oaStatusName"}}),a._v(" "),a._e()],1)],1)],1)],1)],1)],1)])])]),a._v(" "),t("div",{staticClass:"box-bd pr"},[t("div",{staticClass:"tab-content custom-content"},[t("div",{staticClass:"tab-pane in active"},[t("div",{staticClass:"table-responsive"},[t("el-table",{staticStyle:{width:"100%"},attrs:{border:"",data:a.pageData.tableObj.list}},[t("el-table-column",{attrs:{sortable:"",prop:"employeeNo",label:"员工编号","min-width":"90"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"employeeName",label:"员工姓名","min-width":"110"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"partnerTeamName",label:"组织名称","min-width":"120"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",label:"工作技能(60%)","min-width":"120"},scopedSlots:a._u([{key:"default",fn:function(e){return[a.pageData.isDetail?a._e():t("span",[a._v(a._s(e.row.skillScore))]),a._v(" "),a.pageData.isDetail?t("el-input",{attrs:{maxlength:2,max:60,min:1,placeholder:"请输入工作技能",clearable:""},on:{blur:function(t){a.validateEvt(t,e.row.skillScore,60,"工作技能",e.row)}},model:{value:e.row.skillScore,callback:function(t){a.$set(e.row,"skillScore",t)},expression:"scope.row.skillScore"}}):a._e()]}}])}),a._v(" "),t("el-table-column",{attrs:{sortable:"",label:"工作效果(20%)","min-width":"130"},scopedSlots:a._u([{key:"default",fn:function(e){return[a.pageData.isDetail?a._e():t("span",[a._v(a._s(e.row.efficiencyScore))]),a._v(" "),a.pageData.isDetail?t("el-input",{attrs:{maxlength:2,max:"20",min:"1",placeholder:"请输入工作效果",clearable:""},on:{blur:function(t){a.validateEvt(t,e.row.efficiencyScore,20,"工作效果",e.row)}},model:{value:e.row.efficiencyScore,callback:function(t){a.$set(e.row,"efficiencyScore",t)},expression:"scope.row.efficiencyScore"}}):a._e()]}}])}),a._v(" "),t("el-table-column",{attrs:{sortable:"",label:"出勤情况(10%)","min-width":"120"},scopedSlots:a._u([{key:"default",fn:function(e){return[a.pageData.isDetail?a._e():t("span",[a._v(a._s(e.row.attendanceScore))]),a._v(" "),a.pageData.isDetail?t("el-input",{attrs:{maxlength:2,max:"10",min:"1",placeholder:"请输入出勤情况",clearable:""},on:{blur:function(t){a.validateEvt(t,e.row.attendanceScore,10,"出勤情况",e.row)}},model:{value:e.row.attendanceScore,callback:function(t){a.$set(e.row,"attendanceScore",t)},expression:"scope.row.attendanceScore"}}):a._e()]}}])}),a._v(" "),t("el-table-column",{attrs:{sortable:"",label:"顾客服务(10%)","min-width":"120"},scopedSlots:a._u([{key:"default",fn:function(e){return[a.pageData.isDetail?a._e():t("span",[a._v(a._s(e.row.serviceScore))]),a._v(" "),a.pageData.isDetail?t("el-input",{attrs:{maxlength:2,max:"10",min:"1",placeholder:"请输入顾客服务",clearable:""},on:{blur:function(t){a.validateEvt(t,e.row.serviceScore,15,"顾客服务",e.row)}},model:{value:e.row.serviceScore,callback:function(t){a.$set(e.row,"serviceScore",t)},expression:"scope.row.serviceScore"}}):a._e()]}}])}),a._v(" "),t("el-table-column",{attrs:{sortable:"",label:"奖金分配","min-width":"120"},scopedSlots:a._u([{key:"default",fn:function(e){return[a.pageData.isDetail?a._e():t("span",[a._v(a._s(0==e.row.bonus?"否":"是"))]),a._v(" "),a.pageData.isDetail?t("el-select",{on:{change:function(t){a.updateEvt(e.row)}},model:{value:e.row.bonus,callback:function(t){a.$set(e.row,"bonus",t)},expression:"scope.row.bonus"}},a._l(a.pageData.list,function(a){return t("el-option",{key:a.value,attrs:{label:a.name,value:a.value}})})):a._e()]}}])}),a._v(" "),t("el-table-column",{attrs:{sortable:"",label:"津贴分配","min-width":"120"},scopedSlots:a._u([{key:"default",fn:function(e){return[a.pageData.isDetail?a._e():t("span",[a._v(a._s(0==e.row.allowance?"否":"是"))]),a._v(" "),a.pageData.isDetail?t("el-select",{on:{change:function(t){a.updateEvt(e.row)}},model:{value:e.row.allowance,callback:function(t){a.$set(e.row,"allowance",t)},expression:"scope.row.allowance"}},a._l(a.pageData.list,function(a){return t("el-option",{key:a.value,attrs:{label:a.name,value:a.value}})})):a._e()]}}])}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"finalScore",label:"最终得分(月评分)","min-width":"120"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",label:"奖金比例","min-width":"120"},scopedSlots:a._u([{key:"default",fn:function(e){return[t("span",[a._v(a._s(e.row.bonusRate)+"%")])]}}])}),a._v(" "),t("el-table-column",{attrs:{sortable:"",label:"津贴比例","min-width":"120"},scopedSlots:a._u([{key:"default",fn:function(e){return[t("span",[a._v(a._s(e.row.allowanceRate)+"%")])]}}])})],1)],1),a._v(" "),t("div",{staticClass:"page"},[t("div",{staticClass:"block p15 text-center"},[t("el-pagination",{attrs:{"current-page":a.pageData.tableObj.currentPage,"page-sizes":a.pageData.tableObj.pageArray,"page-size":a.pageData.tableObj.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:a.pageData.tableObj.totalRows},on:{"size-change":a.handleSizeChange,"current-change":a.handleCurrentChange}})],1)])])])]),a._v(" "),t("el-row",{staticClass:"mb10"},[t("el-col",{staticClass:"text-center",attrs:{span:24}},[2!=a.pageData.tableObj.oaStatus?t("el-button",{attrs:{type:"success",icon:"el-icon-edit-outline"},on:{click:function(e){return e.stopPropagation(),a.saveEvt(e)}}},[a._v("提交")]):a._e(),a._v(" "),t("router-link",{staticClass:"ml10",attrs:{to:{name:"scoreMemberLink"}}},[t("el-button",{attrs:{type:"danger",icon:"el-icon-circle-close-outline"}},[a._v("取消")])],1)],1)],1)],1)},staticRenderFns:[]},F={data:function(){return{pageData:{statusList:[{name:"全部",value:""},{name:"失效",value:0},{name:"生效",value:1}],tableObj:{yearMonthStr:"",status:"",startTime:"",endTime:"",pageSize:10,currentPage:1,totalPage:1,totalRows:1,pageArray:[10,20,30,40,50],list:[]}}}},created:function(){this.initFunc()},methods:{initFunc:function(){this.queryEvt()},queryEvt:function(){var a=this,e={yearMonthStr:this.pageData.tableObj.yearMonthStr,status:this.pageData.tableObj.status,startTime:this.pageData.tableObj.startTime,endTime:this.pageData.tableObj.endTime,currentPage:this.pageData.tableObj.currentPage,pageSize:this.pageData.tableObj.pageSize};if(this.$api.compareDate(e.startTime,e.endTime))return this.$message({message:"开始时间不能大于结束时间!",type:"warning"}),!1;var t=this.$loading({lock:!0,spinner:"wm-icon-loading",background:"rgba(0, 0, 0, 0.7)"});fetch(this.$api.urls.POST_INSPECTIONSCORE_QUERYMAIN,{method:"post",headers:{"Content-type":"application/json"},credentials:"include",body:p()(e)}).then(function(a){return a.json()}).then(function(e){setTimeout(function(){t.close()},500),e.success?(a.pageData.tableObj.currentPage=e.model.currentPage,a.pageData.tableObj.pageSize=e.model.pageSize,a.pageData.tableObj.totalPage=e.model.pageCount,a.pageData.tableObj.totalRows=e.model.count,a.pageData.tableObj.list=e.model.data.map(function(e){return 0===e.status?e.statusName="失效":1===e.status&&(e.statusName="生效"),e.created=a.$api.dateFormat("yyyy-MM-dd",e.created),e})):a.$message.error(e.message)}).catch(function(e){setTimeout(function(){t.close()},500),a.$message.error("系统错误："+e)})},detailEvt:function(a,e){this.$router.push({name:"checkupDetailLink",query:{batch:e.row.batch,yearMonthStr:e.row.yearMonthStr,status:e.row.status,mainId:e.row.id}})},uploadEvt:function(){this.$router.push({name:"checkupUploadLink"})},handleSizeChange:function(a){this.pageData.tableObj.pageSize=a,this.queryEvt()},handleCurrentChange:function(a){this.pageData.tableObj.currentPage=a,this.queryEvt()}}},A={render:function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("el-main",[t("div",{staticClass:"container-fluid"},[t("el-breadcrumb",{staticClass:"breadcrumb",attrs:{"separator-class":"el-icon-arrow-right"}},[t("el-breadcrumb-item",{attrs:{to:{name:"homeLink"}}},[t("i",{staticClass:"glyphicon glyphicon-home"}),a._v("首页")]),a._v(" "),t("el-breadcrumb-item",[a._v("店铺管理")]),a._v(" "),t("el-breadcrumb-item",[a._v("巡检分数导入")])],1)],1),a._v(" "),t("div",{staticClass:"rtl-custom-box mt15"},[t("div",{staticClass:"box-hd"},[t("div",{staticClass:"cont"},[t("div",{staticClass:"form-horizontal"},[t("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0}},[t("el-row",[t("el-col",{attrs:{span:6}},[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("月份：")])]),a._v(" "),t("el-col",{attrs:{span:16}},[t("el-date-picker",{attrs:{"value-format":"yyyyMM",type:"month",placeholder:"请选择日期"},model:{value:a.pageData.tableObj.yearMonthStr,callback:function(e){a.$set(a.pageData.tableObj,"yearMonthStr",e)},expression:"pageData.tableObj.yearMonthStr"}})],1)],1),a._v(" "),t("el-col",{attrs:{span:6}},[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("状态：")])]),a._v(" "),t("el-col",{attrs:{span:16}},[t("el-form-item",[t("el-select",{model:{value:a.pageData.tableObj.status,callback:function(e){a.$set(a.pageData.tableObj,"status",e)},expression:"pageData.tableObj.status"}},a._l(a.pageData.statusList,function(a){return t("el-option",{key:a.value,attrs:{label:a.name,value:a.value}})}))],1)],1)],1),a._v(" "),t("el-col",{attrs:{span:12}},[t("el-col",{attrs:{span:4}},[t("label",{staticClass:"control-label"},[a._v("导入时间：")])]),a._v(" "),t("el-col",{attrs:{span:20}},[t("el-col",{attrs:{span:10}},[t("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",align:"right",type:"date",placeholder:"请选择日期"},model:{value:a.pageData.tableObj.startTime,callback:function(e){a.$set(a.pageData.tableObj,"startTime",e)},expression:"pageData.tableObj.startTime"}})],1),a._v(" "),t("el-col",{staticClass:"text-center",staticStyle:{"line-height":"40px"},attrs:{span:2}},[a._v("-")]),a._v(" "),t("el-col",{attrs:{span:10}},[t("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",align:"right",type:"date",placeholder:"请选择日期"},model:{value:a.pageData.tableObj.endTime,callback:function(e){a.$set(a.pageData.tableObj,"endTime",e)},expression:"pageData.tableObj.endTime"}})],1)],1)],1)],1),a._v(" "),t("el-row",[t("el-col",{staticClass:"text-center",attrs:{span:24}},[t("el-form-item",[t("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(e){return e.stopPropagation(),a.queryEvt(e)}}},[a._v("查询")])],1)],1)],1)],1)],1)])])]),a._v(" "),t("div",{staticClass:"box-bd pr mt15"},[t("div",{staticClass:"tab-content custom-content"},[t("div",{staticClass:"tab-pane in active"},[t("el-row",{staticClass:"mb10"},[t("el-col",{staticClass:"text-right",attrs:{span:24}},[t("el-button",{attrs:{type:"primary",plain:"",icon:"el-icon-upload"},on:{click:a.uploadEvt}},[a._v("导入")])],1)],1),a._v(" "),t("div",{staticClass:"table-responsive"},[t("el-table",{staticStyle:{width:"100%"},attrs:{border:"",data:a.pageData.tableObj.list}},[t("el-table-column",{attrs:{sortable:"",prop:"batch",label:"导入批次","min-width":"90"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"siteNum",label:"导入门店数","min-width":"110"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"yearMonthStr",label:"月份","min-width":"120"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"statusName",label:"状态","min-width":"120"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"created",label:"导入时间","min-width":"130"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"creatorName",label:"提交人","min-width":"110"}}),a._v(" "),t("el-table-column",{attrs:{fixed:"right",label:"操作","min-width":"100"},scopedSlots:a._u([{key:"default",fn:function(e){return[t("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){t.stopPropagation(),a.detailEvt(e.$index,e)}}},[a._v("查看详情")])]}}])})],1)],1),a._v(" "),t("div",{staticClass:"page"},[t("div",{staticClass:"block p15 text-center"},[t("el-pagination",{attrs:{"current-page":a.pageData.tableObj.currentPage,"page-sizes":a.pageData.tableObj.pageArray,"page-size":a.pageData.tableObj.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:a.pageData.tableObj.totalRows},on:{"size-change":a.handleSizeChange,"current-change":a.handleCurrentChange}})],1)])],1)])])])},staticRenderFns:[]},z={data:function(){return{pageData:{statusList:[{name:"全部",value:""},{name:"未提交",value:0},{name:"已提交",value:1},{name:"已审批",value:2}],tableObj:{batch:"",yearMonthStr:"",status:"",statusName:"",mainId:"",currentPage:1,pageSize:10,totalPage:1,totalRows:1,pageArray:[10,20,30,40,50],list:[]}}}},created:function(){},mounted:function(){this.initFunc()},methods:{initFunc:function(){this.paramEvt(),this.queryEvt()},paramEvt:function(){var a=this;this.pageData.statusList.forEach(function(e){a.$route.query.status==e.value&&(a.pageData.tableObj.statusName=e.name)}),this.pageData.tableObj.batch=this.$route.query.batch,this.pageData.tableObj.yearMonthStr=this.$route.query.yearMonthStr,this.pageData.tableObj.status=this.$route.query.status,this.pageData.tableObj.mainId=this.$route.query.mainId},queryEvt:function(){var a=this,e={mainId:this.pageData.tableObj.mainId,currentPage:this.pageData.tableObj.currentPage,pageSize:this.pageData.tableObj.pageSize},t=this.$loading({lock:!0,spinner:"wm-icon-loading",background:"rgba(0, 0, 0, 0.7)"});fetch(this.$api.urls.POST_INSPECTIONSCORE_QUERYITEM,{method:"post",headers:{"Content-type":"application/json"},credentials:"include",body:p()(e)}).then(function(a){return a.json()}).then(function(e){setTimeout(function(){t.close()},500),e.success?a.pageData.tableObj.list=e.model.map(function(e){return e.yearMonthStr=a.pageData.tableObj.yearMonthStr,e}):a.$message.error(e.message)}).catch(function(e){setTimeout(function(){t.close()},500),a.$message.error("系统错误："+e)})},handleSizeChange:function(a){this.pageData.tableObj.pageSize=a,this.queryEvt()},handleCurrentChange:function(a){this.pageData.tableObj.currentPage=a,this.queryEvt()}}},q={render:function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("el-main",[t("div",{staticClass:"container-fluid"},[t("el-breadcrumb",{staticClass:"breadcrumb",attrs:{"separator-class":"el-icon-arrow-right"}},[t("el-breadcrumb-item",{attrs:{to:{name:"homeLink"}}},[t("i",{staticClass:"glyphicon glyphicon-home"}),a._v("首页")]),a._v(" "),t("el-breadcrumb-item",[a._v("店铺管理")]),a._v(" "),t("el-breadcrumb-item",{attrs:{to:{name:"checkupLink"}}},[a._v("巡检分数导入")]),a._v(" "),t("el-breadcrumb-item",[a._v("导入数据查看")])],1)],1),a._v(" "),t("div",{staticClass:"rtl-custom-box mt15"},[t("div",{staticClass:"box-hd"},[t("div",{staticClass:"cont"},[t("div",{staticClass:"form-horizontal"},[t("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0}},[t("el-row",[t("el-col",{attrs:{span:6}},[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("导入批次：")])]),a._v(" "),t("el-col",{attrs:{span:16}},[t("el-form-item",[t("el-input",{attrs:{disabled:!0,placeholder:"请输入导入批次"},model:{value:a.pageData.tableObj.batch,callback:function(e){a.$set(a.pageData.tableObj,"batch",e)},expression:"pageData.tableObj.batch"}})],1)],1)],1),a._v(" "),t("el-col",{attrs:{span:6}},[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("月份：")])]),a._v(" "),t("el-col",{attrs:{span:16}},[t("el-date-picker",{attrs:{disabled:!0,"value-format":"yyyyMM",type:"month",placeholder:"请选择日期"},model:{value:a.pageData.tableObj.yearMonthStr,callback:function(e){a.$set(a.pageData.tableObj,"yearMonthStr",e)},expression:"pageData.tableObj.yearMonthStr"}})],1)],1),a._v(" "),t("el-col",{attrs:{span:6}},[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("状态：")])]),a._v(" "),t("el-col",{attrs:{span:16}},[t("el-form-item",[t("el-input",{attrs:{disabled:!0},model:{value:a.pageData.tableObj.statusName,callback:function(e){a.$set(a.pageData.tableObj,"statusName",e)},expression:"pageData.tableObj.statusName"}})],1)],1)],1)],1)],1)],1)])])]),a._v(" "),t("div",{staticClass:"box-bd pr mt15"},[t("div",{staticClass:"tab-content custom-content"},[t("div",{staticClass:"tab-pane in active"},[t("div",{staticClass:"table-responsive"},[t("el-table",{staticStyle:{width:"100%"},attrs:{border:"",data:a.pageData.tableObj.list}},[t("el-table-column",{attrs:{sortable:"",prop:"siteNo",label:"门店号","min-width":"110"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"siteName",label:"门店名称","min-width":"120"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"yearMonthStr",label:"月份","min-width":"120"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"score",label:"分数","min-width":"130"}})],1)],1)])])]),a._v(" "),t("el-row",{staticClass:"mb10"},[t("el-col",{staticClass:"text-center",attrs:{span:24}},[t("router-link",{attrs:{to:{name:"checkupLink"}}},[t("el-button",{attrs:{type:"danger",icon:"el-icon-circle-close-outline"}},[a._v("关闭")])],1)],1)],1)],1)},staticRenderFns:[]},U={data:function(){return{fileList:[],fileAction:"",pageData:{tableObj:{list:[]}}}},created:function(){this.fileAction=this.$api.urls.POST_INSPECTIONSCORE_UPLOADFILE},methods:{downloadEvt:function(){window.location.href="./static/file/导入模板.csv"},handleExceed:function(a,e){this.$message.warning("您只能选择一个文件!")},submitUpload:function(){var a=new FormData,e=this.$refs.upload.uploadFiles[0].raw;a.append("filedata",e),this.beforeAvatarUpload(e)?this.handleChange(a):this.$refs.upload.uploadFiles=[]},handleRemove:function(a,e){console.log(a,e)},handlePreview:function(a){console.log(a)},handleChange:function(a){var e=this,t=this.$loading({lock:!0,spinner:"wm-icon-loading",background:"rgba(0, 0, 0, 0.7)"});fetch(this.$api.urls.POST_INSPECTIONSCORE_UPLOADFILE,{method:"POST",credentials:"include",body:a}).then(function(a){return a.json()}).then(function(a){setTimeout(function(){t.close()},500),a.success?e.pageData.tableObj.list=a.model.map(function(a){return a.yearMonthStr=e.$api.monthFormat(a.yearMonthStr),a.created=e.$api.dateFormat("yyyy-MM-dd",a.created),a}):e.$message.error(a.message)}).catch(function(a){setTimeout(function(){t.close()},500),e.$message.error("系统错误："+a)})},beforeAvatarUpload:function(a){var e=new Array,t="csv"===(e=a.name.split("."))[e.length-1],l=a.size/1024/1024<10;return t||this.$message({message:"上传模板只能是csv格式!",type:"warning"}),l||this.$message({message:"上传模板大小不能超过 10MB!",type:"warning"}),t&&l}}},Y={render:function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("el-main",[t("div",{staticClass:"container-fluid"},[t("el-breadcrumb",{staticClass:"breadcrumb",attrs:{"separator-class":"el-icon-arrow-right"}},[t("el-breadcrumb-item",{attrs:{to:{name:"homeLink"}}},[t("i",{staticClass:"glyphicon glyphicon-home"}),a._v("首页")]),a._v(" "),t("el-breadcrumb-item",[a._v("店铺管理")]),a._v(" "),t("el-breadcrumb-item",{attrs:{to:{name:"checkupLink"}}},[a._v("巡检分数导入")]),a._v(" "),t("el-breadcrumb-item",[a._v("文件上传")])],1)],1),a._v(" "),t("div",{staticClass:"rtl-custom-box mt15"},[t("div",{staticClass:"box-hd"},[t("div",{staticClass:"cont"},[t("div",{staticClass:"form-horizontal"},[t("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0}},[t("el-row",[t("el-col",{attrs:{span:24}},[t("el-col",{attrs:{span:2}},[t("label",{staticClass:"control-label"},[a._v("模板下载：")])]),a._v(" "),t("el-col",{attrs:{span:22}},[t("el-form-item",[t("el-button",{attrs:{type:"text"},on:{click:a.downloadEvt}},[a._v("巡检分数导入模板.csv")])],1)],1)],1)],1),a._v(" "),t("el-row",[t("el-col",{attrs:{span:24}},[t("el-col",{attrs:{span:2}},[t("label",{staticClass:"control-label"},[a._v("数据导入：")])]),a._v(" "),t("el-col",{attrs:{span:22}},[t("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{action:a.fileAction,limit:1,"on-exceed":a.handleExceed,"file-list":a.fileList,"auto-upload":!1}},[t("el-button",{attrs:{slot:"trigger",size:"small",type:"primary",icon:"el-icon-upload2"},slot:"trigger"},[a._v("选取文件")]),a._v(" "),t("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small",type:"success"},on:{click:a.submitUpload}},[a._v("上传到服务器")]),a._v(" "),t("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[a._v("支持扩展名：.csv，大小不超过50MB")])],1)],1)],1)],1)],1)],1)])])]),a._v(" "),t("div",{staticClass:"box-bd pr mt15"},[t("div",{staticClass:"tab-content custom-content"},[t("div",{staticClass:"tab-pane in active"},[t("div",{staticClass:"table-responsive"},[t("el-table",{staticStyle:{width:"100%"},attrs:{border:"",data:a.pageData.tableObj.list}},[t("el-table-column",{attrs:{sortable:"",prop:"no",label:"序号","min-width":"90"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"siteNo",label:"门店号","min-width":"110"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"siteName",label:"门店名称","min-width":"120"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"yearMonthStr",label:"月份","min-width":"120"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"score",label:"分数","min-width":"130"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"created",label:"导入时间","min-width":"110"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"creatorName",label:"导入人","min-width":"110"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"desc",label:"导入结果","min-width":"110"}})],1)],1)])])])])},staticRenderFns:[]};var V={data:function(){return{pageData:{statusList:[{name:"全部",value:""},{name:"已导入",value:2},{name:"可修改",value:3},{name:"已关闭",value:4}],tableObj:{siteNo:"",siteName:"",yearmon:"",status:"",startTime:"",endTime:"",pageSize:10,currentPage:1,totalPage:1,totalRows:1,pageArray:[10,20,30,40,50],list:[]}}}},created:function(){this.initFunc()},methods:{initFunc:function(){this.commonInfo()},commonInfo:function(){var a=this,e=this.$loading({lock:!0,spinner:"wm-icon-loading",background:"rgba(0, 0, 0, 0.7)"});fetch(this.$api.urls.POST_QUERYCOMMONINFO,{method:"post",headers:{"Content-type":"application/json"},credentials:"include",body:p()({})}).then(function(a){return a.json()}).then(function(t){setTimeout(function(){e.close()},500),t.success?(a.pageData.tableObj.mandt=t.model.mandt,a.pageData.tableObj.siteNo=t.model.siteNo,a.pageData.tableObj.siteName=t.model.siteName,a.queryEvt()):a.$message.error(t.message)}).catch(function(t){setTimeout(function(){e.close()},500),a.$message.error("错误："+t)})},queryEvt:function(){var a=this,e={siteNo:this.pageData.tableObj.siteNo,yearMonthStr:this.pageData.tableObj.yearMonthStr,status:this.pageData.tableObj.status,startTime:this.pageData.tableObj.startTime,endTime:this.pageData.tableObj.endTime,currentPage:this.pageData.tableObj.currentPage,pageSize:this.pageData.tableObj.pageSize};if(this.$api.compareDate(e.startTime,e.endTime))return this.$message({message:"开始时间不能大于结束时间!",type:"warning"}),!1;var t=this.$loading({lock:!0,spinner:"wm-icon-loading",background:"rgba(0, 0, 0, 0.7)"});fetch(this.$api.urls.POST_ALLOWANCE_QUERYMAIN,{method:"post",headers:{"Content-type":"application/json"},credentials:"include",body:p()(e)}).then(function(a){return a.json()}).then(function(e){setTimeout(function(){t.close()},500),e.success?(a.pageData.tableObj.currentPage=e.model.currentPage,a.pageData.tableObj.pageSize=e.model.pageSize,a.pageData.tableObj.totalPage=e.model.pageCount,a.pageData.tableObj.totalRows=e.model.count,a.pageData.tableObj.list=e.model.data.map(function(e){return a.pageData.statusList.find(function(a){if(e.status==a.value)return e.statusName=a.name}),e.siteNo=a.pageData.tableObj.siteNo,e.siteName=a.pageData.tableObj.siteName,e.created=a.$api.dateFormat("yyyy-MM-dd",e.created),e})):a.$message.error(e.message)}).catch(function(e){setTimeout(function(){t.close()},500),a.$message.error("系统错误："+e)})},detailEvt:function(a,e){this.$router.push({name:"allowanceConfirmUploadLink",query:{siteNo:e.row.siteNo,yearmon:e.row.yearmon,status:e.row.status,mainId:e.row.id}})},handleSizeChange:function(a){this.pageData.tableObj.pageSize=a,this.queryEvt()},handleCurrentChange:function(a){this.pageData.tableObj.currentPage=a,this.queryEvt()}}},Q={render:function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("el-main",[t("div",{staticClass:"container-fluid"},[t("el-breadcrumb",{staticClass:"breadcrumb",attrs:{"separator-class":"el-icon-arrow-right"}},[t("el-breadcrumb-item",{attrs:{to:{name:"homeLink"}}},[t("i",{staticClass:"glyphicon glyphicon-home"}),a._v("首页")]),a._v(" "),t("el-breadcrumb-item",[a._v("店铺管理")]),a._v(" "),t("el-breadcrumb-item",[a._v("门店津贴确认")])],1)],1),a._v(" "),t("div",{staticClass:"rtl-custom-box mt15"},[t("div",{staticClass:"box-hd"},[t("div",{staticClass:"cont"},[t("div",{staticClass:"form-horizontal"},[t("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0}},[t("el-row",[t("el-col",{attrs:{span:6}},[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("门店：")])]),a._v(" "),t("el-col",{attrs:{span:16}},[t("el-form-item",[t("el-input",{attrs:{disabled:!0,placeholder:"请输入门店编号",clearable:""},model:{value:a.pageData.tableObj.siteNo,callback:function(e){a.$set(a.pageData.tableObj,"siteNo",e)},expression:"pageData.tableObj.siteNo"}})],1)],1)],1),a._v(" "),t("el-col",{attrs:{span:6}},[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("状态：")])]),a._v(" "),t("el-col",{attrs:{span:16}},[t("el-form-item",[t("el-select",{model:{value:a.pageData.tableObj.status,callback:function(e){a.$set(a.pageData.tableObj,"status",e)},expression:"pageData.tableObj.status"}},a._l(a.pageData.statusList,function(a){return t("el-option",{key:a.value,attrs:{label:a.name,value:a.value}})}))],1)],1)],1),a._v(" "),t("el-col",{attrs:{span:12}},[t("el-col",{attrs:{span:4}},[t("label",{staticClass:"control-label"},[a._v("提交时间：")])]),a._v(" "),t("el-col",{attrs:{span:20}},[t("el-col",{attrs:{span:10}},[t("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",align:"right",type:"date",placeholder:"请选择日期"},model:{value:a.pageData.tableObj.startTime,callback:function(e){a.$set(a.pageData.tableObj,"startTime",e)},expression:"pageData.tableObj.startTime"}})],1),a._v(" "),t("el-col",{staticClass:"text-center",staticStyle:{"line-height":"40px"},attrs:{span:2}},[a._v("-")]),a._v(" "),t("el-col",{attrs:{span:10}},[t("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",align:"right",type:"date",placeholder:"请选择日期"},model:{value:a.pageData.tableObj.endTime,callback:function(e){a.$set(a.pageData.tableObj,"endTime",e)},expression:"pageData.tableObj.endTime"}})],1)],1)],1)],1),a._v(" "),t("el-row",[t("el-col",{attrs:{span:6}},[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("月份：")])]),a._v(" "),t("el-col",{attrs:{span:16}},[t("el-date-picker",{attrs:{"value-format":"yyyyMM",type:"month",placeholder:"请选择日期"},model:{value:a.pageData.tableObj.yearmon,callback:function(e){a.$set(a.pageData.tableObj,"yearmon",e)},expression:"pageData.tableObj.yearmon"}})],1)],1),a._v(" "),t("el-col",{staticClass:"text-center",attrs:{span:6}},[t("el-form-item",[t("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(e){return e.stopPropagation(),a.queryEvt(e)}}},[a._v("查询")])],1)],1)],1)],1)],1)])])]),a._v(" "),t("div",{staticClass:"box-bd pr mt15"},[t("div",{staticClass:"tab-content custom-content"},[t("div",{staticClass:"tab-pane in active"},[t("div",{staticClass:"table-responsive"},[t("el-table",{staticStyle:{width:"100%"},attrs:{border:"",data:a.pageData.tableObj.list}},[t("el-table-column",{attrs:{sortable:"",prop:"siteNo",label:"门店号","min-width":"90"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"siteName",label:"门店名称","min-width":"110"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"yearmon",label:"月份","min-width":"110"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"personNmu",label:"导入人数","min-width":"120"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"statusName",label:"状态","min-width":"120"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"created",label:"提交时间","min-width":"130"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"creator",label:"导入人","min-width":"110"}}),a._v(" "),t("el-table-column",{attrs:{fixed:"right",label:"操作","min-width":"100"},scopedSlots:a._u([{key:"default",fn:function(e){return[t("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){t.stopPropagation(),a.detailEvt(e.$index,e)}}},[a._v("查看详情")])]}}])})],1)],1),a._v(" "),t("div",{staticClass:"page"},[t("div",{staticClass:"block p15 text-center"},[t("el-pagination",{attrs:{"current-page":a.pageData.tableObj.currentPage,"page-sizes":a.pageData.tableObj.pageArray,"page-size":a.pageData.tableObj.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:a.pageData.tableObj.totalRows},on:{"size-change":a.handleSizeChange,"current-change":a.handleCurrentChange}})],1)])])])])])},staticRenderFns:[]},H={data:function(){return{pageData:{isDetail:!1,statusList:[{name:"全部",value:""},{name:"已导入",value:2},{name:"可修改",value:3},{name:"已关闭",value:4}],tableObj:{mainId:"",siteNo:"",yearMonthStr:"",status:"",currentPage:1,pageSize:10,totalPage:1,totalRows:1,pageArray:[10,20,30,40,50],list:[]}}}},mounted:function(){this.initFunc()},methods:{initFunc:function(){var a=this;this.pageData.tableObj.mainId=this.$route.query.mainId,this.pageData.tableObj.siteNo=this.$route.query.siteNo,this.pageData.tableObj.yearmon=this.$route.query.yearmon;var e=this.pageData.statusList.find(function(e){return e.value==a.$route.query.status});this.pageData.tableObj.status=e.name,this.queryEvt()},queryEvt:function(){var a=this,e={mainId:this.pageData.tableObj.mainId},t=this.$loading({lock:!0,spinner:"wm-icon-loading",background:"rgba(0, 0, 0, 0.7)"});fetch(this.$api.urls.POST_ALLOWANCE_QUERYITEM,{method:"post",headers:{"Content-type":"application/json"},credentials:"include",body:p()(e)}).then(function(a){return a.json()}).then(function(e){setTimeout(function(){t.close()},500),e.success?(a.pageData.tableObj.currentPage=e.model.currentPage,a.pageData.tableObj.pageSize=e.model.pageSize,a.pageData.tableObj.totalPage=e.model.pageCount,a.pageData.tableObj.totalRows=e.model.count,a.pageData.tableObj.list=e.model.map(function(e){return e.entryTime=a.$api.dateFormat("yyyy-MM-dd",e.entryTime),e})):a.$message.error(e.message)}).catch(function(e){setTimeout(function(){t.close()},500),a.$message.error("系统错误："+e)})},updateEvt:function(){var a=this,e=this.pageData.tableObj.list.map(function(a){return{id:a.id,issuedAllowance:a.issuedAllowance,adjustmentAllowance:a.adjustmentAllowance,adjustmentReason:a.adjustmentReason}}),t={ok:!1,msg:""};if(e.some(function(a){if(""!==a.adjustmentAllowance||""!==a.adjustmentReason){if(""===a.adjustmentAllowance)return t={ok:!0,msg:"调整后津贴不能为空"},!0;if(!/^(([1-9][0-9]*\.[0-9][0-9]*)|([0]\.[0-9][0-9]*)|([1-9][0-9]*)|([0]{1}))$/.test(a.adjustmentAllowance))return t={ok:!0,msg:"调整后津贴必须是正数"},!0;if(""===a.adjustmentReason)return t={ok:!0,msg:"调整原因不能为空"},!0}}),t.ok)return this.$message({dangerouslyUseHTMLString:!0,message:"<h5>"+t.msg+"</h5><p>如您填写了（调整后津贴、调整原因）,必须一行填写完成!</p>",type:"warning"}),!1;var l=this.$loading({lock:!0,spinner:"wm-icon-loading",background:"rgba(0, 0, 0, 0.7)"});fetch(this.$api.urls.POST_ALLOWANCE_ADJUSTMENT,{method:"post",headers:{"Content-type":"application/json"},credentials:"include",body:p()(e)}).then(function(a){return a.json()}).then(function(e){setTimeout(function(){l.close()},500),e.success?a.$alert("提交成功","提示",{center:!0,dangerouslyUseHTMLString:!0,callback:function(e){a.$router.push({name:"allowanceConfirmIndexLink"})}}):a.$message.error(e.message)}).catch(function(e){setTimeout(function(){l.close()},500),a.$message.error("系统错误："+e)})}}},B={render:function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("el-main",[t("div",{staticClass:"container-fluid"},[t("el-breadcrumb",{staticClass:"breadcrumb",attrs:{"separator-class":"el-icon-arrow-right"}},[t("el-breadcrumb-item",{attrs:{to:{name:"homeLink"}}},[t("i",{staticClass:"glyphicon glyphicon-home"}),a._v("首页")]),a._v(" "),t("el-breadcrumb-item",[a._v("店铺管理")]),a._v(" "),t("el-breadcrumb-item",{attrs:{to:{name:"allowanceConfirmIndexLink"}}},[a._v("门店津贴确认")]),a._v(" "),t("el-breadcrumb-item",[a._v("津贴分配确认")])],1)],1),a._v(" "),t("div",{staticClass:"rtl-custom-box mt15"},[t("div",{staticClass:"box-hd"},[t("div",{staticClass:"cont"},[t("div",{staticClass:"form-horizontal"},[t("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0}},[t("el-row",[t("el-col",{attrs:{span:6}},[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("门店：")])]),a._v(" "),t("el-col",{attrs:{span:16}},[t("el-form-item",[t("el-input",{attrs:{disabled:!0,placeholder:"请输入门店编号"},model:{value:a.pageData.tableObj.siteNo,callback:function(e){a.$set(a.pageData.tableObj,"siteNo",e)},expression:"pageData.tableObj.siteNo"}})],1)],1)],1),a._v(" "),t("el-col",{attrs:{span:6}},[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("月份：")])]),a._v(" "),t("el-col",{attrs:{span:16}},[t("el-date-picker",{attrs:{disabled:!0,"value-format":"yyyyMM",type:"month",placeholder:"请选择日期"},model:{value:a.pageData.tableObj.yearMonthStr,callback:function(e){a.$set(a.pageData.tableObj,"yearMonthStr",e)},expression:"pageData.tableObj.yearMonthStr"}})],1)],1),a._v(" "),t("el-col",{attrs:{span:6}},[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("状态：")])]),a._v(" "),t("el-col",{attrs:{span:16}},[t("el-form-item",[t("el-input",{attrs:{disabled:!0},model:{value:a.pageData.tableObj.status,callback:function(e){a.$set(a.pageData.tableObj,"status",e)},expression:"pageData.tableObj.status"}})],1)],1)],1)],1)],1)],1)])])]),a._v(" "),t("div",{staticClass:"box-bd pr mt15"},[t("div",{staticClass:"tab-content custom-content"},[t("div",{staticClass:"tab-pane in active"},[t("div",{staticClass:"table-responsive"},[t("el-table",{staticStyle:{width:"100%"},attrs:{border:"",data:a.pageData.tableObj.list}},[t("el-table-column",{attrs:{sortable:"",prop:"yearmon",label:"月份","min-width":"90"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"employeeNo",label:"工号","min-width":"110"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"employeeName",label:"员工姓名","min-width":"120"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"organzationName",label:"组织名称","min-width":"120"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"postName",label:"岗位名称","min-width":"120"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"finalScore",label:"月评分数","min-width":"120"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"allowance",label:"津贴总额","min-width":"120"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"allowanceRate",label:"津贴分配比例","min-width":"120"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"issuedAllowance",label:"应发津贴","min-width":"120"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",label:"调整后津贴","min-width":"120",fixed:"right"},scopedSlots:a._u([{key:"default",fn:function(e){return[t("el-input",{attrs:{maxlength:8,placeholder:"请输入调整后津贴",clearable:""},model:{value:e.row.adjustmentAllowance,callback:function(t){a.$set(e.row,"adjustmentAllowance",t)},expression:"scope.row.adjustmentAllowance"}})]}}])}),a._v(" "),t("el-table-column",{attrs:{sortable:"",label:"调整原因","min-width":"180",fixed:"right"},scopedSlots:a._u([{key:"default",fn:function(e){return[t("el-input",{attrs:{maxlength:200,placeholder:"请输入调整原因",clearable:""},model:{value:e.row.adjustmentReason,callback:function(t){a.$set(e.row,"adjustmentReason",t)},expression:"scope.row.adjustmentReason"}})]}}])})],1)],1)])])]),a._v(" "),t("el-row",{staticClass:"mb10"},[t("el-col",{staticClass:"text-center",attrs:{span:24}},[t("el-button",{attrs:{type:"success",icon:"el-icon-edit-outline"},on:{click:function(e){return e.stopPropagation(),a.updateEvt(e)}}},[a._v("提交")]),a._v(" "),t("router-link",{attrs:{to:{name:"allowanceConfirmIndexLink"}}},[t("el-button",{attrs:{type:"danger",icon:"el-icon-circle-close-outline"}},[a._v("取消")])],1)],1)],1)],1)},staticRenderFns:[]},W={data:function(){return{pageData:{statusList:[{name:"全部",value:""},{name:"已导入",value:2},{name:"可修改",value:3},{name:"已关闭",value:4}],tableObj:{yearmon:"",status:"",startTime:"",endTime:"",pageSize:10,currentPage:1,totalPage:1,totalRows:1,pageArray:[10,20,30,40,50],list:[]}}}},created:function(){this.initFunc()},methods:{initFunc:function(){this.queryEvt()},queryEvt:function(){var a=this,e={yearmon:this.pageData.tableObj.yearmon,status:this.pageData.tableObj.status,startTime:this.pageData.tableObj.startTime,endTime:this.pageData.tableObj.endTime,currentPage:this.pageData.tableObj.currentPage,pageSize:this.pageData.tableObj.pageSize};if(this.$api.compareDate(e.startTime,e.endTime))return this.$message({message:"开始时间不能大于结束时间!",type:"warning"}),!1;var t=this.$loading({lock:!0,spinner:"wm-icon-loading",background:"rgba(0, 0, 0, 0.7)"});fetch(this.$api.urls.POST_ALLOWANCE_QUERYMAIN,{method:"post",headers:{"Content-type":"application/json"},credentials:"include",body:p()(e)}).then(function(a){return a.json()}).then(function(e){if(setTimeout(function(){t.close()},500),e.success){a.pageData.tableObj.currentPage=e.model.currentPage,a.pageData.tableObj.pageSize=e.model.pageSize,a.pageData.tableObj.totalPage=e.model.pageCount,a.pageData.tableObj.totalRows=e.model.count;var l=a.pageData.statusList;a.pageData.tableObj.list=e.model.data.map(function(e){return l.forEach(function(a){e.status==a.value&&(e.statusName=a.name)}),e.created=a.$api.dateFormat("yyyy-MM-dd",e.created),e})}else a.$message.error(e.message)}).catch(function(e){setTimeout(function(){t.close()},500),a.$message.error("系统错误："+e)})},downScoreEvt:function(){var a={yearmon:this.pageData.tableObj.yearmon,status:this.pageData.tableObj.status,startTime:this.pageData.tableObj.startTime,endTime:this.pageData.tableObj.endTime};if(""==a.yearMonthStr)return this.$message.error("请选择月份"),!1;window.open("/wumart/partner/allowance/downScore?yearmon="+a.yearmon+"&status="+a.status+"&startTime="+a.startTime+"&endTime="+a.endTime)},detailEvt:function(a,e){this.$router.push({name:"allowanceImportDetailLink",query:{inputBatch:e.row.inputBatch,yearmon:e.row.yearmon,status:e.row.status,mainId:e.row.id}})},uploadEvt:function(){this.$router.push({name:"allowanceImportUploadLink"})},handleSizeChange:function(a){this.pageData.tableObj.pageSize=a,this.queryEvt()},handleCurrentChange:function(a){this.pageData.tableObj.currentPage=a,this.queryEvt()}}},G={render:function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("el-main",[t("div",{staticClass:"container-fluid"},[t("el-breadcrumb",{staticClass:"breadcrumb",attrs:{"separator-class":"el-icon-arrow-right"}},[t("el-breadcrumb-item",{attrs:{to:{name:"homeLink"}}},[t("i",{staticClass:"glyphicon glyphicon-home"}),a._v("首页")]),a._v(" "),t("el-breadcrumb-item",[a._v("店铺管理")]),a._v(" "),t("el-breadcrumb-item",[a._v("门店津贴导入")])],1)],1),a._v(" "),t("div",{staticClass:"rtl-custom-box mt15"},[t("div",{staticClass:"box-hd"},[t("div",{staticClass:"cont"},[t("div",{staticClass:"form-horizontal"},[t("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0}},[t("el-row",[t("el-col",{attrs:{span:6}},[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("月份：")])]),a._v(" "),t("el-col",{attrs:{span:16}},[t("el-date-picker",{attrs:{"value-format":"yyyyMM",type:"month",placeholder:"请选择日期"},model:{value:a.pageData.tableObj.yearmon,callback:function(e){a.$set(a.pageData.tableObj,"yearmon",e)},expression:"pageData.tableObj.yearmon"}})],1)],1),a._v(" "),t("el-col",{attrs:{span:6}},[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("状态：")])]),a._v(" "),t("el-col",{attrs:{span:16}},[t("el-form-item",[t("el-select",{model:{value:a.pageData.tableObj.status,callback:function(e){a.$set(a.pageData.tableObj,"status",e)},expression:"pageData.tableObj.status"}},a._l(a.pageData.statusList,function(a){return t("el-option",{key:a.value,attrs:{label:a.name,value:a.value}})}))],1)],1)],1),a._v(" "),t("el-col",{attrs:{span:12}},[t("el-col",{attrs:{span:4}},[t("label",{staticClass:"control-label"},[a._v("导入时间：")])]),a._v(" "),t("el-col",{attrs:{span:20}},[t("el-col",{attrs:{span:10}},[t("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",align:"right",type:"date",placeholder:"请选择日期"},model:{value:a.pageData.tableObj.startTime,callback:function(e){a.$set(a.pageData.tableObj,"startTime",e)},expression:"pageData.tableObj.startTime"}})],1),a._v(" "),t("el-col",{staticClass:"text-center",staticStyle:{"line-height":"40px"},attrs:{span:2}},[a._v("-")]),a._v(" "),t("el-col",{attrs:{span:10}},[t("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",align:"right",type:"date",placeholder:"请选择日期"},model:{value:a.pageData.tableObj.endTime,callback:function(e){a.$set(a.pageData.tableObj,"endTime",e)},expression:"pageData.tableObj.endTime"}})],1)],1)],1)],1),a._v(" "),t("el-row",[t("el-col",{staticClass:"text-center",attrs:{span:24}},[t("el-form-item",[t("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(e){return e.stopPropagation(),a.queryEvt(e)}}},[a._v("查询")])],1)],1)],1)],1)],1)])])]),a._v(" "),t("div",{staticClass:"box-bd pr mt15"},[t("div",{staticClass:"tab-content custom-content"},[t("div",{staticClass:"tab-pane in active"},[t("el-row",{staticClass:"mb10"},[t("el-col",{staticClass:"text-right",attrs:{span:24}},[t("el-button",{attrs:{type:"primary",plain:"",icon:"el-icon-upload2"},on:{click:a.uploadEvt}},[a._v("导入")]),a._v(" "),t("el-button",{attrs:{type:"primary",plain:"",icon:"el-icon-download"},on:{click:a.downScoreEvt}},[a._v("导出")])],1)],1),a._v(" "),t("div",{staticClass:"table-responsive"},[t("el-table",{staticStyle:{width:"100%"},attrs:{border:"",data:a.pageData.tableObj.list}},[t("el-table-column",{attrs:{sortable:"",prop:"inputBatch",label:"导入批次","min-width":"90"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"siteAmount",label:"导入门店数","min-width":"110"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"yearmon",label:"月份","min-width":"120"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"statusName",label:"状态","min-width":"120"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"created",label:"导入时间","min-width":"130"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"creator",label:"提交人","min-width":"110"}}),a._v(" "),t("el-table-column",{attrs:{fixed:"right",label:"操作","min-width":"100"},scopedSlots:a._u([{key:"default",fn:function(e){return[t("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){t.stopPropagation(),a.detailEvt(e.$index,e)}}},[a._v("查看详情")])]}}])})],1)],1),a._v(" "),t("div",{staticClass:"page"},[t("div",{staticClass:"block p15 text-center"},[t("el-pagination",{attrs:{"current-page":a.pageData.tableObj.currentPage,"page-sizes":a.pageData.tableObj.pageArray,"page-size":a.pageData.tableObj.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:a.pageData.tableObj.totalRows},on:{"size-change":a.handleSizeChange,"current-change":a.handleCurrentChange}})],1)])],1)])])])},staticRenderFns:[]},J={data:function(){return{pageData:{statusList:[{name:"全部",value:""},{name:"已导入",value:2},{name:"可修改",value:3},{name:"已关闭",value:4}],tableObj:{batch:"",yearMonthStr:"",status:"",statusName:"",mainId:"",currentPage:1,pageSize:10,totalPage:1,totalRows:1,pageArray:[10,20,30,40,50],list:[]}}}},created:function(){this.initFunc()},mounted:function(){},methods:{initFunc:function(){this.paramEvt(),this.queryEvt()},paramEvt:function(){var a=this;this.pageData.statusList.forEach(function(e){a.$route.query.status==e.value&&(a.pageData.tableObj.statusName=e.name)}),this.pageData.tableObj.inputBatch=this.$route.query.inputBatch,this.pageData.tableObj.yearmon=this.$route.query.yearmon,this.pageData.tableObj.status=this.$route.query.status,this.pageData.tableObj.mainId=this.$route.query.mainId},queryEvt:function(){var a=this,e={mainId:this.pageData.tableObj.mainId},t=this.$loading({lock:!0,spinner:"wm-icon-loading",background:"rgba(0, 0, 0, 0.7)"});fetch(this.$api.urls.POST_ALLOWANCE_QUERYITEM,{method:"post",headers:{"Content-type":"application/json"},credentials:"include",body:p()(e)}).then(function(a){return a.json()}).then(function(e){setTimeout(function(){t.close()},500),e.success?a.pageData.tableObj.list=e.model.map(function(e){return e.yearMonthStr=a.pageData.tableObj.yearMonthStr,e}):a.$message.error(e.message)}).catch(function(e){setTimeout(function(){t.close()},500),a.$message.error("系统错误："+e)})},handleSizeChange:function(a){this.pageData.tableObj.pageSize=a,this.queryEvt()},handleCurrentChange:function(a){this.pageData.tableObj.currentPage=a,this.queryEvt()}}},K={render:function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("el-main",[t("div",{staticClass:"container-fluid"},[t("el-breadcrumb",{staticClass:"breadcrumb",attrs:{"separator-class":"el-icon-arrow-right"}},[t("el-breadcrumb-item",{attrs:{to:{name:"homeLink"}}},[t("i",{staticClass:"glyphicon glyphicon-home"}),a._v("首页")]),a._v(" "),t("el-breadcrumb-item",[a._v("店铺管理")]),a._v(" "),t("el-breadcrumb-item",{attrs:{to:{name:"allowanceImportIndexLink"}}},[a._v("门店津贴导入")]),a._v(" "),t("el-breadcrumb-item",[a._v("导入数据查看")])],1)],1),a._v(" "),t("div",{staticClass:"rtl-custom-box mt15"},[t("div",{staticClass:"box-hd"},[t("div",{staticClass:"cont"},[t("div",{staticClass:"form-horizontal"},[t("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0}},[t("el-row",[t("el-col",{attrs:{span:6}},[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("导入批次：")])]),a._v(" "),t("el-col",{attrs:{span:16}},[t("el-form-item",[t("el-input",{attrs:{disabled:!0,placeholder:"请输入导入批次"},model:{value:a.pageData.tableObj.inputBatch,callback:function(e){a.$set(a.pageData.tableObj,"inputBatch",e)},expression:"pageData.tableObj.inputBatch"}})],1)],1)],1),a._v(" "),t("el-col",{attrs:{span:6}},[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("月份：")])]),a._v(" "),t("el-col",{attrs:{span:16}},[t("el-date-picker",{attrs:{disabled:!0,"value-format":"yyyyMM",type:"month",placeholder:"请选择日期"},model:{value:a.pageData.tableObj.yearmon,callback:function(e){a.$set(a.pageData.tableObj,"yearmon",e)},expression:"pageData.tableObj.yearmon"}})],1)],1),a._v(" "),t("el-col",{attrs:{span:6}},[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("状态：")])]),a._v(" "),t("el-col",{attrs:{span:16}},[t("el-form-item",[t("el-input",{attrs:{disabled:!0},model:{value:a.pageData.tableObj.statusName,callback:function(e){a.$set(a.pageData.tableObj,"statusName",e)},expression:"pageData.tableObj.statusName"}})],1)],1)],1)],1)],1)],1)])])]),a._v(" "),t("div",{staticClass:"box-bd pr mt15"},[t("div",{staticClass:"tab-content custom-content"},[t("div",{staticClass:"tab-pane in active"},[t("div",{staticClass:"table-responsive"},[t("el-table",{staticStyle:{width:"100%"},attrs:{border:"",data:a.pageData.tableObj.list}},[t("el-table-column",{attrs:{sortable:"",prop:"yearMonthStr",label:"月份","min-width":"120"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"employeeNo",label:"工号","min-width":"120"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"employeeName",label:"员工姓名","min-width":"120"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"siteNo",label:"店号","min-width":"120"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"siteName",label:"店铺姓名","min-width":"120"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"employeeSubGroup",label:"员工子组","min-width":"120"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"entryTime",label:"入职日期","min-width":"120"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"organzationName",label:"组织名称","min-width":"120"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"postName",label:"岗位姓名","min-width":"120"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"finalScore",label:"月评分数","min-width":"120"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"allowance",label:"津贴总额","min-width":"120"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"allowanceRate",label:"津贴分配比例","min-width":"150"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"issuedAllowance",label:"应发津贴","min-width":"120"}})],1)],1)])])])])},staticRenderFns:[]},X={data:function(){return{fileList:[],fileAction:"",pageData:{tableObj:{list:[]}}}},created:function(){this.fileAction=this.$api.urls.POST_INSPECTIONSCORE_UPLOADFILE},methods:{downloadEvt:function(){window.location.href="./static/file/门店津贴导入.csv"},handleExceed:function(a,e){this.$message.warning("您只能选择一个文件!")},submitUpload:function(){var a=new FormData,e=this.$refs.upload.uploadFiles[0].raw;a.append("filedata",e),this.beforeAvatarUpload(e)?this.handleChange(a):this.$refs.upload.uploadFiles=[]},handleRemove:function(a,e){console.log(a,e)},handlePreview:function(a){console.log(a)},handleChange:function(a){var e=this,t=this.$loading({lock:!0,spinner:"wm-icon-loading",background:"rgba(0, 0, 0, 0.7)"});fetch(this.$api.urls.POST_ALLOWANCE_UPLOADFILE,{method:"POST",credentials:"include",body:a}).then(function(a){return a.json()}).then(function(a){setTimeout(function(){t.close()},500),a.success?e.pageData.tableObj.list=a.model.map(function(a){return a.yearMonthStr=e.$api.monthFormat(a.yearMonthStr),a.created=e.$api.dateFormat("yyyy-MM-dd",a.created),a}):e.$message.error(a.message)}).catch(function(a){setTimeout(function(){t.close()},500),e.$message.error("系统错误："+a)})},beforeAvatarUpload:function(a){var e=new Array,t="csv"===(e=a.name.split("."))[e.length-1],l=a.size/1024/1024<10;return t||this.$message({message:"上传模板只能是csv格式!",type:"warning"}),l||this.$message({message:"上传模板大小不能超过 10MB!",type:"warning"}),t&&l}}},Z={render:function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("el-main",[t("div",{staticClass:"container-fluid"},[t("el-breadcrumb",{staticClass:"breadcrumb",attrs:{"separator-class":"el-icon-arrow-right"}},[t("el-breadcrumb-item",{attrs:{to:{name:"homeLink"}}},[t("i",{staticClass:"glyphicon glyphicon-home"}),a._v("首页")]),a._v(" "),t("el-breadcrumb-item",[a._v("店铺管理")]),a._v(" "),t("el-breadcrumb-item",{attrs:{to:{name:"allowanceImportIndexLink"}}},[a._v("门店津贴导入")]),a._v(" "),t("el-breadcrumb-item",[a._v("文件上传")])],1)],1),a._v(" "),t("div",{staticClass:"rtl-custom-box mt15"},[t("div",{staticClass:"box-hd"},[t("div",{staticClass:"cont"},[t("div",{staticClass:"form-horizontal"},[t("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0}},[t("el-row",[t("el-col",{attrs:{span:24}},[t("el-col",{attrs:{span:2}},[t("label",{staticClass:"control-label"},[a._v("模板下载：")])]),a._v(" "),t("el-col",{attrs:{span:22}},[t("el-form-item",[t("el-button",{attrs:{type:"text"},on:{click:a.downloadEvt}},[a._v("门店津贴导入模板.csv")])],1)],1)],1)],1),a._v(" "),t("el-row",[t("el-col",{attrs:{span:24}},[t("el-col",{attrs:{span:2}},[t("label",{staticClass:"control-label"},[a._v("数据导入：")])]),a._v(" "),t("el-col",{attrs:{span:22}},[t("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{action:a.fileAction,limit:1,"on-exceed":a.handleExceed,"file-list":a.fileList,"auto-upload":!1}},[t("el-button",{attrs:{slot:"trigger",size:"small",type:"primary",icon:"el-icon-upload2"},slot:"trigger"},[a._v("选取文件")]),a._v(" "),t("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small",type:"success"},on:{click:a.submitUpload}},[a._v("上传到服务器")]),a._v(" "),t("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[a._v("支持扩展名：.csv，大小不超过50MB")])],1)],1)],1)],1)],1)],1)])])]),a._v(" "),t("div",{staticClass:"box-bd pr mt15"},[t("div",{staticClass:"tab-content custom-content"},[t("div",{staticClass:"tab-pane in active"},[t("div",{staticClass:"table-responsive"},[t("el-table",{staticStyle:{width:"100%"},attrs:{border:"",data:a.pageData.tableObj.list}},[t("el-table-column",{attrs:{sortable:"",prop:"yearMonthStr",label:"月份","min-width":"90"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"employeeNo",label:"工号","min-width":"110"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"employeeName",label:"员工姓名","min-width":"120"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"siteNo",label:"店号","min-width":"120"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"siteName",label:"店铺名称","min-width":"130"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"employeeSubGroup",label:"员工子组","min-width":"110"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"entryTime",label:"入职日期","min-width":"110"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"organzationName",label:"组织名称","min-width":"110"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"postName",label:"岗位名称","min-width":"110"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"finalScore",label:"月评分数","min-width":"110"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"allowance",label:"津贴总额","min-width":"110"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"allowanceRate",label:"津贴分配比例","min-width":"110"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"issuedAllowance",label:"应发津贴","min-width":"110"}}),a._v(" "),t("el-table-column",{attrs:{label:"导入结果","min-width":"100"},scopedSlots:a._u([{key:"default",fn:function(e){return[t("span",[a._v(a._s(e.row.state?"成功":e.row.desc))])]}}])})],1)],1)])])])])},staticRenderFns:[]};var aa={data:function(){return{pageData:{shopTypeList:[],tableObj:{status:-1,siteNo:"",shopType:"",mandt:"",startTime:"",endTime:"",currentPage:1,pageSize:10,totalPage:1,totalRows:1,pageArray:[10,20,30,40,50],list:[]}}}},created:function(){this.commonInfo()},computed:{},methods:{updateEvt:function(){this.$router.push({name:"smallShopUpdateLink"})},initFunc:function(){this.shopTypeListEvt()},commonInfo:function(){var a=this,e=this.$loading({lock:!0,spinner:"wm-icon-loading",background:"rgba(0, 0, 0, 0.7)"});fetch(this.$api.urls.POST_QUERYCOMMONINFO,{method:"post",headers:{"Content-type":"application/json"},credentials:"include",body:p()({})}).then(function(a){return a.json()}).then(function(t){setTimeout(function(){e.close()},500),t.success?(a.$store.dispatch("setIndu",t.model.indu),a.pageData.tableObj.mandt=t.model.mandt,a.pageData.tableObj.siteNo=t.model.siteNo,a.initFunc()):a.$message.error(t.message)}).catch(function(t){setTimeout(function(){e.close()},500),a.$message.error("错误："+t)})},shopTypeListEvt:function(){var a=this,e={mandt:this.pageData.tableObj.mandt,siteNo:this.pageData.tableObj.siteNo};fetch(this.$api.urls.POST_PARTNER_QUERYSHOPTYPE,{method:"post",headers:{"Content-type":"application/json"},credentials:"include",body:p()(e)}).then(function(a){return a.json()}).then(function(e){e.success?(a.pageData.shopTypeList=e.model,a.queryEvt()):a.$message.error(e.message)}).catch(function(e){a.$message.error("系统错误："+e)})},queryEvt:function(){var a=this,e={status:this.pageData.tableObj.status,siteNo:this.pageData.tableObj.siteNo,shopType:this.pageData.tableObj.shopType,mandt:this.pageData.tableObj.mandt,startTime:this.pageData.tableObj.startTime,endTime:this.pageData.tableObj.endTime,currentPage:this.pageData.tableObj.currentPage,pageSize:this.pageData.tableObj.pageSize};if(this.$api.compareDate(e.startTime,e.endTime))return this.$message({message:"开始时间不能大于结束时间!",type:"warning"}),!1;var t=this.$loading({lock:!0,spinner:"wm-icon-loading",background:"rgba(0, 0, 0, 0.7)"});fetch(this.$api.urls.POST_PARTNER_QUERYSITESHOP,{method:"post",headers:{"Content-type":"application/json"},credentials:"include",body:p()(e)}).then(function(a){return a.json()}).then(function(e){if(setTimeout(function(){t.close()},500),e.success){a.pageData.tableObj.currentPage=e.model.currentPage,a.pageData.tableObj.pageSize=e.model.pageSize,a.pageData.tableObj.totalPage=e.model.pageCount,a.pageData.tableObj.totalRows=e.model.count;for(var l=e.model.data,s=0;s<l.length;s++)l[s].created=a.$api.dateFormat("yyyy-MM-dd",l[s].created);a.pageData.tableObj.list=l}else a.$message.error(e.message)}).catch(function(e){setTimeout(function(){t.close()},500),a.$message.error("系统错误："+e)})},handleSizeChange:function(a){this.pageData.tableObj.pageSize=a,this.queryEvt()},handleCurrentChange:function(a){this.pageData.tableObj.currentPage=a,this.queryEvt()}}},ea={render:function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("el-main",[t("div",{staticClass:"container-fluid"},[t("el-breadcrumb",{staticClass:"breadcrumb",attrs:{"separator-class":"el-icon-arrow-right"}},[t("el-breadcrumb-item",{attrs:{to:{name:"homeLink"}}},[t("i",{staticClass:"glyphicon glyphicon-home"}),a._v("首页")]),a._v(" "),t("el-breadcrumb-item",[a._v("店铺配置")]),a._v(" "),t("el-breadcrumb-item",[a._v("小店维护")])],1)],1),a._v(" "),t("div",{staticClass:"rtl-custom-box mt15"},[t("div",{staticClass:"box-hd"},[t("div",{staticClass:"cont"},[t("div",{staticClass:"form-horizontal"},[t("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:a.pageData.tableObj}},[t("el-row",[t("el-col",{attrs:{span:6}},[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("门店号码：")])]),a._v(" "),t("el-col",{attrs:{span:16}},[t("el-form-item",[t("el-input",{attrs:{placeholder:"请输入门店号",clearable:""},model:{value:a.pageData.tableObj.siteNo,callback:function(e){a.$set(a.pageData.tableObj,"siteNo",e)},expression:"pageData.tableObj.siteNo"}})],1)],1)],1),a._v(" "),t("el-col",{attrs:{span:6}},[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("小店类型：")])]),a._v(" "),t("el-col",{attrs:{span:16}},[t("el-form-item",[t("el-select",{model:{value:a.pageData.tableObj.shopType,callback:function(e){a.$set(a.pageData.tableObj,"shopType",e)},expression:"pageData.tableObj.shopType"}},[t("el-option",{attrs:{label:"全部",value:""}}),a._v(" "),a._l(a.pageData.shopTypeList,function(a){return t("el-option",{key:a.shopType,attrs:{label:a.induName+a.shopType,value:a.shopType}})})],2)],1)],1)],1),a._v(" "),t("el-col",{attrs:{span:12}},[t("el-col",{attrs:{span:4}},[t("label",{staticClass:"control-label"},[a._v("创建时间：")])]),a._v(" "),t("el-col",{attrs:{span:20}},[t("el-col",{attrs:{span:10}},[t("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",align:"right",type:"date",placeholder:"请选择日期"},model:{value:a.pageData.tableObj.startTime,callback:function(e){a.$set(a.pageData.tableObj,"startTime",e)},expression:"pageData.tableObj.startTime"}})],1),a._v(" "),t("el-col",{staticClass:"text-center",staticStyle:{"line-height":"40px"},attrs:{span:2}},[a._v("-")]),a._v(" "),t("el-col",{attrs:{span:10}},[t("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",align:"right",type:"date",placeholder:"请选择日期"},model:{value:a.pageData.tableObj.endTime,callback:function(e){a.$set(a.pageData.tableObj,"endTime",e)},expression:"pageData.tableObj.endTime"}})],1)],1)],1)],1),a._v(" "),t("el-row",[t("el-col",{staticClass:"text-center",attrs:{span:24}},[t("el-form-item",[t("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(e){return e.stopPropagation(),a.queryEvt(e)}}},[a._v("查询")])],1)],1)],1)],1)],1)])])]),a._v(" "),t("div",{staticClass:"box-bd pr mt15"},[t("div",{staticClass:"tab-content custom-content"},[t("div",{staticClass:"tab-pane in active"},[t("el-row",{staticClass:"mb10"},[t("el-col",{attrs:{span:12}},[t("el-button",{attrs:{type:"primary",icon:"el-icon-setting"},on:{click:function(e){return e.stopPropagation(),a.updateEvt(e)}}},[a._v("调整架构")])],1)],1),a._v(" "),t("div",{staticClass:"table-responsive"},[t("el-table",{staticStyle:{width:"100%"},attrs:{border:"",data:a.pageData.tableObj.list}},[t("el-table-column",{attrs:{sortable:"",prop:"id",label:"序号","min-width":"90"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"siteNo",label:"门店编号","min-width":"90"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"siteName",label:"门店名称","min-width":"90"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"shopNo",label:"小店编号","min-width":"130"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"shopName",label:"小店名称","min-width":"130"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"chargeName",label:"小店负责人","min-width":"130"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"shopType",label:"架构类型","min-width":"120"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"creator",label:"创建人","min-width":"110"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"created",label:"创建时间","min-width":"120"}})],1)],1),a._v(" "),t("div",{staticClass:"page"},[t("div",{staticClass:"block p15 text-center"},[t("el-pagination",{attrs:{"current-page":a.pageData.tableObj.currentPage,"page-sizes":a.pageData.tableObj.pageArray,"page-size":a.pageData.tableObj.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:a.pageData.tableObj.totalRows},on:{"size-change":a.handleSizeChange,"current-change":a.handleCurrentChange}})],1)])],1)])])])},staticRenderFns:[]};var ta={data:function(){return{pageData:{shopTypeList:[],tableObj:{mandt:"",indu:"",siteNo:"",shopType:"",list:[]}}}},created:function(){this.commonInfo()},mounted:function(){},methods:{initFunc:function(){this.shopTypeListEvt()},commonInfo:function(){var a=this,e=this.$loading({lock:!0,spinner:"wm-icon-loading",background:"rgba(0, 0, 0, 0.7)"});fetch(this.$api.urls.POST_QUERYCOMMONINFO,{method:"post",headers:{"Content-type":"application/json"},credentials:"include",body:p()({})}).then(function(a){return a.json()}).then(function(t){setTimeout(function(){e.close()},500),t.success?(a.pageData.tableObj.mandt=t.model.mandt,a.pageData.tableObj.indu=t.model.indu,a.pageData.tableObj.siteNo=t.model.siteNo,a.initFunc()):a.$message.error(t.message)}).catch(function(t){setTimeout(function(){e.close()},500),a.$message.error("错误："+t)})},shopTypeListEvt:function(){var a=this,e={mandt:this.pageData.tableObj.mandt,siteNo:this.pageData.tableObj.siteNo};fetch(this.$api.urls.POST_PARTNER_QUERYSHOPTYPE,{method:"post",headers:{"Content-type":"application/json"},credentials:"include",body:p()(e)}).then(function(a){return a.json()}).then(function(e){e.success?a.pageData.shopTypeList=e.model:a.$message.error(e.message)}).catch(function(e){a.$message.error("系统错误："+e)})},queryEvt:function(){var a=this,e={siteNo:this.pageData.tableObj.siteNo,mandt:this.pageData.tableObj.mandt,indu:this.pageData.tableObj.indu,shopType:this.pageData.tableObj.shopType},t=this.$loading({lock:!0,spinner:"wm-icon-loading",background:"rgba(0, 0, 0, 0.7)"});fetch(this.$api.urls.POST_SMALLSHOP_QUERYSITESHOP,{method:"post",headers:{"Content-type":"application/json"},credentials:"include",body:p()(e)}).then(function(a){return a.json()}).then(function(e){setTimeout(function(){t.close()},500),e.success?a.pageData.tableObj.list=e.model.map(function(e){return e.yearMonthStr=a.pageData.tableObj.yearMonthStr,e}):a.$message.error(e.message)}).catch(function(e){setTimeout(function(){t.close()},500),a.$message.error("系统错误："+e)})},tableRowClassName:function(a){return a.row.chargeName?"":"warning-row"},updateEvt:function(){var a=this,e=this.pageData.tableObj.list.map(function(e){return e.siteNo=a.pageData.tableObj.siteNo,e});if(e.length<=0)return this.$message({message:"请查询填写后再提交保存!",type:"warning"}),!1;if(e.some(function(a){return""==a.chargeName||null==a.chargeName||""==a.chargeNo||null==a.chargeNo}))return this.$message({message:"请填写负责人姓名!",type:"warning"}),!1;var t=this.$loading({lock:!0,spinner:"wm-icon-loading",background:"rgba(0, 0, 0, 0.7)"});fetch(this.$api.urls.POST_SMALLSHOP_SAVECHANGEDSITESHOP,{method:"post",headers:{"Content-type":"application/json"},credentials:"include",body:p()(e)}).then(function(a){return a.json()}).then(function(e){setTimeout(function(){t.close()},500),e.success?a.$alert("提交成功","提示",{center:!0,dangerouslyUseHTMLString:!0,callback:function(e){a.$router.push({name:"smallShopIndexLink"})}}):a.$message.error(e.message)}).catch(function(e){setTimeout(function(){t.close()},500),a.$message.error("系统错误："+e)})}}},la={render:function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("el-main",[t("div",{staticClass:"container-fluid"},[t("el-breadcrumb",{staticClass:"breadcrumb",attrs:{"separator-class":"el-icon-arrow-right"}},[t("el-breadcrumb-item",{attrs:{to:{name:"homeLink"}}},[t("i",{staticClass:"glyphicon glyphicon-home"}),a._v("首页")]),a._v(" "),t("el-breadcrumb-item",[a._v("店铺配置")]),a._v(" "),t("el-breadcrumb-item",{attrs:{to:{name:"smallShopIndexLink"}}},[a._v("小店维护")]),a._v(" "),t("el-breadcrumb-item",[a._v("类型调整")])],1)],1),a._v(" "),t("div",{staticClass:"rtl-custom-box mt15"},[t("div",{staticClass:"box-hd"},[t("div",{staticClass:"cont"},[t("div",{staticClass:"form-horizontal"},[t("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0}},[t("el-row",[t("el-col",{attrs:{span:6}},[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("门店编号：")])]),a._v(" "),t("el-col",{attrs:{span:16}},[t("el-form-item",[t("el-input",{attrs:{placeholder:"请输入门店编号"},on:{change:a.queryEvt},model:{value:a.pageData.tableObj.siteNo,callback:function(e){a.$set(a.pageData.tableObj,"siteNo",e)},expression:"pageData.tableObj.siteNo"}})],1)],1)],1),a._v(" "),t("el-col",{attrs:{span:6}},[t("el-col",{attrs:{span:8}},[t("label",{staticClass:"control-label"},[a._v("类型：")])]),a._v(" "),t("el-col",{attrs:{span:16}},[t("el-select",{attrs:{placeholder:"请选择"},on:{change:a.queryEvt},model:{value:a.pageData.tableObj.shopType,callback:function(e){a.$set(a.pageData.tableObj,"shopType",e)},expression:"pageData.tableObj.shopType"}},[t("el-option",{key:"",attrs:{label:"全部",value:""}}),a._v(" "),a._l(a.pageData.shopTypeList,function(a){return t("el-option",{key:a.shopType,attrs:{label:a.induName+a.shopType,value:a.shopType}})})],2)],1)],1)],1)],1)],1)])])]),a._v(" "),t("div",{staticClass:"box-bd pr mt15"},[t("div",{staticClass:"tab-content custom-content"},[t("div",{staticClass:"tab-pane in active"},[t("div",{staticClass:"table-responsive"},[t("el-table",{staticStyle:{width:"100%"},attrs:{border:"",data:a.pageData.tableObj.list,"row-class-name":a.tableRowClassName}},[t("el-table-column",{attrs:{sortable:"",prop:"shopNo",label:"小店编号","min-width":"120"}}),a._v(" "),t("el-table-column",{attrs:{sortable:"",prop:"shopName",label:"小店名称","min-width":"120"}}),a._v(" "),t("el-table-column",{attrs:{label:"负责人编号","min-width":"120"},scopedSlots:a._u([{key:"default",fn:function(e){return[t("el-input",{model:{value:e.row.chargeNo,callback:function(t){a.$set(e.row,"chargeNo",t)},expression:"scope.row.chargeNo"}})]}}])}),a._v(" "),t("el-table-column",{attrs:{label:"负责人","min-width":"120"},scopedSlots:a._u([{key:"default",fn:function(e){return[t("el-input",{model:{value:e.row.chargeName,callback:function(t){a.$set(e.row,"chargeName",t)},expression:"scope.row.chargeName"}})]}}])})],1)],1)])])]),a._v(" "),t("el-row",{staticClass:"mb10"},[t("el-col",{staticClass:"text-center",attrs:{span:24}},[t("el-button",{attrs:{type:"success",icon:"el-icon-edit-outline"},on:{click:function(e){return e.stopPropagation(),a.updateEvt(e)}}},[a._v("提交")]),a._v(" "),t("router-link",{attrs:{to:{name:"smallShopIndexLink"}}},[t("el-button",{attrs:{type:"danger",icon:"el-icon-circle-close-outline"}},[a._v("取消")])],1)],1)],1)],1)},staticRenderFns:[]};var sa=[{path:"/",name:"homeLink",component:r},{path:"/shopsetting",name:"shopsettingLink",component:b},{path:"/shopSubject",name:"shopSubjectLink",component:D},{path:"/shopsubjectIndex",name:"shopsubjectIndexLink",component:h},{path:"/acreage",name:"acreageLink",component:O},{path:"/specifiedProportion",name:"specifiedProportionLink",component:t("VU/8")(C,E,!1,function(a){t("32IE")},"data-v-7c0e2d24",null).exports},{path:"/costEntry",name:"costEntryLink",component:j},{path:"/log",name:"logLink",component:t("VU/8")($,T,!1,function(a){t("2zOP")},"data-v-3a4fc279",null).exports},{path:"*",redirect:"/"},{path:"/score/leader",name:"scoreLeaderLink",component:t("VU/8")(N,k,!1,null,null,null).exports},{path:"/score/leader/detail",name:"scoreLeaderDetailLink",component:t("VU/8")(x,P,!1,null,null,null).exports},{path:"/score/member",name:"scoreMemberLink",component:t("VU/8")(I,R,!1,null,null,null).exports},{path:"/score/member/detail",name:"scoreMemberDetailLink",component:t("VU/8")(M,L,!1,null,null,null).exports},{path:"/checkup",name:"checkupLink",component:t("VU/8")(F,A,!1,null,null,null).exports},{path:"/checkup/detail",name:"checkupDetailLink",component:t("VU/8")(z,q,!1,null,null,null).exports},{path:"/checkup/upload",name:"checkupUploadLink",component:t("VU/8")(U,Y,!1,function(a){t("04w3")},null,null).exports},{path:"/allowanceConfirm/index",name:"allowanceConfirmIndexLink",component:t("VU/8")(V,Q,!1,null,null,null).exports},{path:"/allowanceConfirm/update",name:"allowanceConfirmUploadLink",component:t("VU/8")(H,B,!1,null,null,null).exports},{path:"/allowanceImport/index",name:"allowanceImportIndexLink",component:t("VU/8")(W,G,!1,null,null,null).exports},{path:"/allowanceImport/detail",name:"allowanceImportDetailLink",component:t("VU/8")(J,K,!1,null,null,null).exports},{path:"/allowanceImport/upload",name:"allowanceImportUploadLink",component:t("VU/8")(X,Z,!1,function(a){t("KF+7")},null,null).exports},{path:"/smallShop/index",name:"smallShopIndexLink",component:t("VU/8")(aa,ea,!1,function(a){t("DAEC")},"data-v-54e8af85",null).exports},{path:"/smallShop/update",name:"smallShopUpdateLink",component:t("VU/8")(ta,la,!1,function(a){t("A1UD")},null,null).exports}],oa=t("NYxO");l.default.use(oa.a);var ia=new oa.a.Store({actions:{setMandt:function(a,e){(0,a.commit)("setMandt",e)},setIndu:function(a,e){(0,a.commit)("setIndu",e)},setSiteNo:function(a,e){(0,a.commit)("setSiteNo",e)}},mutations:{setMandt:function(a,e){a.mandt=e},setIndu:function(a,e){a.indu=e},setSiteNo:function(a,e){a.siteNo=e}},getters:{mandt:function(a){return a.mandt},indu:function(a){return a.indu},siteNo:function(a){return a.siteNo}},state:{mandt:"",indu:"",siteNo:""}}),na=t("mtWM"),ra=t.n(na),ca=t("zL8q"),pa=t.n(ca);function ua(){}var da="qa.partner.wumart.com:8080"==window.location.host.toLowerCase(),ba=window.location.origin;ua.prototype.urls={POST_QUERYCOMMONINFO:(da?"/apis":ba)+"/wumart/partner/queryCommonInfo",POST_QUERYSUBJECTTYPE:(da?"/apis":ba)+"/wumart/partner/querySubjectType",POST_PARTNER_QUERYSITESHOP:(da?"/apis":ba)+"/wumart/partner/querySiteShop",POST_PARTNER_CREATE:(da?"/apis":ba)+"/wumart/partner/create",POST_PARTNER_QUERYPARTNERTEAM:(da?"/apis":ba)+"/wumart/partner/queryPartnerTeam",POST_PARTNER_QUERYSHOPTYPE:(da?"/apis":ba)+"/wumart/partner/queryShopType",POST_PARTNER_UPDATE:(da?"/apis":ba)+"/wumart/partner/update",POST_PARTNER_QUERYSHOP:(da?"/apis":ba)+"/wumart/partner/queryShop",POST_AREA_QUERYAREAMAIN:(da?"/apis":ba)+"/wumart/partner/area/queryAreaMain",POST_AREA_QUERYAREAITEM:(da?"/apis":ba)+"/wumart/partner/area/queryAreaItem",POST_AREA_CREATEAREA:(da?"/apis":ba)+"/wumart/partner/area/createArea",POST_FEE_QUERYFEEMAIN:(da?"/apis":ba)+"/wumart/partner/Fee/queryFeeMain",POST_FEE_QUERYFEEITEM:(da?"/apis":ba)+"/wumart/partner/Fee/queryFeeItem",POST_FEE_CREATEFEE:(da?"/apis":ba)+"/wumart/partner/Fee/createFee",POST_FEE_TOTALFEEFROMBIDDATA:(da?"/apis":ba)+"/wumart/partner/Fee/getTotalFeeFromBigData",POST_RATE_CREATERATE:(da?"/apis":ba)+"/wumart/partner/rate/createRate",POST_RATE_QUERYRATEITEM:(da?"/apis":ba)+"/wumart/partner/rate/queryRateItem",POST_RATE_QUERYRATEMAIN:(da?"/apis":ba)+"/wumart/partner/rate/queryRateMain",POST_RATE_QUERYOAAREAITEM:(da?"/apis":ba)+"/wumart/partner/area/queryOaAreaItem",POST_LOG_QUERYLOGMAIN:(da?"/apis":ba)+"/wumart/partner/log/queryLogMain",POST_INSPECTIONSCORE_QUERYMAIN:(da?"/apis":ba)+"/wumart/partner/inspectionscore/queryMain",POST_INSPECTIONSCORE_QUERYITEM:(da?"/apis":ba)+"/wumart/partner/inspectionscore/queryItem",POST_INSPECTIONSCORE_UPLOADFILE:(da?"/apis":ba)+"/wumart/partner/inspectionscore/uploadFile",POST_EMPLOYEESCORE_LIST:(da?"/apis":ba)+"/wumart/partner/employeescore/queryList",POST_EMPLOYEESCORE_QUERYITEMBYMANAGER:(da?"/apis":ba)+"/wumart/partner/employeescore/queryItemByManager",POST_EMPLOYEESCORE_QUERYUNCOMMITTED:(da?"/apis":ba)+"/wumart/partner/employeescore/queryUncommitted",POST_EMPLOYEESCORE_CREATE:(da?"/apis":ba)+"/wumart/partner/employeescore/create",POST_EMPLOYEESCORE_QUERYITEMBYLEADER:(da?"/apis":ba)+"/wumart/partner/employeescore/queryItemByLeader",POST_EMPLOYEESCORE_UPDATEITEMS:(da?"/apis":ba)+"/wumart/partner/employeescore/updateItems",POST_EMPLOYEESCORE_SUBMITOAFLOW:(da?"/apis":ba)+"/wumart/partner/employeescore/submitOaFlow",POST_EMPLOYEESCORE_DOWNSCORE:(da?"/apis":ba)+"/wumart/partner/employeescore/downScore",POST_EMPLOYEESCORE_CHECKTEAMLEADER:(da?"/apis":ba)+"/wumart/partner/employeescore/checkTeamLeader",POST_SMALLSHOP_QUERYSITESHOP:(da?"/apis":ba)+"/wumart/partner/queryChangedSiteShopBySiteNo",POST_SMALLSHOP_SAVECHANGEDSITESHOP:(da?"/apis":ba)+"/wumart/partner/saveChangedSiteShop",POST_ALLOWANCE_QUERYMAIN:(da?"/apis":ba)+"/wumart/partner/allowance/queryMain",POST_ALLOWANCE_QUERYITEM:(da?"/apis":ba)+"/wumart/partner/allowance/queryItem",POST_ALLOWANCE_UPLOADFILE:(da?"/apis":ba)+"/wumart/partner/allowance/uploadFile",POST_ALLOWANCE_ADJUSTMENT:(da?"/apis":ba)+"/wumart/partner/allowance/adjustment"},ua.prototype.ajaxDataFetch=function(a){var e=this,t={};void 0===a.type&&(a.type="GET"),"string"!=typeof a.data&&(a.data=p()(a.data)),fetch(a.url,{method:a.type,headers:{"Content-type":"application/json"},body:p()(a.data)}).then(function(a){return a.json()}).then(function(e){t="string"==typeof e?JSON.parse(data):data,void 0!=a.callback&&a.callback(t)}).catch(function(a){e.$message.error(res.message)})},ua.prototype.monthFormat=function(a){return 6!==a.length?null:a.substring(0,4)+"-"+a.substring(4)},ua.prototype.dateFormat=function(a,e){if(""===a&&void 0===a)return null;var t=new Date;if(void 0!==e&&""!==e){var l=e;if(!/[0-9]{13}/.test(e)){if(!/^(\d{4})(-|\/)(\d{1,2})(-|\/)(\d{1,2})$/.test(e))return null;l=new Date((e+"").replace(/(-|年|月)/g,"/").replace(/日/g,"")).getTime()}t=new Date(parseInt(l))}var s={"M+":t.getMonth()+1,"d+":t.getDate(),"h+":t.getHours(),"m+":t.getMinutes(),"s+":t.getSeconds(),"q+":Math.floor((t.getMonth()+3)/3),S:t.getMilliseconds()};for(var o in/(y+)/.test(a)&&(a=a.replace(RegExp.$1,(t.getFullYear()+"").substr(4-RegExp.$1.length))),s)new RegExp("("+o+")").test(a)&&(a=a.replace(RegExp.$1,1==RegExp.$1.length?s[o]:("00"+s[o]).substr((""+s[o]).length)));return a},ua.prototype.getDateFunc=function(a,e){var t=new Date;void 0!==e&&/^[0-9]*$/.test(e)&&(t=new Date(e));var l=t.getFullYear(),s=t.getMonth()+1;s=s>9?s:"0"+s;var o=t.getDate();o=o>9?o:"0"+o;var i=t.getHours();i=i>9?i:"0"+i;var n=t.getMinutes();n=n>9?n:"0"+n;var r=t.getSeconds();return r=r>9?r:"0"+r,"all"==a?l+"-"+s+"-"+o+" "+i+":"+n+":"+r:l+"-"+s+"-"+o},ua.prototype._IE=function(){for(var a=3,e=document.createElement("div"),t=e.getElementsByTagName("i");e.innerHTML="\x3c!--[if gt IE "+ ++a+"]><i></i><![endif]--\x3e",t[0];);return a>4&&a}(),ua.prototype.accMul=function(a,e){var t=0,l=a.toString(),s=e.toString();try{t+=l.split(".")[1].length}catch(a){}try{t+=s.split(".")[1].length}catch(a){}return Number(l.replace(".",""))*Number(s.replace(".",""))/Math.pow(10,t)},ua.prototype.compareDate=function(a,e){return new Date(a.replace(/-/g,"/"))>new Date(e.replace(/-/g,"/"))};var ma=new ua;l.default.use(i.a),l.default.prototype.$axios=ra.a,l.default.use(pa.a),l.default.prototype.$api=ma;var ga=new i.a({routes:sa});l.default.config.productionTip=!1,new l.default({el:"#app",router:ga,store:ia,components:{App:o},template:"<App/>"})},"Qib/":function(a,e){},TaJK:function(a,e){},Y4aF:function(a,e){},u2jH:function(a,e){}},["NHnr"]);
//# sourceMappingURL=app.c8ed8a77a3b28a152a62.js.map